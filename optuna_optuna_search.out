/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/networkx/utils/backends.py:135: RuntimeWarning: networkx backend defined more than once: nx-loopback
  backends.update(_get_backends("networkx.backends"))
🎯 Starting Optuna hyperparameter optimization with 500 trials
📊 Objective: Maximize validation AUC
🖥️  Device: 3
💾 Keeping top 10 checkpoints/logs to save space
[I 2025-08-21 11:35:16,343] A new study created in memory with name: walk_to_paint_study_optuna_search
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 0 hyperparameters:
  Walk length: 30, Num walks: 121,159
  LR: 3.00e-05, Batch size: 32
  Model: emb_dim=64, hidden_dim=64
  Transformer: 5 layers, 4 heads
  Epochs: 16, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
You are using a CUDA device ('NVIDIA L40S') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.558
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.559
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.561
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.565
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.571
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.575
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.580
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.583
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.584
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.585
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.586
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.587
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.587
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.587
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.587
`Trainer.fit` stopped: `max_epochs=16` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_0-epoch=15-val_auc_epoch=0.5870.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_0-epoch=15-val_auc_epoch=0.5870.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5609151124954224
      val_auc_epoch          0.587040901184082
      val_f1_epoch          0.5596323013305664
        val_loss            0.7135388255119324
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 0 completed - Val AUC: 0.5870
[I 2025-08-21 11:49:26,457] Trial 0 finished with value: -0.587040901184082 and parameters: {'dataset.max_walk_length': 30, 'dataset.num_walks': 121159, 'training.lr': 3.004818397747491e-05, 'training.weight_decay': 0.0029232656276522028, 'training.batch_size': 32, 'training.gradient_clip_val': 0.6176102677381993, 'training.early_stopping_patience': 15, 'model.nhead_emb_combo': 16, 'model.hidden_dim': 64, 'model.nlayers': 5, 'model.dropout': 0.02498023037882434, 'training.epochs': 16}. Best is trial 0 with value: -0.587040901184082.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 1 hyperparameters:
  Walk length: 84, Num walks: 346,280
  LR: 5.98e-03, Batch size: 64
  Model: emb_dim=64, hidden_dim=16
  Transformer: 2 layers, 2 heads
  Epochs: 24, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.506
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.506
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.506
Metric val_auc_epoch improved by 0.018 >= min_delta = 0.0. New best score: 0.524
Metric val_auc_epoch improved by 0.108 >= min_delta = 0.0. New best score: 0.632
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.638
`Trainer.fit` stopped: `max_epochs=24` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_1-epoch=19-val_auc_epoch=0.6377.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_1-epoch=19-val_auc_epoch=0.6377.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5916738510131836
      val_auc_epoch         0.6377121806144714
      val_f1_epoch          0.5826030969619751
        val_loss             1.346189260482788
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 1 completed - Val AUC: 0.6377
[I 2025-08-21 12:14:54,743] Trial 1 finished with value: -0.6377121806144714 and parameters: {'dataset.max_walk_length': 84, 'dataset.num_walks': 346280, 'training.lr': 0.0059788189125778, 'training.weight_decay': 0.057964248936915604, 'training.batch_size': 64, 'training.gradient_clip_val': 1.854182703873302, 'training.early_stopping_patience': 12, 'model.nhead_emb_combo': 10, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.6119565345125341, 'training.epochs': 24}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 2 hyperparameters:
  Walk length: 19, Num walks: 160,331
  LR: 3.90e-04, Batch size: 64
  Model: emb_dim=4, hidden_dim=128
  Transformer: 5 layers, 2 heads
  Epochs: 30, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.511
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.517
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.521
Metric val_auc_epoch improved by 0.009 >= min_delta = 0.0. New best score: 0.530
Monitored metric val_auc_epoch did not improve in the last 7 records. Best score: 0.530. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_2-epoch=07-val_auc_epoch=0.5302.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_2-epoch=07-val_auc_epoch=0.5302.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch                 0.5
      val_auc_epoch         0.5302151441574097
      val_f1_epoch          0.2961898148059845
        val_loss            0.6931350827217102
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 2 completed - Val AUC: 0.5302
[I 2025-08-21 12:25:36,440] Trial 2 finished with value: -0.5302151441574097 and parameters: {'dataset.max_walk_length': 19, 'dataset.num_walks': 160331, 'training.lr': 0.0003901187308053221, 'training.weight_decay': 2.207692497866113e-08, 'training.batch_size': 64, 'training.gradient_clip_val': 1.4858794459133617, 'training.early_stopping_patience': 7, 'model.nhead_emb_combo': 6, 'model.hidden_dim': 128, 'model.nlayers': 5, 'model.dropout': 0.635374355510304, 'training.epochs': 30}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 3 hyperparameters:
  Walk length: 80, Num walks: 806,000
  LR: 6.43e-02, Batch size: 64
  Model: emb_dim=64, hidden_dim=4
  Transformer: 5 layers, 16 heads
  Epochs: 18, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.500
❌ Trial 3 failed: Input contains NaN.
[I 2025-08-21 12:45:45,526] Trial 3 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 80, 'dataset.num_walks': 806000, 'training.lr': 0.06430467099547572, 'training.weight_decay': 0.0001228036160406598, 'training.batch_size': 64, 'training.gradient_clip_val': 0.7220055345377502, 'training.early_stopping_patience': 11, 'model.nhead_emb_combo': 25, 'model.hidden_dim': 4, 'model.nlayers': 5, 'model.dropout': 0.3297523598481492, 'training.epochs': 18}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 4 hyperparameters:
  Walk length: 40, Num walks: 2,811,807
  LR: 6.55e-04, Batch size: 512
  Model: emb_dim=4, hidden_dim=32
  Transformer: 3 layers, 2 heads
  Epochs: 26, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.555
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.556
Monitored metric val_auc_epoch did not improve in the last 20 records. Best score: 0.556. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_4-epoch=01-val_auc_epoch=0.5563.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_4-epoch=01-val_auc_epoch=0.5563.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5392431020736694
      val_auc_epoch         0.5562543272972107
      val_f1_epoch           0.536116361618042
        val_loss            0.7107939720153809
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 4 completed - Val AUC: 0.5563
[I 2025-08-21 13:36:53,954] Trial 4 finished with value: -0.5562543272972107 and parameters: {'dataset.max_walk_length': 40, 'dataset.num_walks': 2811807, 'training.lr': 0.0006552035063638199, 'training.weight_decay': 2.2384409581589615e-08, 'training.batch_size': 512, 'training.gradient_clip_val': 1.1955403417207313, 'training.early_stopping_patience': 20, 'model.nhead_emb_combo': 6, 'model.hidden_dim': 32, 'model.nlayers': 3, 'model.dropout': 0.3519714963220409, 'training.epochs': 26}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 5 hyperparameters:
  Walk length: 15, Num walks: 828,518
  LR: 2.09e-03, Batch size: 32
  Model: emb_dim=8, hidden_dim=8
  Transformer: 3 layers, 8 heads
  Epochs: 10, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.585
Metric val_auc_epoch improved by 0.009 >= min_delta = 0.0. New best score: 0.594
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.595
❌ Trial 5 failed: Trial was pruned at epoch 5.
[I 2025-08-21 14:08:16,631] Trial 5 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 15, 'dataset.num_walks': 828518, 'training.lr': 0.0020903985223284555, 'training.weight_decay': 3.546269036160929e-07, 'training.batch_size': 32, 'training.gradient_clip_val': 1.7580045473054438, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 18, 'model.hidden_dim': 8, 'model.nlayers': 3, 'model.dropout': 0.6157872792109492, 'training.epochs': 10}. Best is trial 1 with value: -0.6377121806144714.
🧹 Cleaning up old checkpoints and logs (keeping top 10)...
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 6 hyperparameters:
  Walk length: 53, Num walks: 553,712
  LR: 3.19e-05, Batch size: 32
  Model: emb_dim=32, hidden_dim=4
  Transformer: 2 layers, 16 heads
  Epochs: 8, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.545
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.547
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.549
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.550
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.551
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.551
❌ Trial 6 failed: Trial was pruned at epoch 6.
[I 2025-08-21 14:30:54,960] Trial 6 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 53, 'dataset.num_walks': 553712, 'training.lr': 3.194364905067259e-05, 'training.weight_decay': 0.0041003637732943115, 'training.batch_size': 32, 'training.gradient_clip_val': 1.4240200569073438, 'training.early_stopping_patience': 16, 'model.nhead_emb_combo': 24, 'model.hidden_dim': 4, 'model.nlayers': 2, 'model.dropout': 0.32087255320837216, 'training.epochs': 8}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 7 hyperparameters:
  Walk length: 23, Num walks: 164,693
  LR: 2.05e-04, Batch size: 128
  Model: emb_dim=16, hidden_dim=32
  Transformer: 4 layers, 4 heads
  Epochs: 9, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.547
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.547
❌ Trial 7 failed: Trial was pruned at epoch 7.
[I 2025-08-21 14:33:40,374] Trial 7 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 23, 'dataset.num_walks': 164693, 'training.lr': 0.00020512851052432096, 'training.weight_decay': 0.08082690905036115, 'training.batch_size': 128, 'training.gradient_clip_val': 1.939643444527004, 'training.early_stopping_patience': 11, 'model.nhead_emb_combo': 14, 'model.hidden_dim': 32, 'model.nlayers': 4, 'model.dropout': 0.06750947001266513, 'training.epochs': 9}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 8 hyperparameters:
  Walk length: 65, Num walks: 126,298
  LR: 7.89e-05, Batch size: 256
  Model: emb_dim=64, hidden_dim=16
  Transformer: 5 layers, 4 heads
  Epochs: 22, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.539
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.541
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.544
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.549
❌ Trial 8 failed: Trial was pruned at epoch 8.
[I 2025-08-21 14:36:02,854] Trial 8 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 65, 'dataset.num_walks': 126298, 'training.lr': 7.889870399615959e-05, 'training.weight_decay': 5.298496315613773e-06, 'training.batch_size': 256, 'training.gradient_clip_val': 0.1723446042523586, 'training.early_stopping_patience': 16, 'model.nhead_emb_combo': 16, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.5504028737532027, 'training.epochs': 22}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 9 hyperparameters:
  Walk length: 91, Num walks: 909,566
  LR: 1.74e-04, Batch size: 512
  Model: emb_dim=32, hidden_dim=16
  Transformer: 1 layers, 16 heads
  Epochs: 19, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.549
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.550
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.553
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.558
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.564
❌ Trial 9 failed: Trial was pruned at epoch 5.
[I 2025-08-21 14:51:04,274] Trial 9 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 91, 'dataset.num_walks': 909566, 'training.lr': 0.00017376176723035334, 'training.weight_decay': 2.693010186757957e-07, 'training.batch_size': 512, 'training.gradient_clip_val': 1.4898897002144764, 'training.early_stopping_patience': 12, 'model.nhead_emb_combo': 24, 'model.hidden_dim': 16, 'model.nlayers': 1, 'model.dropout': 0.6472409113815893, 'training.epochs': 19}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 10 hyperparameters:
  Walk length: 100, Num walks: 336,424
  LR: 4.86e-03, Batch size: 64
  Model: emb_dim=8, hidden_dim=256
  Transformer: 1 layers, 1 heads
  Epochs: 25, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.614
❌ Trial 10 failed: Trial was pruned at epoch 5.
[I 2025-08-21 14:57:14,470] Trial 10 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 100, 'dataset.num_walks': 336424, 'training.lr': 0.0048571644594418515, 'training.weight_decay': 0.09257942655875115, 'training.batch_size': 64, 'training.gradient_clip_val': 1.9359224701358937, 'training.early_stopping_patience': 8, 'model.nhead_emb_combo': 1, 'model.hidden_dim': 256, 'model.nlayers': 1, 'model.dropout': 0.49946135720163665, 'training.epochs': 25}. Best is trial 1 with value: -0.6377121806144714.
🧹 Cleaning up old checkpoints and logs (keeping top 10)...
  Removed old checkpoint: trial_0-epoch=15-val_auc_epoch=0.5870.ckpt
  Removed old log dir: trial_0
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 11 hyperparameters:
  Walk length: 39, Num walks: 104,717
  LR: 1.14e-05, Batch size: 32
  Model: emb_dim=32, hidden_dim=64
  Transformer: 6 layers, 2 heads
  Epochs: 15, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.544
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.545
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.546
❌ Trial 11 failed: Trial was pruned at epoch 9.
[I 2025-08-21 15:05:56,532] Trial 11 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 39, 'dataset.num_walks': 104717, 'training.lr': 1.139446208100072e-05, 'training.weight_decay': 0.0019035880377981332, 'training.batch_size': 32, 'training.gradient_clip_val': 0.8507402132402269, 'training.early_stopping_patience': 15, 'model.nhead_emb_combo': 9, 'model.hidden_dim': 64, 'model.nlayers': 6, 'model.dropout': 0.07257874472552095, 'training.epochs': 15}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 12 hyperparameters:
  Walk length: 71, Num walks: 307,066
  LR: 7.76e-03, Batch size: 128
  Model: emb_dim=128, hidden_dim=64
  Transformer: 2 layers, 2 heads
  Epochs: 14, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.491
Metric val_auc_epoch improved by 0.014 >= min_delta = 0.0. New best score: 0.505
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.506
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.509
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.511
Metric val_auc_epoch improved by 0.009 >= min_delta = 0.0. New best score: 0.519
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.520
Metric val_auc_epoch improved by 0.011 >= min_delta = 0.0. New best score: 0.532
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.532
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.534
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.535
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.535
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.535
`Trainer.fit` stopped: `max_epochs=14` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_12-epoch=13-val_auc_epoch=0.5347.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_12-epoch=13-val_auc_epoch=0.5347.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch          0.520535945892334
      val_auc_epoch         0.5346822738647461
      val_f1_epoch           0.514919638633728
        val_loss            0.6951279044151306
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 12 completed - Val AUC: 0.5347
[I 2025-08-21 15:14:20,202] Trial 12 finished with value: -0.5346822738647461 and parameters: {'dataset.max_walk_length': 71, 'dataset.num_walks': 307066, 'training.lr': 0.007758647040259803, 'training.weight_decay': 0.0027544755108439897, 'training.batch_size': 128, 'training.gradient_clip_val': 0.6116503512360874, 'training.early_stopping_patience': 14, 'model.nhead_emb_combo': 11, 'model.hidden_dim': 64, 'model.nlayers': 2, 'model.dropout': 0.019626456332325952, 'training.epochs': 14}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 13 hyperparameters:
  Walk length: 36, Num walks: 271,221
  LR: 1.79e-05, Batch size: 256
  Model: emb_dim=16, hidden_dim=64
  Transformer: 4 layers, 8 heads
  Epochs: 21, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.532
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.540
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.542
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.544
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.544
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.544
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.544
`Trainer.fit` stopped: `max_epochs=21` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_13-epoch=06-val_auc_epoch=0.5444.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_13-epoch=06-val_auc_epoch=0.5444.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5289099216461182
      val_auc_epoch         0.5443885326385498
      val_f1_epoch          0.5287595987319946
        val_loss            0.6894862055778503
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 13 completed - Val AUC: 0.5444
[I 2025-08-21 15:22:02,883] Trial 13 finished with value: -0.5443885326385498 and parameters: {'dataset.max_walk_length': 36, 'dataset.num_walks': 271221, 'training.lr': 1.7940968532134645e-05, 'training.weight_decay': 0.011174520782701683, 'training.batch_size': 256, 'training.gradient_clip_val': 1.0640154023183503, 'training.early_stopping_patience': 19, 'model.nhead_emb_combo': 19, 'model.hidden_dim': 64, 'model.nlayers': 4, 'model.dropout': 0.15323426345112845, 'training.epochs': 21}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 14 hyperparameters:
  Walk length: 53, Num walks: 206,723
  LR: 5.55e-05, Batch size: 64
  Model: emb_dim=32, hidden_dim=16
  Transformer: 6 layers, 8 heads
  Epochs: 15, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.529
Metric val_auc_epoch improved by 0.011 >= min_delta = 0.0. New best score: 0.540
`Trainer.fit` stopped: `max_epochs=15` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_14-epoch=01-val_auc_epoch=0.5401.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_14-epoch=01-val_auc_epoch=0.5401.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5213107466697693
      val_auc_epoch         0.5401188135147095
      val_f1_epoch          0.4931905269622803
        val_loss            0.6939249038696289
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 14 completed - Val AUC: 0.5401
[I 2025-08-21 15:35:35,216] Trial 14 finished with value: -0.5401188135147095 and parameters: {'dataset.max_walk_length': 53, 'dataset.num_walks': 206723, 'training.lr': 5.551265924927636e-05, 'training.weight_decay': 0.00034436933187115433, 'training.batch_size': 64, 'training.gradient_clip_val': 0.521472910822066, 'training.early_stopping_patience': 18, 'model.nhead_emb_combo': 20, 'model.hidden_dim': 16, 'model.nlayers': 6, 'model.dropout': 0.69494209464952, 'training.epochs': 15}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 15 hyperparameters:
  Walk length: 81, Num walks: 453,322
  LR: 1.30e-03, Batch size: 32
  Model: emb_dim=4, hidden_dim=256
  Transformer: 2 layers, 4 heads
  Epochs: 26, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.492
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.497
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.502
Metric val_auc_epoch improved by 0.030 >= min_delta = 0.0. New best score: 0.531
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.532
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.533
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.533
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.534
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.534
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.535
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.535
`Trainer.fit` stopped: `max_epochs=26` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_15-epoch=19-val_auc_epoch=0.5355.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_15-epoch=19-val_auc_epoch=0.5355.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5239700078964233
      val_auc_epoch          0.535475492477417
      val_f1_epoch          0.5237709879875183
        val_loss            0.7376934289932251
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 15 completed - Val AUC: 0.5355
[I 2025-08-21 16:43:06,012] Trial 15 finished with value: -0.535475492477417 and parameters: {'dataset.max_walk_length': 81, 'dataset.num_walks': 453322, 'training.lr': 0.0013008066901338267, 'training.weight_decay': 0.014526771244518021, 'training.batch_size': 32, 'training.gradient_clip_val': 1.0150002125742656, 'training.early_stopping_patience': 9, 'model.nhead_emb_combo': 12, 'model.hidden_dim': 256, 'model.nlayers': 2, 'model.dropout': 0.18661454024556728, 'training.epochs': 26}. Best is trial 1 with value: -0.6377121806144714.
🧹 Cleaning up old checkpoints and logs (keeping top 10)...
  Removed old checkpoint: trial_5-epoch=04-val_auc_epoch=0.5947.ckpt
  Removed old checkpoint: trial_4-epoch=01-val_auc_epoch=0.5563.ckpt
  Removed old checkpoint: trial_3-epoch=00-val_auc_epoch=0.5000.ckpt
  Removed old checkpoint: trial_2-epoch=07-val_auc_epoch=0.5302.ckpt
  Removed old checkpoint: trial_1-epoch=19-val_auc_epoch=0.6377.ckpt
  Removed old log dir: trial_5
  Removed old log dir: trial_4
  Removed old log dir: trial_3
  Removed old log dir: trial_2
  Removed old log dir: trial_1
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 16 hyperparameters:
  Walk length: 29, Num walks: 107,350
  LR: 1.10e-05, Batch size: 64
  Model: emb_dim=8, hidden_dim=128
  Transformer: 4 layers, 2 heads
  Epochs: 29, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.504
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.507
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.511
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.515
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.517
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.519
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.520
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.521
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.523
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.524
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.525
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.525
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.527
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.528
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.528
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.528
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.529
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.530
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.531
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.531
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.531
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.531
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.532
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.532
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.532
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.532
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.532
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.532
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.532
`Trainer.fit` stopped: `max_epochs=29` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_16-epoch=28-val_auc_epoch=0.5320.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_16-epoch=28-val_auc_epoch=0.5320.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5227783918380737
      val_auc_epoch         0.5319894552230835
      val_f1_epoch          0.5222738981246948
        val_loss            0.6927493810653687
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 16 completed - Val AUC: 0.5320
[I 2025-08-21 16:54:14,136] Trial 16 finished with value: -0.5319894552230835 and parameters: {'dataset.max_walk_length': 29, 'dataset.num_walks': 107350, 'training.lr': 1.1031275031594512e-05, 'training.weight_decay': 0.0008582278761498367, 'training.batch_size': 64, 'training.gradient_clip_val': 0.4254188335290626, 'training.early_stopping_patience': 13, 'model.nhead_emb_combo': 7, 'model.hidden_dim': 128, 'model.nlayers': 4, 'model.dropout': 0.4434133655430373, 'training.epochs': 29}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 17 hyperparameters:
  Walk length: 61, Num walks: 212,416
  LR: 1.27e-04, Batch size: 32
  Model: emb_dim=16, hidden_dim=8
  Transformer: 3 layers, 1 heads
  Epochs: 12, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.541
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.544
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.548
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.551
❌ Trial 17 failed: Trial was pruned at epoch 8.
[I 2025-08-21 17:06:30,234] Trial 17 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 61, 'dataset.num_walks': 212416, 'training.lr': 0.00012701631038074037, 'training.weight_decay': 7.067292131108004e-05, 'training.batch_size': 32, 'training.gradient_clip_val': 0.8277901909240372, 'training.early_stopping_patience': 17, 'model.nhead_emb_combo': 2, 'model.hidden_dim': 8, 'model.nlayers': 3, 'model.dropout': 0.24788298779174656, 'training.epochs': 12}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 18 hyperparameters:
  Walk length: 49, Num walks: 174,398
  LR: 3.64e-05, Batch size: 256
  Model: emb_dim=16, hidden_dim=64
  Transformer: 5 layers, 4 heads
  Epochs: 23, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.506
Metric val_auc_epoch improved by 0.014 >= min_delta = 0.0. New best score: 0.520
Metric val_auc_epoch improved by 0.011 >= min_delta = 0.0. New best score: 0.531
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.539
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.544
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.547
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.548
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.548
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.548
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.548
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.549
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.549
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.549
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.549
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.549
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.549
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.549
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.549
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.549
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.549
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.549
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.549
`Trainer.fit` stopped: `max_epochs=23` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_18-epoch=22-val_auc_epoch=0.5494.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_18-epoch=22-val_auc_epoch=0.5494.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch          0.532688558101654
      val_auc_epoch          0.549405574798584
      val_f1_epoch          0.5279592275619507
        val_loss            0.6874112486839294
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 18 completed - Val AUC: 0.5494
[I 2025-08-21 17:12:02,697] Trial 18 finished with value: -0.549405574798584 and parameters: {'dataset.max_walk_length': 49, 'dataset.num_walks': 174398, 'training.lr': 3.639559874793787e-05, 'training.weight_decay': 0.021303120971638535, 'training.batch_size': 256, 'training.gradient_clip_val': 1.694599867480325, 'training.early_stopping_patience': 14, 'model.nhead_emb_combo': 14, 'model.hidden_dim': 64, 'model.nlayers': 5, 'model.dropout': 0.4470860947929083, 'training.epochs': 23}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 19 hyperparameters:
  Walk length: 79, Num walks: 432,436
  LR: 5.22e-04, Batch size: 128
  Model: emb_dim=64, hidden_dim=16
  Transformer: 2 layers, 2 heads
  Epochs: 18, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.633
Metric val_auc_epoch improved by 0.010 >= min_delta = 0.0. New best score: 0.644
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.646
❌ Trial 19 failed: Trial was pruned at epoch 5.
[I 2025-08-21 17:17:32,752] Trial 19 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 79, 'dataset.num_walks': 432436, 'training.lr': 0.0005218843434643345, 'training.weight_decay': 0.00035777391515629333, 'training.batch_size': 128, 'training.gradient_clip_val': 1.2171910439633584, 'training.early_stopping_patience': 10, 'model.nhead_emb_combo': 10, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.007423384300599016, 'training.epochs': 18}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 20 hyperparameters:
  Walk length: 11, Num walks: 242,150
  LR: 1.44e-02, Batch size: 512
  Model: emb_dim=64, hidden_dim=16
  Transformer: 1 layers, 8 heads
  Epochs: 19, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.560
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.562
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.563
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.564
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.572
❌ Trial 20 failed: Trial was pruned at epoch 5.
[I 2025-08-21 17:18:36,202] Trial 20 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 11, 'dataset.num_walks': 242150, 'training.lr': 0.014362109668663225, 'training.weight_decay': 0.0065731155204989435, 'training.batch_size': 512, 'training.gradient_clip_val': 0.37399829713520083, 'training.early_stopping_patience': 13, 'model.nhead_emb_combo': 21, 'model.hidden_dim': 16, 'model.nlayers': 1, 'model.dropout': 0.5531117803644058, 'training.epochs': 19}. Best is trial 1 with value: -0.6377121806144714.
🧹 Cleaning up old checkpoints and logs (keeping top 10)...
  Removed old checkpoint: trial_10-epoch=00-val_auc_epoch=0.6140.ckpt
  Removed old checkpoint: trial_9-epoch=04-val_auc_epoch=0.5637.ckpt
  Removed old checkpoint: trial_8-epoch=06-val_auc_epoch=0.5485.ckpt
  Removed old checkpoint: trial_7-epoch=03-val_auc_epoch=0.5468.ckpt
  Removed old checkpoint: trial_6-epoch=05-val_auc_epoch=0.5510.ckpt
  Removed old log dir: trial_10
  Removed old log dir: trial_9
  Removed old log dir: trial_8
  Removed old log dir: trial_7
  Removed old log dir: trial_6
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 21 hyperparameters:
  Walk length: 44, Num walks: 2,503,285
  LR: 5.96e-04, Batch size: 512
  Model: emb_dim=64, hidden_dim=32
  Transformer: 3 layers, 1 heads
  Epochs: 27, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.636
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.638
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.641
❌ Trial 21 failed: Trial was pruned at epoch 5.
[I 2025-08-21 17:35:34,984] Trial 21 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 44, 'dataset.num_walks': 2503285, 'training.lr': 0.0005958254088109622, 'training.weight_decay': 1.4136400698239849e-05, 'training.batch_size': 512, 'training.gradient_clip_val': 1.2684028879782359, 'training.early_stopping_patience': 20, 'model.nhead_emb_combo': 4, 'model.hidden_dim': 32, 'model.nlayers': 3, 'model.dropout': 0.3925876103365166, 'training.epochs': 27}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 22 hyperparameters:
  Walk length: 30, Num walks: 3,838,453
  LR: 1.94e-03, Batch size: 512
  Model: emb_dim=8, hidden_dim=32
  Transformer: 3 layers, 2 heads
  Epochs: 24, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.627
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.631
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.631
❌ Trial 22 failed: Trial was pruned at epoch 5.
[I 2025-08-21 17:58:06,167] Trial 22 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 30, 'dataset.num_walks': 3838453, 'training.lr': 0.0019370182450883708, 'training.weight_decay': 1.4303925717153883e-08, 'training.batch_size': 512, 'training.gradient_clip_val': 0.9480025580807598, 'training.early_stopping_patience': 18, 'model.nhead_emb_combo': 7, 'model.hidden_dim': 32, 'model.nlayers': 3, 'model.dropout': 0.2702524968087171, 'training.epochs': 24}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 23 hyperparameters:
  Walk length: 33, Num walks: 1,376,766
  LR: 3.05e-04, Batch size: 512
  Model: emb_dim=64, hidden_dim=32
  Transformer: 4 layers, 4 heads
  Epochs: 28, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.633
Metric val_auc_epoch improved by 0.021 >= min_delta = 0.0. New best score: 0.654
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.655
❌ Trial 23 failed: Trial was pruned at epoch 5.
[I 2025-08-21 18:07:29,973] Trial 23 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 33, 'dataset.num_walks': 1376766, 'training.lr': 0.0003050617688181637, 'training.weight_decay': 0.04049952697642224, 'training.batch_size': 512, 'training.gradient_clip_val': 0.696167124119422, 'training.early_stopping_patience': 20, 'model.nhead_emb_combo': 16, 'model.hidden_dim': 32, 'model.nlayers': 4, 'model.dropout': 0.4017667180710552, 'training.epochs': 28}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 24 hyperparameters:
  Walk length: 41, Num walks: 1,327,299
  LR: 9.25e-04, Batch size: 512
  Model: emb_dim=64, hidden_dim=64
  Transformer: 2 layers, 1 heads
  Epochs: 21, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.636
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.638
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.643
❌ Trial 24 failed: Trial was pruned at epoch 5.
[I 2025-08-21 18:15:43,607] Trial 24 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 41, 'dataset.num_walks': 1327299, 'training.lr': 0.000925457231734881, 'training.weight_decay': 0.023230253180435846, 'training.batch_size': 512, 'training.gradient_clip_val': 1.1281721664327402, 'training.early_stopping_patience': 15, 'model.nhead_emb_combo': 4, 'model.hidden_dim': 64, 'model.nlayers': 2, 'model.dropout': 0.1614533331284869, 'training.epochs': 21}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 25 hyperparameters:
  Walk length: 23, Num walks: 4,762,355
  LR: 1.21e-04, Batch size: 64
  Model: emb_dim=32, hidden_dim=32
  Transformer: 3 layers, 2 heads
  Epochs: 26, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.628
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.634
❌ Trial 25 failed: Trial was pruned at epoch 5.
[I 2025-08-21 19:52:02,786] Trial 25 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 23, 'dataset.num_walks': 4762355, 'training.lr': 0.00012074381892930366, 'training.weight_decay': 0.0011125916474795953, 'training.batch_size': 64, 'training.gradient_clip_val': 1.353158819338332, 'training.early_stopping_patience': 12, 'model.nhead_emb_combo': 9, 'model.hidden_dim': 32, 'model.nlayers': 3, 'model.dropout': 0.3737538724056414, 'training.epochs': 26}. Best is trial 1 with value: -0.6377121806144714.
🧹 Cleaning up old checkpoints and logs (keeping top 10)...
  Removed old checkpoint: trial_15-epoch=19-val_auc_epoch=0.5355.ckpt
  Removed old checkpoint: trial_14-epoch=01-val_auc_epoch=0.5401.ckpt
  Removed old checkpoint: trial_13-epoch=06-val_auc_epoch=0.5444.ckpt
  Removed old checkpoint: trial_12-epoch=13-val_auc_epoch=0.5347.ckpt
  Removed old checkpoint: trial_11-epoch=02-val_auc_epoch=0.5458.ckpt
  Removed old log dir: trial_15
  Removed old log dir: trial_14
  Removed old log dir: trial_13
  Removed old log dir: trial_12
  Removed old log dir: trial_11
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 26 hyperparameters:
  Walk length: 44, Num walks: 353,652
  LR: 7.99e-05, Batch size: 32
  Model: emb_dim=8, hidden_dim=4
  Transformer: 6 layers, 4 heads
  Epochs: 17, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.541
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.541
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.541
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.542
❌ Trial 26 failed: Trial was pruned at epoch 9.
[I 2025-08-21 20:21:54,854] Trial 26 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 44, 'dataset.num_walks': 353652, 'training.lr': 7.987871136014868e-05, 'training.weight_decay': 0.00984800695721389, 'training.batch_size': 32, 'training.gradient_clip_val': 1.6105447386456782, 'training.early_stopping_patience': 17, 'model.nhead_emb_combo': 13, 'model.hidden_dim': 4, 'model.nlayers': 6, 'model.dropout': 0.3015807040767062, 'training.epochs': 17}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 27 hyperparameters:
  Walk length: 62, Num walks: 513,275
  LR: 3.21e-04, Batch size: 512
  Model: emb_dim=64, hidden_dim=8
  Transformer: 4 layers, 4 heads
  Epochs: 23, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.541
Metric val_auc_epoch improved by 0.057 >= min_delta = 0.0. New best score: 0.598
Metric val_auc_epoch improved by 0.014 >= min_delta = 0.0. New best score: 0.612
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.617
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.617
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.617
❌ Trial 27 failed: Trial was pruned at epoch 9.
[I 2025-08-21 20:29:15,976] Trial 27 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 62, 'dataset.num_walks': 513275, 'training.lr': 0.00032098050705260054, 'training.weight_decay': 5.975836962269564e-06, 'training.batch_size': 512, 'training.gradient_clip_val': 1.1657049892444542, 'training.early_stopping_patience': 10, 'model.nhead_emb_combo': 16, 'model.hidden_dim': 8, 'model.nlayers': 4, 'model.dropout': 0.22953194164330076, 'training.epochs': 23}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 28 hyperparameters:
  Walk length: 98, Num walks: 596,173
  LR: 3.98e-03, Batch size: 32
  Model: emb_dim=128, hidden_dim=256
  Transformer: 2 layers, 1 heads
  Epochs: 20, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.516
Monitored metric val_auc_epoch did not improve in the last 14 records. Best score: 0.516. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_28-epoch=00-val_auc_epoch=0.5160.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_28-epoch=00-val_auc_epoch=0.5160.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch                 0.5
      val_auc_epoch         0.5159951448440552
      val_f1_epoch          0.3019578158855438
        val_loss            0.6932772994041443
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 28 completed - Val AUC: 0.5160
[I 2025-08-21 21:20:07,958] Trial 28 finished with value: -0.5159951448440552 and parameters: {'dataset.max_walk_length': 98, 'dataset.num_walks': 596173, 'training.lr': 0.0039784222910890015, 'training.weight_decay': 0.004607242302008484, 'training.batch_size': 32, 'training.gradient_clip_val': 1.2735955889635542, 'training.early_stopping_patience': 14, 'model.nhead_emb_combo': 5, 'model.hidden_dim': 256, 'model.nlayers': 2, 'model.dropout': 0.3635923033600216, 'training.epochs': 20}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 29 hyperparameters:
  Walk length: 26, Num walks: 149,274
  LR: 6.75e-04, Batch size: 64
  Model: emb_dim=8, hidden_dim=128
  Transformer: 5 layers, 2 heads
  Epochs: 29, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.554
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.555
❌ Trial 29 failed: Trial was pruned at epoch 6.
[I 2025-08-21 21:24:17,803] Trial 29 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 26, 'dataset.num_walks': 149274, 'training.lr': 0.0006751481046767676, 'training.weight_decay': 3.857797155908907e-08, 'training.batch_size': 64, 'training.gradient_clip_val': 1.5559590100759566, 'training.early_stopping_patience': 6, 'model.nhead_emb_combo': 7, 'model.hidden_dim': 128, 'model.nlayers': 5, 'model.dropout': 0.3055310303469307, 'training.epochs': 29}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 30 hyperparameters:
  Walk length: 70, Num walks: 248,700
  LR: 2.65e-04, Batch size: 64
  Model: emb_dim=4, hidden_dim=128
  Transformer: 3 layers, 1 heads
  Epochs: 12, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.492
Metric val_auc_epoch improved by 0.029 >= min_delta = 0.0. New best score: 0.521
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.524
Monitored metric val_auc_epoch did not improve in the last 8 records. Best score: 0.524. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_30-epoch=02-val_auc_epoch=0.5240.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_30-epoch=02-val_auc_epoch=0.5240.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5206987261772156
      val_auc_epoch          0.523987889289856
      val_f1_epoch          0.5207105278968811
        val_loss            0.6933507323265076
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 30 completed - Val AUC: 0.5240
[I 2025-08-21 21:33:52,010] Trial 30 finished with value: -0.523987889289856 and parameters: {'dataset.max_walk_length': 70, 'dataset.num_walks': 248700, 'training.lr': 0.0002652559177384779, 'training.weight_decay': 0.04118948485162637, 'training.batch_size': 64, 'training.gradient_clip_val': 1.3658177333167305, 'training.early_stopping_patience': 8, 'model.nhead_emb_combo': 0, 'model.hidden_dim': 128, 'model.nlayers': 3, 'model.dropout': 0.4472538754925977, 'training.epochs': 12}. Best is trial 1 with value: -0.6377121806144714.
🧹 Cleaning up old checkpoints and logs (keeping top 10)...
  Removed old checkpoint: trial_20-epoch=04-val_auc_epoch=0.5724.ckpt
  Removed old checkpoint: trial_19-epoch=03-val_auc_epoch=0.6459.ckpt
  Removed old checkpoint: trial_18-epoch=22-val_auc_epoch=0.5494.ckpt
  Removed old checkpoint: trial_17-epoch=07-val_auc_epoch=0.5509.ckpt
  Removed old checkpoint: trial_16-epoch=28-val_auc_epoch=0.5320.ckpt
  Removed old log dir: trial_20
  Removed old log dir: trial_19
  Removed old log dir: trial_18
  Removed old log dir: trial_17
  Removed old log dir: trial_16
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 31 hyperparameters:
  Walk length: 47, Num walks: 165,283
  LR: 2.81e-05, Batch size: 256
  Model: emb_dim=16, hidden_dim=64
  Transformer: 5 layers, 4 heads
  Epochs: 24, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.508
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.513
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.520
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.525
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.530
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.532
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.533
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.534
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.535
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.535
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.535
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.536
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.536
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.536
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.536
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.536
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.536
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.536
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.536
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.536
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.536
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.536
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.536
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.536
`Trainer.fit` stopped: `max_epochs=24` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_31-epoch=23-val_auc_epoch=0.5363.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_31-epoch=23-val_auc_epoch=0.5363.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5263703465461731
      val_auc_epoch          0.536283016204834
      val_f1_epoch          0.5212902426719666
        val_loss            0.6924615502357483
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 31 completed - Val AUC: 0.5363
[I 2025-08-21 21:39:07,273] Trial 31 finished with value: -0.536283016204834 and parameters: {'dataset.max_walk_length': 47, 'dataset.num_walks': 165283, 'training.lr': 2.8057833199533987e-05, 'training.weight_decay': 0.02733584585562815, 'training.batch_size': 256, 'training.gradient_clip_val': 1.7612790990612233, 'training.early_stopping_patience': 14, 'model.nhead_emb_combo': 14, 'model.hidden_dim': 64, 'model.nlayers': 5, 'model.dropout': 0.4391576543234791, 'training.epochs': 24}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 32 hyperparameters:
  Walk length: 49, Num walks: 196,984
  LR: 4.48e-05, Batch size: 256
  Model: emb_dim=32, hidden_dim=64
  Transformer: 5 layers, 2 heads
  Epochs: 23, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.549
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.552
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.554
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.555
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.555
❌ Trial 32 failed: Trial was pruned at epoch 5.
[I 2025-08-21 21:41:00,280] Trial 32 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 49, 'dataset.num_walks': 196984, 'training.lr': 4.477155287464194e-05, 'training.weight_decay': 0.009461356521510042, 'training.batch_size': 256, 'training.gradient_clip_val': 1.679216502013584, 'training.early_stopping_patience': 11, 'model.nhead_emb_combo': 9, 'model.hidden_dim': 64, 'model.nlayers': 5, 'model.dropout': 0.3512720047407699, 'training.epochs': 23}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 33 hyperparameters:
  Walk length: 34, Num walks: 142,354
  LR: 1.98e-05, Batch size: 256
  Model: emb_dim=128, hidden_dim=64
  Transformer: 6 layers, 4 heads
  Epochs: 30, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.541
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.544
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.544
❌ Trial 33 failed: Trial was pruned at epoch 8.
[I 2025-08-21 21:43:11,015] Trial 33 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 34, 'dataset.num_walks': 142354, 'training.lr': 1.978764480373747e-05, 'training.weight_decay': 0.08533031549520505, 'training.batch_size': 256, 'training.gradient_clip_val': 1.9929192473361277, 'training.early_stopping_patience': 15, 'model.nhead_emb_combo': 17, 'model.hidden_dim': 64, 'model.nlayers': 6, 'model.dropout': 0.5118205755562861, 'training.epochs': 30}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 34 hyperparameters:
  Walk length: 49, Num walks: 178,149
  LR: 4.39e-05, Batch size: 256
  Model: emb_dim=16, hidden_dim=64
  Transformer: 5 layers, 4 heads
  Epochs: 16, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.492
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.492
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.494
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.497
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.501
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.505
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.507
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.509
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.510
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.510
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.510
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.510
`Trainer.fit` stopped: `max_epochs=16` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_34-epoch=15-val_auc_epoch=0.5105.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_34-epoch=15-val_auc_epoch=0.5105.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5070133805274963
      val_auc_epoch         0.5104695558547974
      val_f1_epoch          0.48652732372283936
        val_loss            0.6940455436706543
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 34 completed - Val AUC: 0.5105
[I 2025-08-21 21:47:10,471] Trial 34 finished with value: -0.5104695558547974 and parameters: {'dataset.max_walk_length': 49, 'dataset.num_walks': 178149, 'training.lr': 4.389511597098438e-05, 'training.weight_decay': 0.002293608834849946, 'training.batch_size': 256, 'training.gradient_clip_val': 1.8268924675777454, 'training.early_stopping_patience': 16, 'model.nhead_emb_combo': 14, 'model.hidden_dim': 64, 'model.nlayers': 5, 'model.dropout': 0.5945737545825246, 'training.epochs': 16}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 35 hyperparameters:
  Walk length: 59, Num walks: 111,833
  LR: 3.09e-02, Batch size: 256
  Model: emb_dim=4, hidden_dim=4
  Transformer: 4 layers, 4 heads
  Epochs: 25, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.503
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.509
Metric val_auc_epoch improved by 0.031 >= min_delta = 0.0. New best score: 0.540
Monitored metric val_auc_epoch did not improve in the last 13 records. Best score: 0.540. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_35-epoch=04-val_auc_epoch=0.5405.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_35-epoch=04-val_auc_epoch=0.5405.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch                 0.5
      val_auc_epoch         0.5404638051986694
      val_f1_epoch          0.29882046580314636
        val_loss            0.6931459903717041
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 35 completed - Val AUC: 0.5405
[I 2025-08-21 21:50:10,145] Trial 35 finished with value: -0.5404638051986694 and parameters: {'dataset.max_walk_length': 59, 'dataset.num_walks': 111833, 'training.lr': 0.0309401550249818, 'training.weight_decay': 0.02697527403094845, 'training.batch_size': 256, 'training.gradient_clip_val': 1.6222735026416275, 'training.early_stopping_patience': 13, 'model.nhead_emb_combo': 12, 'model.hidden_dim': 4, 'model.nlayers': 4, 'model.dropout': 0.33177597378570983, 'training.epochs': 25}. Best is trial 1 with value: -0.6377121806144714.
🧹 Cleaning up old checkpoints and logs (keeping top 10)...
  Removed old checkpoint: trial_25-epoch=01-val_auc_epoch=0.6344.ckpt
  Removed old checkpoint: trial_24-epoch=03-val_auc_epoch=0.6429.ckpt
  Removed old checkpoint: trial_23-epoch=03-val_auc_epoch=0.6546.ckpt
  Removed old checkpoint: trial_22-epoch=02-val_auc_epoch=0.6314.ckpt
  Removed old checkpoint: trial_21-epoch=02-val_auc_epoch=0.6412.ckpt
  Removed old log dir: trial_25
  Removed old log dir: trial_24
  Removed old log dir: trial_23
  Removed old log dir: trial_22
  Removed old log dir: trial_21
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 36 hyperparameters:
  Walk length: 18, Num walks: 136,359
  LR: 1.33e-03, Batch size: 128
  Model: emb_dim=32, hidden_dim=32
  Transformer: 3 layers, 4 heads
  Epochs: 22, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.562
Metric val_auc_epoch improved by 0.030 >= min_delta = 0.0. New best score: 0.592
Metric val_auc_epoch improved by 0.016 >= min_delta = 0.0. New best score: 0.608
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.614
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.615
❌ Trial 36 failed: Trial was pruned at epoch 5.
[I 2025-08-21 21:51:43,762] Trial 36 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 18, 'dataset.num_walks': 136359, 'training.lr': 0.001330091313797223, 'training.weight_decay': 6.795041573527547e-05, 'training.batch_size': 128, 'training.gradient_clip_val': 1.458100683496855, 'training.early_stopping_patience': 11, 'model.nhead_emb_combo': 15, 'model.hidden_dim': 32, 'model.nlayers': 3, 'model.dropout': 0.41229133856206446, 'training.epochs': 22}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 37 hyperparameters:
  Walk length: 54, Num walks: 169,463
  LR: 8.64e-02, Batch size: 32
  Model: emb_dim=128, hidden_dim=16
  Transformer: 5 layers, 2 heads
  Epochs: 27, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.500
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.500
❌ Trial 37 failed: Input contains NaN.
[I 2025-08-21 21:58:13,951] Trial 37 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 54, 'dataset.num_walks': 169463, 'training.lr': 0.08641239036372984, 'training.weight_decay': 1.1497223734974586e-06, 'training.batch_size': 32, 'training.gradient_clip_val': 1.8191685287510597, 'training.early_stopping_patience': 17, 'model.nhead_emb_combo': 11, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.48223102499285053, 'training.epochs': 27}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 38 hyperparameters:
  Walk length: 40, Num walks: 383,927
  LR: 1.91e-04, Batch size: 64
  Model: emb_dim=64, hidden_dim=64
  Transformer: 4 layers, 8 heads
  Epochs: 20, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.555
Metric val_auc_epoch improved by 0.030 >= min_delta = 0.0. New best score: 0.585
Metric val_auc_epoch improved by 0.028 >= min_delta = 0.0. New best score: 0.613
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.621
❌ Trial 38 failed: Trial was pruned at epoch 5.
[I 2025-08-21 22:07:01,939] Trial 38 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 40, 'dataset.num_walks': 383927, 'training.lr': 0.00019107814699285166, 'training.weight_decay': 0.005160256560256423, 'training.batch_size': 64, 'training.gradient_clip_val': 1.518647939827024, 'training.early_stopping_patience': 19, 'model.nhead_emb_combo': 21, 'model.hidden_dim': 64, 'model.nlayers': 4, 'model.dropout': 0.5582945274354871, 'training.epochs': 20}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 39 hyperparameters:
  Walk length: 82, Num walks: 132,945
  LR: 8.45e-05, Batch size: 32
  Model: emb_dim=16, hidden_dim=8
  Transformer: 1 layers, 2 heads
  Epochs: 13, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.518
Metric val_auc_epoch improved by 0.025 >= min_delta = 0.0. New best score: 0.542
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.547
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.548
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.550
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.551
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.553
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.553
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.554
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.554
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.554
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.554
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.554
`Trainer.fit` stopped: `max_epochs=13` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_39-epoch=12-val_auc_epoch=0.5539.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_39-epoch=12-val_auc_epoch=0.5539.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5313148498535156
      val_auc_epoch          0.553939700126648
      val_f1_epoch          0.5153722167015076
        val_loss            0.6897670030593872
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 39 completed - Val AUC: 0.5539
[I 2025-08-21 22:15:40,889] Trial 39 finished with value: -0.553939700126648 and parameters: {'dataset.max_walk_length': 82, 'dataset.num_walks': 132945, 'training.lr': 8.454899079709662e-05, 'training.weight_decay': 0.00021042488272664768, 'training.batch_size': 32, 'training.gradient_clip_val': 1.664748544859573, 'training.early_stopping_patience': 12, 'model.nhead_emb_combo': 8, 'model.hidden_dim': 8, 'model.nlayers': 1, 'model.dropout': 0.630429362793769, 'training.epochs': 13}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 40 hyperparameters:
  Walk length: 90, Num walks: 125,880
  LR: 7.71e-05, Batch size: 32
  Model: emb_dim=4, hidden_dim=8
  Transformer: 1 layers, 2 heads
  Epochs: 12, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.497
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.497
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.497
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.498
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.499
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.499
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.499
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.499
`Trainer.fit` stopped: `max_epochs=12` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_40-epoch=09-val_auc_epoch=0.4994.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_40-epoch=09-val_auc_epoch=0.4994.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.4995322823524475
      val_auc_epoch         0.49936842918395996
      val_f1_epoch          0.4071542024612427
        val_loss            0.6931549906730652
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 40 completed - Val AUC: 0.4994
[I 2025-08-21 22:23:28,851] Trial 40 finished with value: -0.49936842918395996 and parameters: {'dataset.max_walk_length': 90, 'dataset.num_walks': 125880, 'training.lr': 7.709427657572404e-05, 'training.weight_decay': 0.00017321971014741555, 'training.batch_size': 32, 'training.gradient_clip_val': 1.8901211226115806, 'training.early_stopping_patience': 10, 'model.nhead_emb_combo': 6, 'model.hidden_dim': 8, 'model.nlayers': 1, 'model.dropout': 0.6475886169726724, 'training.epochs': 12}. Best is trial 1 with value: -0.6377121806144714.
🧹 Cleaning up old checkpoints and logs (keeping top 10)...
  Removed old checkpoint: trial_30-epoch=02-val_auc_epoch=0.5240.ckpt
  Removed old checkpoint: trial_29-epoch=05-val_auc_epoch=0.5545.ckpt
  Removed old checkpoint: trial_28-epoch=00-val_auc_epoch=0.5160.ckpt
  Removed old checkpoint: trial_27-epoch=05-val_auc_epoch=0.6172.ckpt
  Removed old checkpoint: trial_26-epoch=07-val_auc_epoch=0.5423.ckpt
  Removed old log dir: trial_30
  Removed old log dir: trial_29
  Removed old log dir: trial_28
  Removed old log dir: trial_27
  Removed old log dir: trial_26
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 41 hyperparameters:
  Walk length: 83, Num walks: 286,008
  LR: 2.76e-05, Batch size: 32
  Model: emb_dim=16, hidden_dim=8
  Transformer: 1 layers, 2 heads
  Epochs: 7, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.506
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.513
Metric val_auc_epoch improved by 0.009 >= min_delta = 0.0. New best score: 0.522
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.527
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.529
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.530
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.530
`Trainer.fit` stopped: `max_epochs=7` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_41-epoch=06-val_auc_epoch=0.5304.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_41-epoch=06-val_auc_epoch=0.5304.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5206575393676758
      val_auc_epoch         0.5304454565048218
      val_f1_epoch          0.5198383331298828
        val_loss            0.6920396089553833
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 41 completed - Val AUC: 0.5304
[I 2025-08-21 22:34:08,244] Trial 41 finished with value: -0.5304454565048218 and parameters: {'dataset.max_walk_length': 83, 'dataset.num_walks': 286008, 'training.lr': 2.7615940755977594e-05, 'training.weight_decay': 3.170373773852896e-05, 'training.batch_size': 32, 'training.gradient_clip_val': 1.693141476301784, 'training.early_stopping_patience': 12, 'model.nhead_emb_combo': 8, 'model.hidden_dim': 8, 'model.nlayers': 1, 'model.dropout': 0.6041204295254244, 'training.epochs': 7}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 42 hyperparameters:
  Walk length: 74, Num walks: 103,403
  LR: 1.32e-04, Batch size: 32
  Model: emb_dim=8, hidden_dim=8
  Transformer: 2 layers, 8 heads
  Epochs: 14, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.503
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.503
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.504
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.505
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.506
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.506
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.506
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.506
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.507
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.507
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.507
`Trainer.fit` stopped: `max_epochs=14` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_42-epoch=13-val_auc_epoch=0.5067.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_42-epoch=13-val_auc_epoch=0.5067.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5069743394851685
      val_auc_epoch         0.5066816806793213
      val_f1_epoch          0.5064349174499512
        val_loss            0.7020074725151062
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 42 completed - Val AUC: 0.5067
[I 2025-08-21 22:42:39,536] Trial 42 finished with value: -0.5066816806793213 and parameters: {'dataset.max_walk_length': 74, 'dataset.num_walks': 103403, 'training.lr': 0.00013183556416628974, 'training.weight_decay': 0.0009710677144428396, 'training.batch_size': 32, 'training.gradient_clip_val': 1.8736386570657888, 'training.early_stopping_patience': 14, 'model.nhead_emb_combo': 18, 'model.hidden_dim': 8, 'model.nlayers': 2, 'model.dropout': 0.5172790062707784, 'training.epochs': 14}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 43 hyperparameters:
  Walk length: 90, Num walks: 232,682
  LR: 4.17e-04, Batch size: 32
  Model: emb_dim=64, hidden_dim=8
  Transformer: 1 layers, 2 heads
  Epochs: 10, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.572
Metric val_auc_epoch improved by 0.025 >= min_delta = 0.0. New best score: 0.597
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.602
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.607
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.610
❌ Trial 43 failed: Trial was pruned at epoch 5.
[I 2025-08-21 22:49:52,402] Trial 43 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 90, 'dataset.num_walks': 232682, 'training.lr': 0.0004171521390346159, 'training.weight_decay': 4.4391696309048104e-08, 'training.batch_size': 32, 'training.gradient_clip_val': 1.753863430152643, 'training.early_stopping_patience': 11, 'model.nhead_emb_combo': 10, 'model.hidden_dim': 8, 'model.nlayers': 1, 'model.dropout': 0.6895128436830381, 'training.epochs': 10}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 44 hyperparameters:
  Walk length: 95, Num walks: 192,674
  LR: 1.82e-05, Batch size: 256
  Model: emb_dim=32, hidden_dim=16
  Transformer: 2 layers, 1 heads
  Epochs: 17, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.504
Metric val_auc_epoch improved by 0.010 >= min_delta = 0.0. New best score: 0.514
Metric val_auc_epoch improved by 0.014 >= min_delta = 0.0. New best score: 0.528
Metric val_auc_epoch improved by 0.014 >= min_delta = 0.0. New best score: 0.542
Metric val_auc_epoch improved by 0.010 >= min_delta = 0.0. New best score: 0.552
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.558
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.562
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.564
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.565
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.566
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.566
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.566
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.567
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.567
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.567
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.567
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.567
`Trainer.fit` stopped: `max_epochs=17` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_44-epoch=16-val_auc_epoch=0.5668.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_44-epoch=16-val_auc_epoch=0.5668.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5405032634735107
      val_auc_epoch         0.5668210983276367
      val_f1_epoch          0.5398372411727905
        val_loss            0.6872557997703552
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 44 completed - Val AUC: 0.5668
[I 2025-08-21 22:53:52,477] Trial 44 finished with value: -0.5668210983276367 and parameters: {'dataset.max_walk_length': 95, 'dataset.num_walks': 192674, 'training.lr': 1.819759117182158e-05, 'training.weight_decay': 0.0037693548557057033, 'training.batch_size': 256, 'training.gradient_clip_val': 1.9666445596863364, 'training.early_stopping_patience': 15, 'model.nhead_emb_combo': 3, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.47534379362140566, 'training.epochs': 17}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 45 hyperparameters:
  Walk length: 96, Num walks: 132,623
  LR: 1.69e-05, Batch size: 128
  Model: emb_dim=32, hidden_dim=16
  Transformer: 2 layers, 1 heads
  Epochs: 17, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.507
Metric val_auc_epoch improved by 0.011 >= min_delta = 0.0. New best score: 0.518
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.524
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.529
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.533
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.537
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.540
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.542
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.543
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.544
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.545
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.545
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.545
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.545
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.545
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.545
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.545
`Trainer.fit` stopped: `max_epochs=17` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_45-epoch=16-val_auc_epoch=0.5455.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_45-epoch=16-val_auc_epoch=0.5455.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch          0.529221773147583
      val_auc_epoch         0.5454674363136292
      val_f1_epoch          0.4897870421409607
        val_loss            0.6886157393455505
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 45 completed - Val AUC: 0.5455
[I 2025-08-21 22:58:01,136] Trial 45 finished with value: -0.5454674363136292 and parameters: {'dataset.max_walk_length': 96, 'dataset.num_walks': 132623, 'training.lr': 1.694210357553153e-05, 'training.weight_decay': 0.0025819353387782776, 'training.batch_size': 128, 'training.gradient_clip_val': 1.9625987155265576, 'training.early_stopping_patience': 16, 'model.nhead_emb_combo': 3, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.5733256419780465, 'training.epochs': 17}. Best is trial 1 with value: -0.6377121806144714.
🧹 Cleaning up old checkpoints and logs (keeping top 10)...
  Removed old checkpoint: trial_35-epoch=04-val_auc_epoch=0.5405.ckpt
  Removed old checkpoint: trial_34-epoch=15-val_auc_epoch=0.5105.ckpt
  Removed old checkpoint: trial_33-epoch=02-val_auc_epoch=0.5442.ckpt
  Removed old checkpoint: trial_32-epoch=04-val_auc_epoch=0.5552.ckpt
  Removed old checkpoint: trial_31-epoch=23-val_auc_epoch=0.5363.ckpt
  Removed old log dir: trial_35
  Removed old log dir: trial_34
  Removed old log dir: trial_33
  Removed old log dir: trial_32
  Removed old log dir: trial_31
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 46 hyperparameters:
  Walk length: 86, Num walks: 286,352
  LR: 1.21e-05, Batch size: 64
  Model: emb_dim=128, hidden_dim=16
  Transformer: 1 layers, 1 heads
  Epochs: 14, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.529
Metric val_auc_epoch improved by 0.010 >= min_delta = 0.0. New best score: 0.538
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.543
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.547
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.549
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.551
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.553
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.555
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.557
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.559
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.559
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.560
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.560
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.560
`Trainer.fit` stopped: `max_epochs=14` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_46-epoch=13-val_auc_epoch=0.5596.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_46-epoch=13-val_auc_epoch=0.5596.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5398514270782471
      val_auc_epoch         0.5595824718475342
      val_f1_epoch          0.5398684740066528
        val_loss            0.6885741949081421
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 46 completed - Val AUC: 0.5596
[I 2025-08-21 23:09:07,604] Trial 46 finished with value: -0.5595824718475342 and parameters: {'dataset.max_walk_length': 86, 'dataset.num_walks': 286352, 'training.lr': 1.2088808449628926e-05, 'training.weight_decay': 0.00035685470819585036, 'training.batch_size': 64, 'training.gradient_clip_val': 1.8790630241731927, 'training.early_stopping_patience': 9, 'model.nhead_emb_combo': 5, 'model.hidden_dim': 16, 'model.nlayers': 1, 'model.dropout': 0.6052809024859651, 'training.epochs': 14}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 47 hyperparameters:
  Walk length: 94, Num walks: 316,147
  LR: 1.01e-05, Batch size: 64
  Model: emb_dim=16, hidden_dim=16
  Transformer: 2 layers, 1 heads
  Epochs: 16, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.499
Metric val_auc_epoch improved by 0.012 >= min_delta = 0.0. New best score: 0.511
Metric val_auc_epoch improved by 0.010 >= min_delta = 0.0. New best score: 0.521
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.528
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.533
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.537
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.538
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.539
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.540
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.541
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.541
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.541
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.541
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.541
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.541
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.541
`Trainer.fit` stopped: `max_epochs=16` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_47-epoch=15-val_auc_epoch=0.5411.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_47-epoch=15-val_auc_epoch=0.5411.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5259173512458801
      val_auc_epoch         0.5411458015441895
      val_f1_epoch          0.5170301198959351
        val_loss            0.6904455423355103
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 47 completed - Val AUC: 0.5411
[I 2025-08-21 23:24:46,990] Trial 47 finished with value: -0.5411458015441895 and parameters: {'dataset.max_walk_length': 94, 'dataset.num_walks': 316147, 'training.lr': 1.0125743859044975e-05, 'training.weight_decay': 0.00042713818858638075, 'training.batch_size': 64, 'training.gradient_clip_val': 1.9080258336007954, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 2, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.5384835622798763, 'training.epochs': 16}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 48 hyperparameters:
  Walk length: 84, Num walks: 291,479
  LR: 1.55e-05, Batch size: 64
  Model: emb_dim=128, hidden_dim=16
  Transformer: 1 layers, 1 heads
  Epochs: 10, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.549
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.558
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.562
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.564
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.565
❌ Trial 48 failed: Trial was pruned at epoch 5.
[I 2025-08-21 23:29:57,678] Trial 48 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 84, 'dataset.num_walks': 291479, 'training.lr': 1.5519333069434946e-05, 'training.weight_decay': 0.0013828329094049431, 'training.batch_size': 64, 'training.gradient_clip_val': 1.982228044686097, 'training.early_stopping_patience': 8, 'model.nhead_emb_combo': 5, 'model.hidden_dim': 16, 'model.nlayers': 1, 'model.dropout': 0.5892213837726147, 'training.epochs': 10}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 49 hyperparameters:
  Walk length: 87, Num walks: 224,315
  LR: 2.37e-05, Batch size: 64
  Model: emb_dim=8, hidden_dim=16
  Transformer: 2 layers, 1 heads
  Epochs: 18, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.508
Metric val_auc_epoch improved by 0.014 >= min_delta = 0.0. New best score: 0.522
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.530
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.532
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.532
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.533
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.533
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.533
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.534
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.534
`Trainer.fit` stopped: `max_epochs=18` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_49-epoch=10-val_auc_epoch=0.5336.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_49-epoch=10-val_auc_epoch=0.5336.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5154298543930054
      val_auc_epoch         0.5335637331008911
      val_f1_epoch          0.47927743196487427
        val_loss            0.6923948526382446
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 49 completed - Val AUC: 0.5336
[I 2025-08-21 23:42:21,599] Trial 49 finished with value: -0.5335637331008911 and parameters: {'dataset.max_walk_length': 87, 'dataset.num_walks': 224315, 'training.lr': 2.3654761427894542e-05, 'training.weight_decay': 0.0005898104692472105, 'training.batch_size': 64, 'training.gradient_clip_val': 1.8036860106157933, 'training.early_stopping_patience': 9, 'model.nhead_emb_combo': 1, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.07567314146489344, 'training.epochs': 18}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 50 hyperparameters:
  Walk length: 78, Num walks: 392,903
  LR: 1.36e-05, Batch size: 64
  Model: emb_dim=64, hidden_dim=16
  Transformer: 2 layers, 1 heads
  Epochs: 14, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.534
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.537
Monitored metric val_auc_epoch did not improve in the last 7 records. Best score: 0.537. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_50-epoch=01-val_auc_epoch=0.5372.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_50-epoch=01-val_auc_epoch=0.5372.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5258898735046387
      val_auc_epoch         0.5372076034545898
      val_f1_epoch          0.5166711807250977
        val_loss            0.6922315359115601
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 50 completed - Val AUC: 0.5372
[I 2025-08-21 23:53:55,819] Trial 50 finished with value: -0.5372076034545898 and parameters: {'dataset.max_walk_length': 78, 'dataset.num_walks': 392903, 'training.lr': 1.3623934218684229e-05, 'training.weight_decay': 0.00306428421349062, 'training.batch_size': 64, 'training.gradient_clip_val': 1.5880316325881034, 'training.early_stopping_patience': 7, 'model.nhead_emb_combo': 4, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.4818200261275227, 'training.epochs': 14}. Best is trial 1 with value: -0.6377121806144714.
🧹 Cleaning up old checkpoints and logs (keeping top 10)...
  Removed old checkpoint: trial_40-epoch=09-val_auc_epoch=0.4994.ckpt
  Removed old checkpoint: trial_39-epoch=12-val_auc_epoch=0.5539.ckpt
  Removed old checkpoint: trial_38-epoch=04-val_auc_epoch=0.6210.ckpt
  Removed old checkpoint: trial_37-epoch=03-val_auc_epoch=0.5000.ckpt
  Removed old checkpoint: trial_36-epoch=04-val_auc_epoch=0.6153.ckpt
  Removed old log dir: trial_40
  Removed old log dir: trial_39
  Removed old log dir: trial_38
  Removed old log dir: trial_37
  Removed old log dir: trial_36
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 51 hyperparameters:
  Walk length: 93, Num walks: 179,989
  LR: 3.17e-05, Batch size: 32
  Model: emb_dim=4, hidden_dim=16
  Transformer: 1 layers, 2 heads
  Epochs: 13, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.501
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.501
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.501
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.502
`Trainer.fit` stopped: `max_epochs=13` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_51-epoch=06-val_auc_epoch=0.5018.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_51-epoch=06-val_auc_epoch=0.5018.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5000474452972412
      val_auc_epoch         0.5018413066864014
      val_f1_epoch          0.36118975281715393
        val_loss            0.6933388710021973
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 51 completed - Val AUC: 0.5018
[I 2025-08-22 00:05:51,164] Trial 51 finished with value: -0.5018413066864014 and parameters: {'dataset.max_walk_length': 93, 'dataset.num_walks': 179989, 'training.lr': 3.165408985697825e-05, 'training.weight_decay': 0.00014283262509738265, 'training.batch_size': 32, 'training.gradient_clip_val': 1.8626837003997014, 'training.early_stopping_patience': 12, 'model.nhead_emb_combo': 6, 'model.hidden_dim': 16, 'model.nlayers': 1, 'model.dropout': 0.6341125985100525, 'training.epochs': 13}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 52 hyperparameters:
  Walk length: 87, Num walks: 202,742
  LR: 1.86e-05, Batch size: 512
  Model: emb_dim=16, hidden_dim=256
  Transformer: 1 layers, 2 heads
  Epochs: 15, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.505
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.506
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.508
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.509
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.510
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.511
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.513
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.514
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.514
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.515
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.515
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.516
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.516
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.516
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.516
`Trainer.fit` stopped: `max_epochs=15` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_52-epoch=14-val_auc_epoch=0.5161.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_52-epoch=14-val_auc_epoch=0.5161.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch          0.511769711971283
      val_auc_epoch         0.5160846710205078
      val_f1_epoch          0.49389538168907166
        val_loss            0.6927862763404846
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 52 completed - Val AUC: 0.5161
[I 2025-08-22 00:08:42,932] Trial 52 finished with value: -0.5160846710205078 and parameters: {'dataset.max_walk_length': 87, 'dataset.num_walks': 202742, 'training.lr': 1.8607889204247486e-05, 'training.weight_decay': 0.00032654719901349, 'training.batch_size': 512, 'training.gradient_clip_val': 1.9198115332819585, 'training.early_stopping_patience': 15, 'model.nhead_emb_combo': 8, 'model.hidden_dim': 256, 'model.nlayers': 1, 'model.dropout': 0.6124052562373539, 'training.epochs': 15}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 53 hyperparameters:
  Walk length: 68, Num walks: 265,815
  LR: 5.72e-05, Batch size: 64
  Model: emb_dim=4, hidden_dim=16
  Transformer: 1 layers, 2 heads
  Epochs: 16, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.497
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.498
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.499
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.503
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.505
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.508
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.509
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.512
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.513
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.514
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.514
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.514
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.514
`Trainer.fit` stopped: `max_epochs=16` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_53-epoch=15-val_auc_epoch=0.5145.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_53-epoch=15-val_auc_epoch=0.5145.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5038392543792725
      val_auc_epoch         0.5144708156585693
      val_f1_epoch          0.43897032737731934
        val_loss             0.693080723285675
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 53 completed - Val AUC: 0.5145
[I 2025-08-22 00:20:16,416] Trial 53 finished with value: -0.5144708156585693 and parameters: {'dataset.max_walk_length': 68, 'dataset.num_walks': 265815, 'training.lr': 5.72229151559684e-05, 'training.weight_decay': 0.0018638270269087035, 'training.batch_size': 64, 'training.gradient_clip_val': 1.7655928042357327, 'training.early_stopping_patience': 9, 'model.nhead_emb_combo': 6, 'model.hidden_dim': 16, 'model.nlayers': 1, 'model.dropout': 0.6528484956070164, 'training.epochs': 16}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 54 hyperparameters:
  Walk length: 75, Num walks: 121,610
  LR: 1.10e-05, Batch size: 256
  Model: emb_dim=128, hidden_dim=32
  Transformer: 3 layers, 16 heads
  Epochs: 11, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.525
Metric val_auc_epoch improved by 0.012 >= min_delta = 0.0. New best score: 0.538
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.542
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.544
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.546
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.546
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.547
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.547
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.547
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.547
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.547
`Trainer.fit` stopped: `max_epochs=11` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_54-epoch=10-val_auc_epoch=0.5475.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_54-epoch=10-val_auc_epoch=0.5475.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5309897065162659
      val_auc_epoch         0.5474921464920044
      val_f1_epoch          0.5231325626373291
        val_loss            0.6915733218193054
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 54 completed - Val AUC: 0.5475
[I 2025-08-22 00:24:44,516] Trial 54 finished with value: -0.5474921464920044 and parameters: {'dataset.max_walk_length': 75, 'dataset.num_walks': 121610, 'training.lr': 1.0966251152228873e-05, 'training.weight_decay': 0.0002514352772632452, 'training.batch_size': 256, 'training.gradient_clip_val': 1.997534352534983, 'training.early_stopping_patience': 13, 'model.nhead_emb_combo': 26, 'model.hidden_dim': 32, 'model.nlayers': 3, 'model.dropout': 0.5767082728656201, 'training.epochs': 11}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 55 hyperparameters:
  Walk length: 86, Num walks: 144,710
  LR: 2.58e-05, Batch size: 32
  Model: emb_dim=16, hidden_dim=4
  Transformer: 2 layers, 2 heads
  Epochs: 13, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.514
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.520
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.524
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.528
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.533
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.538
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.542
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.544
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.545
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.546
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.547
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.547
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.547
`Trainer.fit` stopped: `max_epochs=13` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_55-epoch=12-val_auc_epoch=0.5469.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_55-epoch=12-val_auc_epoch=0.5469.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5321329832077026
      val_auc_epoch         0.5468882322311401
      val_f1_epoch          0.5151150226593018
        val_loss            0.6860716342926025
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 55 completed - Val AUC: 0.5469
[I 2025-08-22 00:35:31,782] Trial 55 finished with value: -0.5468882322311401 and parameters: {'dataset.max_walk_length': 86, 'dataset.num_walks': 144710, 'training.lr': 2.580179050209681e-05, 'training.weight_decay': 0.0006530565202262916, 'training.batch_size': 32, 'training.gradient_clip_val': 1.4648121769409808, 'training.early_stopping_patience': 19, 'model.nhead_emb_combo': 8, 'model.hidden_dim': 4, 'model.nlayers': 2, 'model.dropout': 0.532657945159486, 'training.epochs': 13}. Best is trial 1 with value: -0.6377121806144714.
🧹 Cleaning up old checkpoints and logs (keeping top 10)...
  Removed old checkpoint: trial_45-epoch=16-val_auc_epoch=0.5455.ckpt
  Removed old checkpoint: trial_44-epoch=16-val_auc_epoch=0.5668.ckpt
  Removed old checkpoint: trial_43-epoch=04-val_auc_epoch=0.6097.ckpt
  Removed old checkpoint: trial_42-epoch=13-val_auc_epoch=0.5067.ckpt
  Removed old checkpoint: trial_41-epoch=06-val_auc_epoch=0.5304.ckpt
  Removed old log dir: trial_45
  Removed old log dir: trial_44
  Removed old log dir: trial_43
  Removed old log dir: trial_42
  Removed old log dir: trial_41
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 56 hyperparameters:
  Walk length: 76, Num walks: 326,705
  LR: 1.48e-05, Batch size: 512
  Model: emb_dim=32, hidden_dim=16
  Transformer: 1 layers, 1 heads
  Epochs: 17, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.501
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.501
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.502
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.502
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.503
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.503
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.504
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.505
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.505
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.506
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.506
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.507
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.507
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.507
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.508
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.508
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.508
`Trainer.fit` stopped: `max_epochs=17` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_56-epoch=16-val_auc_epoch=0.5076.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_56-epoch=16-val_auc_epoch=0.5076.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5047109127044678
      val_auc_epoch         0.5075728893280029
      val_f1_epoch          0.5001898407936096
        val_loss            0.6940146088600159
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 56 completed - Val AUC: 0.5076
[I 2025-08-22 00:40:02,001] Trial 56 finished with value: -0.5075728893280029 and parameters: {'dataset.max_walk_length': 76, 'dataset.num_walks': 326705, 'training.lr': 1.4830745688156465e-05, 'training.weight_decay': 0.0011379287717192934, 'training.batch_size': 512, 'training.gradient_clip_val': 1.6741057201257656, 'training.early_stopping_patience': 10, 'model.nhead_emb_combo': 3, 'model.hidden_dim': 16, 'model.nlayers': 1, 'model.dropout': 0.6311230310583507, 'training.epochs': 17}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 57 hyperparameters:
  Walk length: 98, Num walks: 157,654
  LR: 4.12e-05, Batch size: 128
  Model: emb_dim=64, hidden_dim=32
  Transformer: 1 layers, 2 heads
  Epochs: 14, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.522
Metric val_auc_epoch improved by 0.011 >= min_delta = 0.0. New best score: 0.533
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.539
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.540
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.542
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.543
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.543
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.545
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.545
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.545
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.545
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.545
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.545
`Trainer.fit` stopped: `max_epochs=14` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_57-epoch=13-val_auc_epoch=0.5453.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_57-epoch=13-val_auc_epoch=0.5453.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5299664735794067
      val_auc_epoch         0.5453216433525085
      val_f1_epoch          0.5274671316146851
        val_loss            0.6884435415267944
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 57 completed - Val AUC: 0.5453
[I 2025-08-22 00:43:52,679] Trial 57 finished with value: -0.5453216433525085 and parameters: {'dataset.max_walk_length': 98, 'dataset.num_walks': 157654, 'training.lr': 4.123899444160076e-05, 'training.weight_decay': 0.006975404035904385, 'training.batch_size': 128, 'training.gradient_clip_val': 1.8362848262285119, 'training.early_stopping_patience': 18, 'model.nhead_emb_combo': 10, 'model.hidden_dim': 32, 'model.nlayers': 1, 'model.dropout': 0.5628670635090138, 'training.epochs': 14}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 58 hyperparameters:
  Walk length: 100, Num walks: 214,201
  LR: 2.32e-05, Batch size: 64
  Model: emb_dim=128, hidden_dim=16
  Transformer: 3 layers, 1 heads
  Epochs: 19, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.540
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.544
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.546
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.546
❌ Trial 58 failed: Trial was pruned at epoch 6.
[I 2025-08-22 00:49:20,972] Trial 58 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 100, 'dataset.num_walks': 214201, 'training.lr': 2.3173025756043382e-05, 'training.weight_decay': 8.378925006718107e-05, 'training.batch_size': 64, 'training.gradient_clip_val': 0.9235871660337918, 'training.early_stopping_patience': 16, 'model.nhead_emb_combo': 5, 'model.hidden_dim': 16, 'model.nlayers': 3, 'model.dropout': 0.6794039658873807, 'training.epochs': 19}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 59 hyperparameters:
  Walk length: 81, Num walks: 256,503
  LR: 5.76e-05, Batch size: 512
  Model: emb_dim=4, hidden_dim=128
  Transformer: 3 layers, 4 heads
  Epochs: 13, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.499
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.501
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.503
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.504
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.504
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.505
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.506
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.506
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.506
`Trainer.fit` stopped: `max_epochs=13` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_59-epoch=09-val_auc_epoch=0.5062.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_59-epoch=09-val_auc_epoch=0.5062.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch                 0.5
      val_auc_epoch         0.5062332153320312
      val_f1_epoch          0.36421504616737366
        val_loss            0.6932559013366699
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 59 completed - Val AUC: 0.5062
[I 2025-08-22 00:55:34,129] Trial 59 finished with value: -0.5062332153320312 and parameters: {'dataset.max_walk_length': 81, 'dataset.num_walks': 256503, 'training.lr': 5.760112130485355e-05, 'training.weight_decay': 0.0036044873359029252, 'training.batch_size': 512, 'training.gradient_clip_val': 1.7478946823342651, 'training.early_stopping_patience': 12, 'model.nhead_emb_combo': 12, 'model.hidden_dim': 128, 'model.nlayers': 3, 'model.dropout': 0.667177832618411, 'training.epochs': 13}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 60 hyperparameters:
  Walk length: 23, Num walks: 117,149
  LR: 3.63e-05, Batch size: 32
  Model: emb_dim=32, hidden_dim=8
  Transformer: 2 layers, 1 heads
  Epochs: 15, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.515
Metric val_auc_epoch improved by 0.020 >= min_delta = 0.0. New best score: 0.535
Metric val_auc_epoch improved by 0.018 >= min_delta = 0.0. New best score: 0.552
Metric val_auc_epoch improved by 0.009 >= min_delta = 0.0. New best score: 0.561
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.564
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.566
Monitored metric val_auc_epoch did not improve in the last 7 records. Best score: 0.566. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_60-epoch=05-val_auc_epoch=0.5656.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_60-epoch=05-val_auc_epoch=0.5656.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch          0.546844482421875
      val_auc_epoch         0.5655671954154968
      val_f1_epoch          0.5426652431488037
        val_loss            0.6868700385093689
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 60 completed - Val AUC: 0.5656
[I 2025-08-22 01:03:31,296] Trial 60 finished with value: -0.5655671954154968 and parameters: {'dataset.max_walk_length': 23, 'dataset.num_walks': 117149, 'training.lr': 3.625906365654314e-05, 'training.weight_decay': 0.013040983918182081, 'training.batch_size': 32, 'training.gradient_clip_val': 1.9140773504105641, 'training.early_stopping_patience': 7, 'model.nhead_emb_combo': 3, 'model.hidden_dim': 8, 'model.nlayers': 2, 'model.dropout': 0.5992280604505974, 'training.epochs': 15}. Best is trial 1 with value: -0.6377121806144714.
🧹 Cleaning up old checkpoints and logs (keeping top 10)...
  Removed old checkpoint: trial_50-epoch=01-val_auc_epoch=0.5372.ckpt
  Removed old checkpoint: trial_49-epoch=10-val_auc_epoch=0.5336.ckpt
  Removed old checkpoint: trial_48-epoch=04-val_auc_epoch=0.5649.ckpt
  Removed old checkpoint: trial_47-epoch=15-val_auc_epoch=0.5411.ckpt
  Removed old checkpoint: trial_46-epoch=13-val_auc_epoch=0.5596.ckpt
  Removed old log dir: trial_50
  Removed old log dir: trial_49
  Removed old log dir: trial_48
  Removed old log dir: trial_47
  Removed old log dir: trial_46
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 61 hyperparameters:
  Walk length: 25, Num walks: 116,894
  LR: 3.21e-05, Batch size: 32
  Model: emb_dim=32, hidden_dim=8
  Transformer: 2 layers, 1 heads
  Epochs: 15, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.508
Metric val_auc_epoch improved by 0.016 >= min_delta = 0.0. New best score: 0.524
Metric val_auc_epoch improved by 0.013 >= min_delta = 0.0. New best score: 0.537
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.543
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.546
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.547
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.547
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.547
Monitored metric val_auc_epoch did not improve in the last 7 records. Best score: 0.547. Signaling Trainer to stop.
`Trainer.fit` stopped: `max_epochs=15` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_61-epoch=07-val_auc_epoch=0.5469.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_61-epoch=07-val_auc_epoch=0.5469.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5338680744171143
      val_auc_epoch         0.5468695163726807
      val_f1_epoch          0.5309566259384155
        val_loss            0.6907833814620972
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 61 completed - Val AUC: 0.5469
[I 2025-08-22 01:12:39,926] Trial 61 finished with value: -0.5468695163726807 and parameters: {'dataset.max_walk_length': 25, 'dataset.num_walks': 116894, 'training.lr': 3.206105743744561e-05, 'training.weight_decay': 0.014371115633679227, 'training.batch_size': 32, 'training.gradient_clip_val': 1.920039005299183, 'training.early_stopping_patience': 7, 'model.nhead_emb_combo': 3, 'model.hidden_dim': 8, 'model.nlayers': 2, 'model.dropout': 0.6210931627390757, 'training.epochs': 15}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 62 hyperparameters:
  Walk length: 17, Num walks: 100,846
  LR: 7.23e-05, Batch size: 32
  Model: emb_dim=8, hidden_dim=8
  Transformer: 2 layers, 1 heads
  Epochs: 16, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.507
Metric val_auc_epoch improved by 0.009 >= min_delta = 0.0. New best score: 0.516
Metric val_auc_epoch improved by 0.012 >= min_delta = 0.0. New best score: 0.528
Metric val_auc_epoch improved by 0.010 >= min_delta = 0.0. New best score: 0.538
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.542
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.545
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.546
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.547
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.548
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.549
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.549
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.549
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.549
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.550
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.550
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.550
`Trainer.fit` stopped: `max_epochs=16` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_62-epoch=15-val_auc_epoch=0.5496.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_62-epoch=15-val_auc_epoch=0.5496.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5357434153556824
      val_auc_epoch          0.549564778804779
      val_f1_epoch           0.533677339553833
        val_loss            0.6897141337394714
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 62 completed - Val AUC: 0.5496
[I 2025-08-22 01:20:59,844] Trial 62 finished with value: -0.549564778804779 and parameters: {'dataset.max_walk_length': 17, 'dataset.num_walks': 100846, 'training.lr': 7.227155641803048e-05, 'training.weight_decay': 0.06336029543619678, 'training.batch_size': 32, 'training.gradient_clip_val': 1.9265374612459878, 'training.early_stopping_patience': 6, 'model.nhead_emb_combo': 1, 'model.hidden_dim': 8, 'model.nlayers': 2, 'model.dropout': 0.6976726761447886, 'training.epochs': 16}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 63 hyperparameters:
  Walk length: 28, Num walks: 119,358
  LR: 2.02e-05, Batch size: 32
  Model: emb_dim=16, hidden_dim=8
  Transformer: 2 layers, 1 heads
  Epochs: 17, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.522
Metric val_auc_epoch improved by 0.013 >= min_delta = 0.0. New best score: 0.535
Metric val_auc_epoch improved by 0.012 >= min_delta = 0.0. New best score: 0.548
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.554
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.557
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.559
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.560
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.561
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.561
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.561
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.561
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.562
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.562
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.562
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.562
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.562
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.562
`Trainer.fit` stopped: `max_epochs=17` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_63-epoch=16-val_auc_epoch=0.5618.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_63-epoch=16-val_auc_epoch=0.5618.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5431752800941467
      val_auc_epoch         0.5617997646331787
      val_f1_epoch          0.5425503849983215
        val_loss             0.687792181968689
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 63 completed - Val AUC: 0.5618
[I 2025-08-22 01:31:32,105] Trial 63 finished with value: -0.5617997646331787 and parameters: {'dataset.max_walk_length': 28, 'dataset.num_walks': 119358, 'training.lr': 2.0159590013936035e-05, 'training.weight_decay': 0.016736534726127628, 'training.batch_size': 32, 'training.gradient_clip_val': 1.8555869852390499, 'training.early_stopping_patience': 6, 'model.nhead_emb_combo': 2, 'model.hidden_dim': 8, 'model.nlayers': 2, 'model.dropout': 0.5859425908912606, 'training.epochs': 17}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 64 hyperparameters:
  Walk length: 28, Num walks: 114,944
  LR: 2.19e-05, Batch size: 32
  Model: emb_dim=4, hidden_dim=256
  Transformer: 2 layers, 1 heads
  Epochs: 18, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.519
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.519
Monitored metric val_auc_epoch did not improve in the last 6 records. Best score: 0.519. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_64-epoch=01-val_auc_epoch=0.5190.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_64-epoch=01-val_auc_epoch=0.5190.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5017024278640747
      val_auc_epoch          0.518998384475708
      val_f1_epoch          0.32346290349960327
        val_loss             0.693223774433136
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 64 completed - Val AUC: 0.5190
[I 2025-08-22 01:36:32,128] Trial 64 finished with value: -0.518998384475708 and parameters: {'dataset.max_walk_length': 28, 'dataset.num_walks': 114944, 'training.lr': 2.1895759445910808e-05, 'training.weight_decay': 0.0149526597863272, 'training.batch_size': 32, 'training.gradient_clip_val': 1.5246928697188693, 'training.early_stopping_patience': 6, 'model.nhead_emb_combo': 0, 'model.hidden_dim': 256, 'model.nlayers': 2, 'model.dropout': 0.5860935374483425, 'training.epochs': 18}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 65 hyperparameters:
  Walk length: 13, Num walks: 190,996
  LR: 1.35e-05, Batch size: 256
  Model: emb_dim=16, hidden_dim=8
  Transformer: 2 layers, 1 heads
  Epochs: 17, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.499
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.504
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.509
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.514
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.518
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.523
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.526
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.530
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.533
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.536
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.538
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.540
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.541
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.542
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.542
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.542
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.542
`Trainer.fit` stopped: `max_epochs=17` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_65-epoch=16-val_auc_epoch=0.5423.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_65-epoch=16-val_auc_epoch=0.5423.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5279657244682312
      val_auc_epoch         0.5422638058662415
      val_f1_epoch          0.5094752907752991
        val_loss            0.6913323998451233
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 65 completed - Val AUC: 0.5423
[I 2025-08-22 01:39:41,643] Trial 65 finished with value: -0.5422638058662415 and parameters: {'dataset.max_walk_length': 13, 'dataset.num_walks': 190996, 'training.lr': 1.3521852868599628e-05, 'training.weight_decay': 0.006901008665911001, 'training.batch_size': 256, 'training.gradient_clip_val': 1.881667064990274, 'training.early_stopping_patience': 7, 'model.nhead_emb_combo': 2, 'model.hidden_dim': 8, 'model.nlayers': 2, 'model.dropout': 0.5520957017110889, 'training.epochs': 17}. Best is trial 1 with value: -0.6377121806144714.
🧹 Cleaning up old checkpoints and logs (keeping top 10)...
  Removed old checkpoint: trial_55-epoch=12-val_auc_epoch=0.5469.ckpt
  Removed old checkpoint: trial_54-epoch=10-val_auc_epoch=0.5475.ckpt
  Removed old checkpoint: trial_53-epoch=15-val_auc_epoch=0.5145.ckpt
  Removed old checkpoint: trial_52-epoch=14-val_auc_epoch=0.5161.ckpt
  Removed old checkpoint: trial_51-epoch=06-val_auc_epoch=0.5018.ckpt
  Removed old log dir: trial_55
  Removed old log dir: trial_54
  Removed old log dir: trial_53
  Removed old log dir: trial_52
  Removed old log dir: trial_51
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 66 hyperparameters:
  Walk length: 36, Num walks: 151,678
  LR: 3.59e-05, Batch size: 32
  Model: emb_dim=128, hidden_dim=32
  Transformer: 3 layers, 1 heads
  Epochs: 20, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.556
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.557
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.563
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.571
Metric val_auc_epoch improved by 0.010 >= min_delta = 0.0. New best score: 0.581
❌ Trial 66 failed: Trial was pruned at epoch 5.
[I 2025-08-22 01:45:26,806] Trial 66 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 36, 'dataset.num_walks': 151678, 'training.lr': 3.587802546583223e-05, 'training.weight_decay': 0.04306763733970723, 'training.batch_size': 32, 'training.gradient_clip_val': 1.7956221030156856, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 5, 'model.hidden_dim': 32, 'model.nlayers': 3, 'model.dropout': 0.6113735013331846, 'training.epochs': 20}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 67 hyperparameters:
  Walk length: 21, Num walks: 159,964
  LR: 1.69e-05, Batch size: 512
  Model: emb_dim=64, hidden_dim=16
  Transformer: 2 layers, 1 heads
  Epochs: 26, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.522
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.529
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.536
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.541
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.545
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.548
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.550
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.551
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.552
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.553
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.554
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.555
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.556
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.556
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.556
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.556
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.556
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.557
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.557
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.557
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.557
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.557
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.557
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.557
`Trainer.fit` stopped: `max_epochs=26` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_67-epoch=23-val_auc_epoch=0.5569.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_67-epoch=23-val_auc_epoch=0.5569.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5414151549339294
      val_auc_epoch          0.556909441947937
      val_f1_epoch          0.5409878492355347
        val_loss            0.6894945502281189
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 67 completed - Val AUC: 0.5569
[I 2025-08-22 01:48:13,661] Trial 67 finished with value: -0.556909441947937 and parameters: {'dataset.max_walk_length': 21, 'dataset.num_walks': 159964, 'training.lr': 1.6887131833935383e-05, 'training.weight_decay': 0.016074009660064552, 'training.batch_size': 512, 'training.gradient_clip_val': 0.7511383945548671, 'training.early_stopping_patience': 8, 'model.nhead_emb_combo': 4, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.6599144753810111, 'training.epochs': 26}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 68 hyperparameters:
  Walk length: 21, Num walks: 159,424
  LR: 1.82e-05, Batch size: 64
  Model: emb_dim=16, hidden_dim=16
  Transformer: 2 layers, 1 heads
  Epochs: 15, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.519
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.526
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.534
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.542
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.548
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.551
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.554
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.556
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.557
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.558
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.558
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.558
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.559
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.559
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.559
`Trainer.fit` stopped: `max_epochs=15` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_68-epoch=14-val_auc_epoch=0.5587.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_68-epoch=14-val_auc_epoch=0.5587.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5395880341529846
      val_auc_epoch         0.5586729049682617
      val_f1_epoch          0.5347466468811035
        val_loss            0.6890915632247925
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 68 completed - Val AUC: 0.5587
[I 2025-08-22 01:55:12,107] Trial 68 finished with value: -0.5586729049682617 and parameters: {'dataset.max_walk_length': 21, 'dataset.num_walks': 159424, 'training.lr': 1.8237472948143317e-05, 'training.weight_decay': 0.016976181628802333, 'training.batch_size': 64, 'training.gradient_clip_val': 0.7319651378402391, 'training.early_stopping_patience': 6, 'model.nhead_emb_combo': 2, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.6635876813041873, 'training.epochs': 15}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 69 hyperparameters:
  Walk length: 22, Num walks: 187,452
  LR: 1.05e-05, Batch size: 64
  Model: emb_dim=8, hidden_dim=16
  Transformer: 2 layers, 1 heads
  Epochs: 15, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.502
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.506
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.509
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.511
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.512
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.513
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.514
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.514
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.515
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.515
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.516
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.516
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.516
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.516
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.516
`Trainer.fit` stopped: `max_epochs=15` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_69-epoch=14-val_auc_epoch=0.5161.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_69-epoch=14-val_auc_epoch=0.5161.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5105376243591309
      val_auc_epoch          0.516132652759552
      val_f1_epoch          0.4957273602485657
        val_loss            0.6927184462547302
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 69 completed - Val AUC: 0.5161
[I 2025-08-22 02:03:24,647] Trial 69 finished with value: -0.516132652759552 and parameters: {'dataset.max_walk_length': 22, 'dataset.num_walks': 187452, 'training.lr': 1.0462122513036109e-05, 'training.weight_decay': 0.008929641331718424, 'training.batch_size': 64, 'training.gradient_clip_val': 0.6080496337727365, 'training.early_stopping_patience': 6, 'model.nhead_emb_combo': 1, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.6685250727521356, 'training.epochs': 15}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 70 hyperparameters:
  Walk length: 10, Num walks: 136,962
  LR: 1.38e-05, Batch size: 64
  Model: emb_dim=4, hidden_dim=16
  Transformer: 2 layers, 1 heads
  Epochs: 18, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.505
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.507
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.508
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.509
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.511
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.512
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.513
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.514
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.514
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.515
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.515
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.515
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/loops/optimization/automatic.py:134: `training_step` returned `None`. If this was on purpose, ignore this warning...
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.516
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.516
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.516
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.516
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.516
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.516
`Trainer.fit` stopped: `max_epochs=18` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_70-epoch=17-val_auc_epoch=0.5159.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_70-epoch=17-val_auc_epoch=0.5159.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5040574073791504
      val_auc_epoch         0.5159033536911011
      val_f1_epoch          0.49965840578079224
        val_loss            0.6928792595863342
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 70 completed - Val AUC: 0.5159
[I 2025-08-22 02:10:02,622] Trial 70 finished with value: -0.5159033536911011 and parameters: {'dataset.max_walk_length': 10, 'dataset.num_walks': 136962, 'training.lr': 1.3782074723273345e-05, 'training.weight_decay': 0.005145188021398848, 'training.batch_size': 64, 'training.gradient_clip_val': 1.9540429901873453, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 0, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.5987063152317083, 'training.epochs': 18}. Best is trial 1 with value: -0.6377121806144714.
🧹 Cleaning up old checkpoints and logs (keeping top 10)...
  Removed old checkpoint: trial_60-epoch=05-val_auc_epoch=0.5656.ckpt
  Removed old checkpoint: trial_59-epoch=09-val_auc_epoch=0.5062.ckpt
  Removed old checkpoint: trial_58-epoch=05-val_auc_epoch=0.5465.ckpt
  Removed old checkpoint: trial_57-epoch=13-val_auc_epoch=0.5453.ckpt
  Removed old checkpoint: trial_56-epoch=16-val_auc_epoch=0.5076.ckpt
  Removed old log dir: trial_60
  Removed old log dir: trial_59
  Removed old log dir: trial_58
  Removed old log dir: trial_57
  Removed old log dir: trial_56
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 71 hyperparameters:
  Walk length: 20, Num walks: 160,687
  LR: 1.93e-05, Batch size: 64
  Model: emb_dim=32, hidden_dim=16
  Transformer: 2 layers, 1 heads
  Epochs: 16, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.533
Metric val_auc_epoch improved by 0.013 >= min_delta = 0.0. New best score: 0.546
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.552
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.556
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.558
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.559
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.560
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.560
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.561
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.561
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.561
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.561
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.561
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.561
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.561
`Trainer.fit` stopped: `max_epochs=16` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_71-epoch=15-val_auc_epoch=0.5614.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_71-epoch=15-val_auc_epoch=0.5614.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5424978137016296
      val_auc_epoch         0.5614153146743774
      val_f1_epoch          0.5418967008590698
        val_loss             0.687157928943634
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 71 completed - Val AUC: 0.5614
[I 2025-08-22 02:17:28,763] Trial 71 finished with value: -0.5614153146743774 and parameters: {'dataset.max_walk_length': 20, 'dataset.num_walks': 160687, 'training.lr': 1.9347353505090522e-05, 'training.weight_decay': 0.017552927613663123, 'training.batch_size': 64, 'training.gradient_clip_val': 0.7866097605698926, 'training.early_stopping_patience': 8, 'model.nhead_emb_combo': 3, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.6550103288061502, 'training.epochs': 16}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 72 hyperparameters:
  Walk length: 32, Num walks: 118,105
  LR: 1.98e-05, Batch size: 64
  Model: emb_dim=16, hidden_dim=16
  Transformer: 2 layers, 1 heads
  Epochs: 16, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.517
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.521
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.525
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.529
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.533
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.536
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.538
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.540
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.541
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.542
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.543
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.543
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.543
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.544
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.544
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.544
`Trainer.fit` stopped: `max_epochs=16` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_72-epoch=15-val_auc_epoch=0.5437.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_72-epoch=15-val_auc_epoch=0.5437.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5286226868629456
      val_auc_epoch         0.5437235832214355
      val_f1_epoch          0.5211834907531738
        val_loss            0.6904787421226501
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 72 completed - Val AUC: 0.5437
[I 2025-08-22 02:23:07,761] Trial 72 finished with value: -0.5437235832214355 and parameters: {'dataset.max_walk_length': 32, 'dataset.num_walks': 118105, 'training.lr': 1.983441353878526e-05, 'training.weight_decay': 0.02121068335672068, 'training.batch_size': 64, 'training.gradient_clip_val': 0.8123114287548635, 'training.early_stopping_patience': 7, 'model.nhead_emb_combo': 2, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.6454563738886284, 'training.epochs': 16}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 73 hyperparameters:
  Walk length: 14, Num walks: 166,370
  LR: 2.87e-05, Batch size: 64
  Model: emb_dim=32, hidden_dim=16
  Transformer: 2 layers, 1 heads
  Epochs: 14, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.520
Metric val_auc_epoch improved by 0.018 >= min_delta = 0.0. New best score: 0.538
Metric val_auc_epoch improved by 0.011 >= min_delta = 0.0. New best score: 0.549
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.555
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.558
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.560
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.561
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.561
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.561
`Trainer.fit` stopped: `max_epochs=14` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_73-epoch=08-val_auc_epoch=0.5612.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_73-epoch=08-val_auc_epoch=0.5612.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5440067052841187
      val_auc_epoch         0.5612401962280273
      val_f1_epoch          0.5374130010604858
        val_loss            0.6876208782196045
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 73 completed - Val AUC: 0.5612
[I 2025-08-22 02:29:29,760] Trial 73 finished with value: -0.5612401962280273 and parameters: {'dataset.max_walk_length': 14, 'dataset.num_walks': 166370, 'training.lr': 2.8688158931854663e-05, 'training.weight_decay': 0.0526357650573757, 'training.batch_size': 64, 'training.gradient_clip_val': 1.8498588655848276, 'training.early_stopping_patience': 6, 'model.nhead_emb_combo': 3, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.6755450788148427, 'training.epochs': 14}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 74 hyperparameters:
  Walk length: 15, Num walks: 229,496
  LR: 3.50e-05, Batch size: 64
  Model: emb_dim=32, hidden_dim=16
  Transformer: 2 layers, 1 heads
  Epochs: 14, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.548
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.555
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.555
❌ Trial 74 failed: Trial was pruned at epoch 5.
[I 2025-08-22 02:33:21,739] Trial 74 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 15, 'dataset.num_walks': 229496, 'training.lr': 3.498536555206507e-05, 'training.weight_decay': 0.0485089573737582, 'training.batch_size': 64, 'training.gradient_clip_val': 1.8583882676335255, 'training.early_stopping_patience': 9, 'model.nhead_emb_combo': 3, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.6184706931350021, 'training.epochs': 14}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 75 hyperparameters:
  Walk length: 14, Num walks: 201,476
  LR: 4.73e-05, Batch size: 64
  Model: emb_dim=64, hidden_dim=4
  Transformer: 3 layers, 1 heads
  Epochs: 17, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.565
❌ Trial 75 failed: Trial was pruned at epoch 5.
[I 2025-08-22 02:37:09,454] Trial 75 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 14, 'dataset.num_walks': 201476, 'training.lr': 4.730930497854226e-05, 'training.weight_decay': 0.03261955616567162, 'training.batch_size': 64, 'training.gradient_clip_val': 1.8019060502787758, 'training.early_stopping_patience': 7, 'model.nhead_emb_combo': 4, 'model.hidden_dim': 4, 'model.nlayers': 3, 'model.dropout': 0.6382254375100382, 'training.epochs': 17}. Best is trial 1 with value: -0.6377121806144714.
🧹 Cleaning up old checkpoints and logs (keeping top 10)...
  Removed old checkpoint: trial_65-epoch=16-val_auc_epoch=0.5423.ckpt
  Removed old checkpoint: trial_64-epoch=01-val_auc_epoch=0.5190.ckpt
  Removed old checkpoint: trial_63-epoch=16-val_auc_epoch=0.5618.ckpt
  Removed old checkpoint: trial_62-epoch=15-val_auc_epoch=0.5496.ckpt
  Removed old checkpoint: trial_61-epoch=07-val_auc_epoch=0.5469.ckpt
  Removed old log dir: trial_65
  Removed old log dir: trial_64
  Removed old log dir: trial_63
  Removed old log dir: trial_62
  Removed old log dir: trial_61
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 76 hyperparameters:
  Walk length: 19, Num walks: 175,815
  LR: 2.75e-05, Batch size: 64
  Model: emb_dim=32, hidden_dim=64
  Transformer: 2 layers, 1 heads
  Epochs: 16, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.547
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.553
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.554
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.554
❌ Trial 76 failed: Trial was pruned at epoch 5.
[I 2025-08-22 02:40:19,115] Trial 76 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 19, 'dataset.num_walks': 175815, 'training.lr': 2.7532359701809547e-05, 'training.weight_decay': 0.0910913589773564, 'training.batch_size': 64, 'training.gradient_clip_val': 1.7472204116170285, 'training.early_stopping_patience': 8, 'model.nhead_emb_combo': 3, 'model.hidden_dim': 64, 'model.nlayers': 2, 'model.dropout': 0.5753451781479122, 'training.epochs': 16}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 77 hyperparameters:
  Walk length: 25, Num walks: 127,986
  LR: 1.22e-05, Batch size: 256
  Model: emb_dim=128, hidden_dim=16
  Transformer: 2 layers, 1 heads
  Epochs: 19, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.532
Metric val_auc_epoch improved by 0.014 >= min_delta = 0.0. New best score: 0.546
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.551
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.555
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.556
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.557
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.558
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.558
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.560
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.560
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.560
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.560
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.560
`Trainer.fit` stopped: `max_epochs=19` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_77-epoch=13-val_auc_epoch=0.5602.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_77-epoch=13-val_auc_epoch=0.5602.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5427451729774475
      val_auc_epoch         0.5602378249168396
      val_f1_epoch          0.5398447513580322
        val_loss            0.6871091723442078
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 77 completed - Val AUC: 0.5602
[I 2025-08-22 02:42:48,716] Trial 77 finished with value: -0.5602378249168396 and parameters: {'dataset.max_walk_length': 25, 'dataset.num_walks': 127986, 'training.lr': 1.2235036766412616e-05, 'training.weight_decay': 0.009101351573129425, 'training.batch_size': 256, 'training.gradient_clip_val': 1.9647275948636456, 'training.early_stopping_patience': 9, 'model.nhead_emb_combo': 5, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.6000961739773695, 'training.epochs': 19}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 78 hyperparameters:
  Walk length: 26, Num walks: 108,714
  LR: 2.31e-05, Batch size: 256
  Model: emb_dim=32, hidden_dim=8
  Transformer: 2 layers, 4 heads
  Epochs: 19, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.498
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.503
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.509
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.513
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.518
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.522
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.525
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.528
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.531
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.534
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.536
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.537
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.538
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.539
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.540
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.540
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.540
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.541
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.541
`Trainer.fit` stopped: `max_epochs=19` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_78-epoch=18-val_auc_epoch=0.5406.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_78-epoch=18-val_auc_epoch=0.5406.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5269813537597656
      val_auc_epoch         0.5405617952346802
      val_f1_epoch          0.5231879949569702
        val_loss            0.6903970837593079
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 78 completed - Val AUC: 0.5406
[I 2025-08-22 02:44:57,308] Trial 78 finished with value: -0.5405617952346802 and parameters: {'dataset.max_walk_length': 26, 'dataset.num_walks': 108714, 'training.lr': 2.3125541010333842e-05, 'training.weight_decay': 0.06034470854942199, 'training.batch_size': 256, 'training.gradient_clip_val': 1.9511633757797378, 'training.early_stopping_patience': 6, 'model.nhead_emb_combo': 15, 'model.hidden_dim': 8, 'model.nlayers': 2, 'model.dropout': 0.6998027561380616, 'training.epochs': 19}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 79 hyperparameters:
  Walk length: 29, Num walks: 129,721
  LR: 4.15e-05, Batch size: 256
  Model: emb_dim=8, hidden_dim=128
  Transformer: 6 layers, 1 heads
  Epochs: 21, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.495
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.496
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.497
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.498
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.499
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.499
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.500
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.501
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.501
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.501
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.502
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.502
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.503
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.503
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.504
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.504
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.504
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.504
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.504
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.504
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.504
`Trainer.fit` stopped: `max_epochs=21` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_79-epoch=20-val_auc_epoch=0.5044.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_79-epoch=20-val_auc_epoch=0.5044.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5025274753570557
      val_auc_epoch         0.5043636560440063
      val_f1_epoch          0.46775537729263306
        val_loss            0.6931361556053162
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 79 completed - Val AUC: 0.5044
[I 2025-08-22 02:48:41,663] Trial 79 finished with value: -0.5043636560440063 and parameters: {'dataset.max_walk_length': 29, 'dataset.num_walks': 129721, 'training.lr': 4.149498927240674e-05, 'training.weight_decay': 0.026804348592171554, 'training.batch_size': 256, 'training.gradient_clip_val': 1.7076044246322462, 'training.early_stopping_patience': 15, 'model.nhead_emb_combo': 1, 'model.hidden_dim': 128, 'model.nlayers': 6, 'model.dropout': 0.590291012372907, 'training.epochs': 21}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 80 hyperparameters:
  Walk length: 16, Num walks: 144,708
  LR: 3.05e-05, Batch size: 256
  Model: emb_dim=16, hidden_dim=16
  Transformer: 2 layers, 1 heads
  Epochs: 18, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.495
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.500
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.506
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.511
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.517
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.521
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.525
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.529
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.532
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.534
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.537
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.539
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.540
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.541
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.542
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.542
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.542
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.542
`Trainer.fit` stopped: `max_epochs=18` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_80-epoch=17-val_auc_epoch=0.5420.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_80-epoch=17-val_auc_epoch=0.5420.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5295291543006897
      val_auc_epoch         0.5420440435409546
      val_f1_epoch          0.5295604467391968
        val_loss            0.6907235383987427
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 80 completed - Val AUC: 0.5420
[I 2025-08-22 02:51:16,623] Trial 80 finished with value: -0.5420440435409546 and parameters: {'dataset.max_walk_length': 16, 'dataset.num_walks': 144708, 'training.lr': 3.045214498236188e-05, 'training.weight_decay': 0.009028224849215198, 'training.batch_size': 256, 'training.gradient_clip_val': 1.953340795260703, 'training.early_stopping_patience': 8, 'model.nhead_emb_combo': 2, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.6741280632068368, 'training.epochs': 18}. Best is trial 1 with value: -0.6377121806144714.
🧹 Cleaning up old checkpoints and logs (keeping top 10)...
  Removed old checkpoint: trial_70-epoch=17-val_auc_epoch=0.5159.ckpt
  Removed old checkpoint: trial_69-epoch=14-val_auc_epoch=0.5161.ckpt
  Removed old checkpoint: trial_68-epoch=14-val_auc_epoch=0.5587.ckpt
  Removed old checkpoint: trial_67-epoch=23-val_auc_epoch=0.5569.ckpt
  Removed old checkpoint: trial_66-epoch=04-val_auc_epoch=0.5808.ckpt
  Removed old log dir: trial_70
  Removed old log dir: trial_69
  Removed old log dir: trial_68
  Removed old log dir: trial_67
  Removed old log dir: trial_66
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 81 hyperparameters:
  Walk length: 19, Num walks: 123,186
  LR: 1.28e-05, Batch size: 256
  Model: emb_dim=4, hidden_dim=16
  Transformer: 2 layers, 2 heads
  Epochs: 14, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.506
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.506
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.506
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.506
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.506
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.506
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.506
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.506
`Trainer.fit` stopped: `max_epochs=14` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_81-epoch=13-val_auc_epoch=0.5059.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_81-epoch=13-val_auc_epoch=0.5059.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5022542476654053
      val_auc_epoch         0.5059442520141602
      val_f1_epoch          0.4972063899040222
        val_loss            0.7021149396896362
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 81 completed - Val AUC: 0.5059
[I 2025-08-22 02:53:06,244] Trial 81 finished with value: -0.5059442520141602 and parameters: {'dataset.max_walk_length': 19, 'dataset.num_walks': 123186, 'training.lr': 1.2806917413397428e-05, 'training.weight_decay': 0.012743583305046761, 'training.batch_size': 256, 'training.gradient_clip_val': 1.9975488545370452, 'training.early_stopping_patience': 9, 'model.nhead_emb_combo': 6, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.6230670005160346, 'training.epochs': 14}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 82 hyperparameters:
  Walk length: 31, Num walks: 100,020
  LR: 1.63e-05, Batch size: 64
  Model: emb_dim=64, hidden_dim=16
  Transformer: 2 layers, 1 heads
  Epochs: 15, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.528
Metric val_auc_epoch improved by 0.022 >= min_delta = 0.0. New best score: 0.550
Metric val_auc_epoch improved by 0.012 >= min_delta = 0.0. New best score: 0.562
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.569
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.572
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.574
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.575
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.576
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.577
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.577
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.577
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.577
`Trainer.fit` stopped: `max_epochs=15` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_82-epoch=12-val_auc_epoch=0.5770.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_82-epoch=12-val_auc_epoch=0.5770.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5531957745552063
      val_auc_epoch         0.5770237445831299
      val_f1_epoch          0.5519214868545532
        val_loss            0.6849324107170105
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 82 completed - Val AUC: 0.5770
[I 2025-08-22 02:57:36,319] Trial 82 finished with value: -0.5770237445831299 and parameters: {'dataset.max_walk_length': 31, 'dataset.num_walks': 100020, 'training.lr': 1.6251998346663657e-05, 'training.weight_decay': 0.004106865474476986, 'training.batch_size': 64, 'training.gradient_clip_val': 1.8543933978957963, 'training.early_stopping_patience': 7, 'model.nhead_emb_combo': 4, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.6013759502162855, 'training.epochs': 15}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 83 hyperparameters:
  Walk length: 25, Num walks: 101,174
  LR: 2.11e-05, Batch size: 32
  Model: emb_dim=64, hidden_dim=16
  Transformer: 2 layers, 1 heads
  Epochs: 17, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.550
Metric val_auc_epoch improved by 0.012 >= min_delta = 0.0. New best score: 0.562
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.567
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.569
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.570
❌ Trial 83 failed: Trial was pruned at epoch 5.
[I 2025-08-22 03:00:47,207] Trial 83 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 25, 'dataset.num_walks': 101174, 'training.lr': 2.1062763393893583e-05, 'training.weight_decay': 0.00396747304668589, 'training.batch_size': 32, 'training.gradient_clip_val': 1.8344285500159503, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 4, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.5404852123267118, 'training.epochs': 17}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 84 hyperparameters:
  Walk length: 32, Num walks: 113,662
  LR: 1.78e-05, Batch size: 256
  Model: emb_dim=8, hidden_dim=16
  Transformer: 2 layers, 2 heads
  Epochs: 15, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.497
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.498
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.499
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.500
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.501
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.502
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.502
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.503
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.503
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.503
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.504
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.504
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.504
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.504
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.504
`Trainer.fit` stopped: `max_epochs=15` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_84-epoch=14-val_auc_epoch=0.5039.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_84-epoch=14-val_auc_epoch=0.5039.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5029480457305908
      val_auc_epoch         0.5038909912109375
      val_f1_epoch          0.4987049102783203
        val_loss            0.6957083344459534
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 84 completed - Val AUC: 0.5039
[I 2025-08-22 03:02:37,870] Trial 84 finished with value: -0.5038909912109375 and parameters: {'dataset.max_walk_length': 32, 'dataset.num_walks': 113662, 'training.lr': 1.7751877018347464e-05, 'training.weight_decay': 0.03342240523668791, 'training.batch_size': 256, 'training.gradient_clip_val': 1.8665085379183994, 'training.early_stopping_patience': 7, 'model.nhead_emb_combo': 7, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.5689316385212633, 'training.epochs': 15}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 85 hyperparameters:
  Walk length: 38, Num walks: 130,509
  LR: 1.43e-05, Batch size: 64
  Model: emb_dim=16, hidden_dim=64
  Transformer: 2 layers, 16 heads
  Epochs: 16, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.494
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.495
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.496
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.497
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.499
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.501
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.503
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.505
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.506
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.507
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.507
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.508
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.508
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.509
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.509
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.509
`Trainer.fit` stopped: `max_epochs=16` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_85-epoch=15-val_auc_epoch=0.5088.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_85-epoch=15-val_auc_epoch=0.5088.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.49861904978752136
      val_auc_epoch         0.5087927579879761
      val_f1_epoch          0.41907021403312683
        val_loss            0.6942746043205261
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 85 completed - Val AUC: 0.5088
[I 2025-08-22 03:09:03,448] Trial 85 finished with value: -0.5087927579879761 and parameters: {'dataset.max_walk_length': 38, 'dataset.num_walks': 130509, 'training.lr': 1.4348866014065815e-05, 'training.weight_decay': 0.020040262088340602, 'training.batch_size': 64, 'training.gradient_clip_val': 1.9153733817834553, 'training.early_stopping_patience': 8, 'model.nhead_emb_combo': 23, 'model.hidden_dim': 64, 'model.nlayers': 2, 'model.dropout': 0.6457176923521055, 'training.epochs': 16}. Best is trial 1 with value: -0.6377121806144714.
🧹 Cleaning up old checkpoints and logs (keeping top 10)...
  Removed old checkpoint: trial_75-epoch=00-val_auc_epoch=0.5646.ckpt
  Removed old checkpoint: trial_74-epoch=02-val_auc_epoch=0.5553.ckpt
  Removed old checkpoint: trial_73-epoch=08-val_auc_epoch=0.5612.ckpt
  Removed old checkpoint: trial_72-epoch=15-val_auc_epoch=0.5437.ckpt
  Removed old checkpoint: trial_71-epoch=15-val_auc_epoch=0.5614.ckpt
  Removed old log dir: trial_75
  Removed old log dir: trial_74
  Removed old log dir: trial_73
  Removed old log dir: trial_72
  Removed old log dir: trial_71
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 86 hyperparameters:
  Walk length: 28, Num walks: 148,229
  LR: 1.03e-05, Batch size: 128
  Model: emb_dim=32, hidden_dim=8
  Transformer: 3 layers, 1 heads
  Epochs: 12, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.506
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.512
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.520
Metric val_auc_epoch improved by 0.009 >= min_delta = 0.0. New best score: 0.529
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.537
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.542
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.546
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.549
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.550
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.551
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.551
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.551
`Trainer.fit` stopped: `max_epochs=12` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_86-epoch=11-val_auc_epoch=0.5515.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_86-epoch=11-val_auc_epoch=0.5515.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch          0.535397469997406
      val_auc_epoch         0.5514663457870483
      val_f1_epoch          0.5353590250015259
        val_loss            0.6892288327217102
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 86 completed - Val AUC: 0.5515
[I 2025-08-22 03:12:27,990] Trial 86 finished with value: -0.5514663457870483 and parameters: {'dataset.max_walk_length': 28, 'dataset.num_walks': 148229, 'training.lr': 1.0330594362175375e-05, 'training.weight_decay': 0.010137648839335768, 'training.batch_size': 128, 'training.gradient_clip_val': 1.6325862038960346, 'training.early_stopping_patience': 14, 'model.nhead_emb_combo': 3, 'model.hidden_dim': 8, 'model.nlayers': 3, 'model.dropout': 0.5985537087602948, 'training.epochs': 12}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 87 hyperparameters:
  Walk length: 12, Num walks: 167,271
  LR: 2.82e-05, Batch size: 32
  Model: emb_dim=8, hidden_dim=16
  Transformer: 2 layers, 4 heads
  Epochs: 18, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.524
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.531
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.540
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.548
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.554
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.559
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.561
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.563
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.563
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.564
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.564
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.564
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.564
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.564
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.564
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.564
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.564
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.564
`Trainer.fit` stopped: `max_epochs=18` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_87-epoch=17-val_auc_epoch=0.5644.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_87-epoch=17-val_auc_epoch=0.5644.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5458251237869263
      val_auc_epoch         0.5644207000732422
      val_f1_epoch          0.5440707206726074
        val_loss            0.6868579983711243
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 87 completed - Val AUC: 0.5644
[I 2025-08-22 03:28:06,634] Trial 87 finished with value: -0.5644207000732422 and parameters: {'dataset.max_walk_length': 12, 'dataset.num_walks': 167271, 'training.lr': 2.823976262570054e-05, 'training.weight_decay': 0.0589912392309878, 'training.batch_size': 32, 'training.gradient_clip_val': 1.7259818998175696, 'training.early_stopping_patience': 6, 'model.nhead_emb_combo': 13, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.5257668295962075, 'training.epochs': 18}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 88 hyperparameters:
  Walk length: 12, Num walks: 109,105
  LR: 2.65e-05, Batch size: 32
  Model: emb_dim=32, hidden_dim=16
  Transformer: 2 layers, 4 heads
  Epochs: 18, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.550
Metric val_auc_epoch improved by 0.019 >= min_delta = 0.0. New best score: 0.569
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.575
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.579
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.580
❌ Trial 88 failed: Trial was pruned at epoch 5.
[I 2025-08-22 03:31:28,973] Trial 88 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 12, 'dataset.num_walks': 109105, 'training.lr': 2.6496932168393095e-05, 'training.weight_decay': 0.09466059844696753, 'training.batch_size': 32, 'training.gradient_clip_val': 1.794600140690539, 'training.early_stopping_patience': 6, 'model.nhead_emb_combo': 15, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.48547175548735955, 'training.epochs': 18}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 89 hyperparameters:
  Walk length: 22, Num walks: 173,600
  LR: 4.53e-05, Batch size: 32
  Model: emb_dim=8, hidden_dim=8
  Transformer: 3 layers, 4 heads
  Epochs: 17, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.501
Metric val_auc_epoch improved by 0.018 >= min_delta = 0.0. New best score: 0.519
Metric val_auc_epoch improved by 0.019 >= min_delta = 0.0. New best score: 0.538
Metric val_auc_epoch improved by 0.014 >= min_delta = 0.0. New best score: 0.552
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.557
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.560
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.562
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.564
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.565
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.565
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.566
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.566
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.566
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.566
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.566
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.566
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.566
`Trainer.fit` stopped: `max_epochs=17` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_89-epoch=16-val_auc_epoch=0.5663.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_89-epoch=16-val_auc_epoch=0.5663.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch          0.547672688961029
      val_auc_epoch         0.5662856101989746
      val_f1_epoch          0.5473642945289612
        val_loss            0.6872156858444214
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 89 completed - Val AUC: 0.5663
[I 2025-08-22 03:49:15,417] Trial 89 finished with value: -0.5662856101989746 and parameters: {'dataset.max_walk_length': 22, 'dataset.num_walks': 173600, 'training.lr': 4.534942043082176e-05, 'training.weight_decay': 0.052392859835844525, 'training.batch_size': 32, 'training.gradient_clip_val': 1.7235971603761269, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 13, 'model.hidden_dim': 8, 'model.nlayers': 3, 'model.dropout': 0.569498552394881, 'training.epochs': 17}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 90 hyperparameters:
  Walk length: 22, Num walks: 182,123
  LR: 4.93e-05, Batch size: 32
  Model: emb_dim=128, hidden_dim=8
  Transformer: 4 layers, 4 heads
  Epochs: 20, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.567
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.570
Metric val_auc_epoch improved by 0.016 >= min_delta = 0.0. New best score: 0.586
Metric val_auc_epoch improved by 0.011 >= min_delta = 0.0. New best score: 0.598
❌ Trial 90 failed: Trial was pruned at epoch 5.
[I 2025-08-22 03:56:27,242] Trial 90 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 22, 'dataset.num_walks': 182123, 'training.lr': 4.9287094877666295e-05, 'training.weight_decay': 0.027292781148035503, 'training.batch_size': 32, 'training.gradient_clip_val': 1.5931742422790045, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 17, 'model.hidden_dim': 8, 'model.nlayers': 4, 'model.dropout': 0.5176207065902353, 'training.epochs': 20}. Best is trial 1 with value: -0.6377121806144714.
🧹 Cleaning up old checkpoints and logs (keeping top 10)...
  Removed old checkpoint: trial_80-epoch=17-val_auc_epoch=0.5420.ckpt
  Removed old checkpoint: trial_79-epoch=20-val_auc_epoch=0.5044.ckpt
  Removed old checkpoint: trial_78-epoch=18-val_auc_epoch=0.5406.ckpt
  Removed old checkpoint: trial_77-epoch=13-val_auc_epoch=0.5602.ckpt
  Removed old checkpoint: trial_76-epoch=03-val_auc_epoch=0.5544.ckpt
  Removed old log dir: trial_80
  Removed old log dir: trial_79
  Removed old log dir: trial_78
  Removed old log dir: trial_77
  Removed old log dir: trial_76
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 91 hyperparameters:
  Walk length: 10, Num walks: 175,805
  LR: 3.87e-05, Batch size: 32
  Model: emb_dim=128, hidden_dim=8
  Transformer: 3 layers, 2 heads
  Epochs: 17, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.574
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.576
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.584
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.588
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.595
❌ Trial 91 failed: Trial was pruned at epoch 5.
[I 2025-08-22 04:02:32,452] Trial 91 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 10, 'dataset.num_walks': 175805, 'training.lr': 3.873805290474809e-05, 'training.weight_decay': 0.05404077231568863, 'training.batch_size': 32, 'training.gradient_clip_val': 1.7443558450575498, 'training.early_stopping_patience': 6, 'model.nhead_emb_combo': 11, 'model.hidden_dim': 8, 'model.nlayers': 3, 'model.dropout': 0.5610546358301591, 'training.epochs': 17}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 92 hyperparameters:
  Walk length: 57, Num walks: 163,765
  LR: 3.42e-05, Batch size: 32
  Model: emb_dim=16, hidden_dim=8
  Transformer: 2 layers, 4 heads
  Epochs: 16, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.513
Metric val_auc_epoch improved by 0.013 >= min_delta = 0.0. New best score: 0.526
Metric val_auc_epoch improved by 0.016 >= min_delta = 0.0. New best score: 0.542
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.550
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.553
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.554
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.555
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.555
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.555
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.556
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.556
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.556
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.556
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.556
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.556
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.556
`Trainer.fit` stopped: `max_epochs=16` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_92-epoch=15-val_auc_epoch=0.5560.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_92-epoch=15-val_auc_epoch=0.5560.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5369337797164917
      val_auc_epoch         0.5559570789337158
      val_f1_epoch          0.5369375944137573
        val_loss            0.6863216161727905
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 92 completed - Val AUC: 0.5560
[I 2025-08-22 04:17:01,908] Trial 92 finished with value: -0.5559570789337158 and parameters: {'dataset.max_walk_length': 57, 'dataset.num_walks': 163765, 'training.lr': 3.415779028263163e-05, 'training.weight_decay': 0.06716768173625115, 'training.batch_size': 32, 'training.gradient_clip_val': 1.7297649950888963, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 14, 'model.hidden_dim': 8, 'model.nlayers': 2, 'model.dropout': 0.6273776336268104, 'training.epochs': 16}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 93 hyperparameters:
  Walk length: 17, Num walks: 145,258
  LR: 6.37e-05, Batch size: 32
  Model: emb_dim=8, hidden_dim=8
  Transformer: 2 layers, 8 heads
  Epochs: 15, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.521
Metric val_auc_epoch improved by 0.010 >= min_delta = 0.0. New best score: 0.531
Metric val_auc_epoch improved by 0.012 >= min_delta = 0.0. New best score: 0.544
Metric val_auc_epoch improved by 0.013 >= min_delta = 0.0. New best score: 0.557
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.563
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.566
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.568
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.570
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.570
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.571
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.571
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.571
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.571
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.571
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.571
`Trainer.fit` stopped: `max_epochs=15` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_93-epoch=14-val_auc_epoch=0.5715.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_93-epoch=14-val_auc_epoch=0.5715.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5491589307785034
      val_auc_epoch         0.5714871883392334
      val_f1_epoch          0.5491025447845459
        val_loss            0.6860194206237793
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 93 completed - Val AUC: 0.5715
[I 2025-08-22 04:28:23,713] Trial 93 finished with value: -0.5714871883392334 and parameters: {'dataset.max_walk_length': 17, 'dataset.num_walks': 145258, 'training.lr': 6.374481379280184e-05, 'training.weight_decay': 0.045241888592358746, 'training.batch_size': 32, 'training.gradient_clip_val': 1.837543495357633, 'training.early_stopping_patience': 7, 'model.nhead_emb_combo': 18, 'model.hidden_dim': 8, 'model.nlayers': 2, 'model.dropout': 0.5814394024739276, 'training.epochs': 15}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 94 hyperparameters:
  Walk length: 18, Num walks: 138,984
  LR: 5.65e-05, Batch size: 32
  Model: emb_dim=8, hidden_dim=8
  Transformer: 3 layers, 4 heads
  Epochs: 17, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.494
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.499
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.508
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.516
Metric val_auc_epoch improved by 0.009 >= min_delta = 0.0. New best score: 0.525
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.532
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.540
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.547
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.553
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.558
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.561
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.562
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.563
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.564
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.564
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.564
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.564
`Trainer.fit` stopped: `max_epochs=17` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_94-epoch=16-val_auc_epoch=0.5640.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_94-epoch=16-val_auc_epoch=0.5640.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5448090434074402
      val_auc_epoch         0.5639654994010925
      val_f1_epoch          0.5448974967002869
        val_loss            0.6876278519630432
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 94 completed - Val AUC: 0.5640
[I 2025-08-22 04:42:22,657] Trial 94 finished with value: -0.5639654994010925 and parameters: {'dataset.max_walk_length': 18, 'dataset.num_walks': 138984, 'training.lr': 5.646466117736213e-05, 'training.weight_decay': 0.03434671663821876, 'training.batch_size': 32, 'training.gradient_clip_val': 1.6562562358173556, 'training.early_stopping_patience': 7, 'model.nhead_emb_combo': 13, 'model.hidden_dim': 8, 'model.nlayers': 3, 'model.dropout': 0.5396186667959584, 'training.epochs': 17}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 95 hyperparameters:
  Walk length: 24, Num walks: 138,667
  LR: 6.18e-05, Batch size: 32
  Model: emb_dim=8, hidden_dim=8
  Transformer: 3 layers, 4 heads
  Epochs: 17, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.506
Metric val_auc_epoch improved by 0.013 >= min_delta = 0.0. New best score: 0.518
Metric val_auc_epoch improved by 0.012 >= min_delta = 0.0. New best score: 0.531
Metric val_auc_epoch improved by 0.009 >= min_delta = 0.0. New best score: 0.540
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.544
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.545
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.546
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.546
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.547
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.547
Monitored metric val_auc_epoch did not improve in the last 7 records. Best score: 0.547. Signaling Trainer to stop.
`Trainer.fit` stopped: `max_epochs=17` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_95-epoch=09-val_auc_epoch=0.5467.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_95-epoch=09-val_auc_epoch=0.5467.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5325812101364136
      val_auc_epoch         0.5467348694801331
      val_f1_epoch          0.5294615626335144
        val_loss             0.691158652305603
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 95 completed - Val AUC: 0.5467
[I 2025-08-22 04:56:36,738] Trial 95 finished with value: -0.5467348694801331 and parameters: {'dataset.max_walk_length': 24, 'dataset.num_walks': 138667, 'training.lr': 6.179156616017268e-05, 'training.weight_decay': 0.0365402557173916, 'training.batch_size': 32, 'training.gradient_clip_val': 1.6419025611270905, 'training.early_stopping_patience': 7, 'model.nhead_emb_combo': 13, 'model.hidden_dim': 8, 'model.nlayers': 3, 'model.dropout': 0.546873275138139, 'training.epochs': 17}. Best is trial 1 with value: -0.6377121806144714.
🧹 Cleaning up old checkpoints and logs (keeping top 10)...
  Removed old checkpoint: trial_85-epoch=15-val_auc_epoch=0.5088.ckpt
  Removed old checkpoint: trial_84-epoch=14-val_auc_epoch=0.5039.ckpt
  Removed old checkpoint: trial_83-epoch=04-val_auc_epoch=0.5697.ckpt
  Removed old checkpoint: trial_82-epoch=12-val_auc_epoch=0.5770.ckpt
  Removed old checkpoint: trial_81-epoch=13-val_auc_epoch=0.5059.ckpt
  Removed old log dir: trial_85
  Removed old log dir: trial_84
  Removed old log dir: trial_83
  Removed old log dir: trial_82
  Removed old log dir: trial_81
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 96 hyperparameters:
  Walk length: 31, Num walks: 145,178
  LR: 9.35e-05, Batch size: 32
  Model: emb_dim=16, hidden_dim=8
  Transformer: 3 layers, 8 heads
  Epochs: 18, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.540
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.548
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.549
❌ Trial 96 failed: Trial was pruned at epoch 6.
[I 2025-08-22 05:02:50,285] Trial 96 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 31, 'dataset.num_walks': 145178, 'training.lr': 9.346384350266535e-05, 'training.weight_decay': 0.09768951173356859, 'training.batch_size': 32, 'training.gradient_clip_val': 1.713484934541298, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 19, 'model.hidden_dim': 8, 'model.nlayers': 3, 'model.dropout': 0.5278679229785532, 'training.epochs': 18}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 97 hyperparameters:
  Walk length: 35, Num walks: 120,336
  LR: 9.85e-05, Batch size: 32
  Model: emb_dim=8, hidden_dim=8
  Transformer: 3 layers, 4 heads
  Epochs: 15, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.493
Metric val_auc_epoch improved by 0.021 >= min_delta = 0.0. New best score: 0.513
Metric val_auc_epoch improved by 0.013 >= min_delta = 0.0. New best score: 0.526
Metric val_auc_epoch improved by 0.010 >= min_delta = 0.0. New best score: 0.536
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.541
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.543
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.544
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.545
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.546
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.546
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.546
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.546
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.546
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.546
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.546
`Trainer.fit` stopped: `max_epochs=15` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_97-epoch=14-val_auc_epoch=0.5465.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_97-epoch=14-val_auc_epoch=0.5465.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5333786010742188
      val_auc_epoch          0.546488881111145
      val_f1_epoch          0.5330915451049805
        val_loss            0.6895268559455872
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 97 completed - Val AUC: 0.5465
[I 2025-08-22 05:13:52,894] Trial 97 finished with value: -0.546488881111145 and parameters: {'dataset.max_walk_length': 35, 'dataset.num_walks': 120336, 'training.lr': 9.847330392121353e-05, 'training.weight_decay': 0.03938041741618911, 'training.batch_size': 32, 'training.gradient_clip_val': 1.6656177354870054, 'training.early_stopping_patience': 17, 'model.nhead_emb_combo': 13, 'model.hidden_dim': 8, 'model.nlayers': 3, 'model.dropout': 0.580426845215298, 'training.epochs': 15}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 98 hyperparameters:
  Walk length: 17, Num walks: 100,046
  LR: 6.75e-05, Batch size: 32
  Model: emb_dim=128, hidden_dim=8
  Transformer: 4 layers, 4 heads
  Epochs: 17, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.560
❌ Trial 98 failed: Trial was pruned at epoch 5.
[I 2025-08-22 05:17:49,054] Trial 98 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 17, 'dataset.num_walks': 100046, 'training.lr': 6.751468846772623e-05, 'training.weight_decay': 0.02187857690717315, 'training.batch_size': 32, 'training.gradient_clip_val': 1.785244253185045, 'training.early_stopping_patience': 15, 'model.nhead_emb_combo': 17, 'model.hidden_dim': 8, 'model.nlayers': 4, 'model.dropout': 0.55315238875518, 'training.epochs': 17}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 99 hyperparameters:
  Walk length: 18, Num walks: 201,388
  LR: 4.65e-05, Batch size: 32
  Model: emb_dim=128, hidden_dim=8
  Transformer: 3 layers, 2 heads
  Epochs: 19, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.564
Metric val_auc_epoch improved by 0.012 >= min_delta = 0.0. New best score: 0.576
Metric val_auc_epoch improved by 0.015 >= min_delta = 0.0. New best score: 0.591
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.599
Metric val_auc_epoch improved by 0.009 >= min_delta = 0.0. New best score: 0.608
❌ Trial 99 failed: Trial was pruned at epoch 5.
[I 2025-08-22 05:24:53,158] Trial 99 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 18, 'dataset.num_walks': 201388, 'training.lr': 4.6504807438967976e-05, 'training.weight_decay': 0.005622473694775416, 'training.batch_size': 32, 'training.gradient_clip_val': 1.8203943206626663, 'training.early_stopping_patience': 7, 'model.nhead_emb_combo': 11, 'model.hidden_dim': 8, 'model.nlayers': 3, 'model.dropout': 0.53111433106755, 'training.epochs': 19}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 100 hyperparameters:
  Walk length: 28, Num walks: 108,368
  LR: 5.16e-05, Batch size: 32
  Model: emb_dim=4, hidden_dim=8
  Transformer: 3 layers, 4 heads
  Epochs: 21, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.497
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.499
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.500
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.502
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.502
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.503
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.504
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.505
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.505
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.506
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.506
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.506
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.507
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.507
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.507
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.507
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.507
`Trainer.fit` stopped: `max_epochs=21` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_100-epoch=20-val_auc_epoch=0.5069.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_100-epoch=20-val_auc_epoch=0.5069.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5065082311630249
      val_auc_epoch         0.5069254636764526
      val_f1_epoch          0.46852293610572815
        val_loss            0.6930944323539734
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 100 completed - Val AUC: 0.5069
[I 2025-08-22 05:38:36,091] Trial 100 finished with value: -0.5069254636764526 and parameters: {'dataset.max_walk_length': 28, 'dataset.num_walks': 108368, 'training.lr': 5.15934682138987e-05, 'training.weight_decay': 0.06804386980990494, 'training.batch_size': 32, 'training.gradient_clip_val': 1.9081187387293663, 'training.early_stopping_patience': 6, 'model.nhead_emb_combo': 12, 'model.hidden_dim': 8, 'model.nlayers': 3, 'model.dropout': 0.49593409658344684, 'training.epochs': 21}. Best is trial 1 with value: -0.6377121806144714.
🧹 Cleaning up old checkpoints and logs (keeping top 10)...
  Removed old checkpoint: trial_90-epoch=04-val_auc_epoch=0.5976.ckpt
  Removed old checkpoint: trial_89-epoch=16-val_auc_epoch=0.5663.ckpt
  Removed old checkpoint: trial_88-epoch=04-val_auc_epoch=0.5796.ckpt
  Removed old checkpoint: trial_87-epoch=17-val_auc_epoch=0.5644.ckpt
  Removed old checkpoint: trial_86-epoch=11-val_auc_epoch=0.5515.ckpt
  Removed old log dir: trial_90
  Removed old log dir: trial_89
  Removed old log dir: trial_88
  Removed old log dir: trial_87
  Removed old log dir: trial_86
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 101 hyperparameters:
  Walk length: 20, Num walks: 136,275
  LR: 2.33e-05, Batch size: 32
  Model: emb_dim=8, hidden_dim=8
  Transformer: 2 layers, 8 heads
  Epochs: 16, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.486
Metric val_auc_epoch improved by 0.009 >= min_delta = 0.0. New best score: 0.495
Metric val_auc_epoch improved by 0.009 >= min_delta = 0.0. New best score: 0.504
Metric val_auc_epoch improved by 0.009 >= min_delta = 0.0. New best score: 0.513
Metric val_auc_epoch improved by 0.009 >= min_delta = 0.0. New best score: 0.521
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.529
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.535
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.539
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.542
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.544
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.546
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.547
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.547
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.548
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.548
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.548
`Trainer.fit` stopped: `max_epochs=16` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_101-epoch=15-val_auc_epoch=0.5477.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_101-epoch=15-val_auc_epoch=0.5477.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5330418348312378
      val_auc_epoch         0.5477126836776733
      val_f1_epoch          0.5180341601371765
        val_loss            0.6909148097038269
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 101 completed - Val AUC: 0.5477
[I 2025-08-22 05:50:04,953] Trial 101 finished with value: -0.5477126836776733 and parameters: {'dataset.max_walk_length': 20, 'dataset.num_walks': 136275, 'training.lr': 2.3283919950420885e-05, 'training.weight_decay': 0.012509451094054757, 'training.batch_size': 32, 'training.gradient_clip_val': 1.7014534817740832, 'training.early_stopping_patience': 7, 'model.nhead_emb_combo': 18, 'model.hidden_dim': 8, 'model.nlayers': 2, 'model.dropout': 0.5696543292094709, 'training.epochs': 16}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 102 hyperparameters:
  Walk length: 12, Num walks: 153,467
  LR: 6.27e-05, Batch size: 32
  Model: emb_dim=64, hidden_dim=256
  Transformer: 2 layers, 4 heads
  Epochs: 15, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.582
❌ Trial 102 failed: Trial was pruned at epoch 5.
[I 2025-08-22 05:54:46,528] Trial 102 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 12, 'dataset.num_walks': 153467, 'training.lr': 6.267116882409206e-05, 'training.weight_decay': 0.01889527691549682, 'training.batch_size': 32, 'training.gradient_clip_val': 1.886898474846792, 'training.early_stopping_patience': 7, 'model.nhead_emb_combo': 16, 'model.hidden_dim': 256, 'model.nlayers': 2, 'model.dropout': 0.6087973022623252, 'training.epochs': 15}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 103 hyperparameters:
  Walk length: 16, Num walks: 123,486
  LR: 3.90e-05, Batch size: 32
  Model: emb_dim=32, hidden_dim=64
  Transformer: 2 layers, 8 heads
  Epochs: 17, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.552
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.558
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.561
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.562
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.562
❌ Trial 103 failed: Trial was pruned at epoch 5.
[I 2025-08-22 05:58:34,313] Trial 103 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 16, 'dataset.num_walks': 123486, 'training.lr': 3.896681389677089e-05, 'training.weight_decay': 0.02943147229397511, 'training.batch_size': 32, 'training.gradient_clip_val': 1.7921285975330925, 'training.early_stopping_patience': 8, 'model.nhead_emb_combo': 20, 'model.hidden_dim': 64, 'model.nlayers': 2, 'model.dropout': 0.5820438704247416, 'training.epochs': 17}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 104 hyperparameters:
  Walk length: 23, Num walks: 216,329
  LR: 1.60e-05, Batch size: 32
  Model: emb_dim=32, hidden_dim=8
  Transformer: 2 layers, 4 heads
  Epochs: 18, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.542
Metric val_auc_epoch improved by 0.009 >= min_delta = 0.0. New best score: 0.551
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.553
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.554
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.555
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.556
❌ Trial 104 failed: Trial was pruned at epoch 6.
[I 2025-08-22 06:06:22,132] Trial 104 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 23, 'dataset.num_walks': 216329, 'training.lr': 1.6046589556420395e-05, 'training.weight_decay': 0.05006261459087292, 'training.batch_size': 32, 'training.gradient_clip_val': 1.8457093231610329, 'training.early_stopping_patience': 6, 'model.nhead_emb_combo': 15, 'model.hidden_dim': 8, 'model.nlayers': 2, 'model.dropout': 0.502698101451859, 'training.epochs': 18}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 105 hyperparameters:
  Walk length: 26, Num walks: 155,682
  LR: 2.12e-05, Batch size: 32
  Model: emb_dim=64, hidden_dim=4
  Transformer: 4 layers, 4 heads
  Epochs: 16, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.551
❌ Trial 105 failed: Trial was pruned at epoch 5.
[I 2025-08-22 06:12:29,844] Trial 105 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 26, 'dataset.num_walks': 155682, 'training.lr': 2.116741788676264e-05, 'training.weight_decay': 0.006850572622300305, 'training.batch_size': 32, 'training.gradient_clip_val': 1.7723412106999195, 'training.early_stopping_patience': 7, 'model.nhead_emb_combo': 16, 'model.hidden_dim': 4, 'model.nlayers': 4, 'model.dropout': 0.5462475155533283, 'training.epochs': 16}. Best is trial 1 with value: -0.6377121806144714.
🧹 Cleaning up old checkpoints and logs (keeping top 10)...
  Removed old checkpoint: trial_95-epoch=09-val_auc_epoch=0.5467.ckpt
  Removed old checkpoint: trial_94-epoch=16-val_auc_epoch=0.5640.ckpt
  Removed old checkpoint: trial_93-epoch=14-val_auc_epoch=0.5715.ckpt
  Removed old checkpoint: trial_92-epoch=15-val_auc_epoch=0.5560.ckpt
  Removed old checkpoint: trial_91-epoch=04-val_auc_epoch=0.5951.ckpt
  Removed old log dir: trial_95
  Removed old log dir: trial_94
  Removed old log dir: trial_93
  Removed old log dir: trial_92
  Removed old log dir: trial_91
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 106 hyperparameters:
  Walk length: 63, Num walks: 186,964
  LR: 5.47e-05, Batch size: 32
  Model: emb_dim=8, hidden_dim=128
  Transformer: 2 layers, 4 heads
  Epochs: 15, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.510
Metric val_auc_epoch improved by 0.017 >= min_delta = 0.0. New best score: 0.528
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.536
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.538
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.539
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.540
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.540
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.541
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.541
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.541
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.541
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.541
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.541
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.541
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.541
`Trainer.fit` stopped: `max_epochs=15` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_106-epoch=14-val_auc_epoch=0.5411.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_106-epoch=14-val_auc_epoch=0.5411.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5253612399101257
      val_auc_epoch         0.5410542488098145
      val_f1_epoch          0.5224461555480957
        val_loss            0.6919260621070862
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 106 completed - Val AUC: 0.5411
[I 2025-08-22 06:28:37,409] Trial 106 finished with value: -0.5410542488098145 and parameters: {'dataset.max_walk_length': 63, 'dataset.num_walks': 186964, 'training.lr': 5.469579644491846e-05, 'training.weight_decay': 0.003413937085227969, 'training.batch_size': 32, 'training.gradient_clip_val': 1.9240340141724197, 'training.early_stopping_patience': 13, 'model.nhead_emb_combo': 13, 'model.hidden_dim': 128, 'model.nlayers': 2, 'model.dropout': 0.5581420779920924, 'training.epochs': 15}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 107 hyperparameters:
  Walk length: 43, Num walks: 249,755
  LR: 3.17e-05, Batch size: 32
  Model: emb_dim=16, hidden_dim=8
  Transformer: 5 layers, 8 heads
  Epochs: 17, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.530
Metric val_auc_epoch improved by 0.013 >= min_delta = 0.0. New best score: 0.543
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.548
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.550
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.551
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.551
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.552
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.552
Monitored metric val_auc_epoch did not improve in the last 6 records. Best score: 0.552. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_107-epoch=07-val_auc_epoch=0.5518.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_107-epoch=07-val_auc_epoch=0.5518.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch          0.535442054271698
      val_auc_epoch         0.5517890453338623
      val_f1_epoch          0.5354361534118652
        val_loss            0.6900937557220459
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 107 completed - Val AUC: 0.5518
[I 2025-08-22 06:56:15,664] Trial 107 finished with value: -0.5517890453338623 and parameters: {'dataset.max_walk_length': 43, 'dataset.num_walks': 249755, 'training.lr': 3.1705940398437204e-05, 'training.weight_decay': 0.012797699768848921, 'training.batch_size': 32, 'training.gradient_clip_val': 1.8236101513727154, 'training.early_stopping_patience': 6, 'model.nhead_emb_combo': 19, 'model.hidden_dim': 8, 'model.nlayers': 5, 'model.dropout': 0.46401512353257407, 'training.epochs': 17}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 108 hyperparameters:
  Walk length: 22, Num walks: 170,320
  LR: 2.50e-05, Batch size: 32
  Model: emb_dim=4, hidden_dim=64
  Transformer: 2 layers, 4 heads
  Epochs: 19, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.495
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.497
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.498
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.499
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.501
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.503
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.504
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.505
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.505
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.506
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.507
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.507
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.507
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.507
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.508
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.508
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.508
`Trainer.fit` stopped: `max_epochs=19` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_108-epoch=18-val_auc_epoch=0.5076.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_108-epoch=18-val_auc_epoch=0.5076.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5032910108566284
      val_auc_epoch         0.5076380968093872
      val_f1_epoch          0.49827444553375244
        val_loss            0.6931077837944031
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 108 completed - Val AUC: 0.5076
[I 2025-08-22 07:13:14,994] Trial 108 finished with value: -0.5076380968093872 and parameters: {'dataset.max_walk_length': 22, 'dataset.num_walks': 170320, 'training.lr': 2.4953078051908185e-05, 'training.weight_decay': 0.03890423199671173, 'training.batch_size': 32, 'training.gradient_clip_val': 1.8906398916952343, 'training.early_stopping_patience': 8, 'model.nhead_emb_combo': 12, 'model.hidden_dim': 64, 'model.nlayers': 2, 'model.dropout': 0.5677396066643942, 'training.epochs': 19}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 109 hyperparameters:
  Walk length: 30, Num walks: 114,092
  LR: 1.86e-05, Batch size: 128
  Model: emb_dim=64, hidden_dim=8
  Transformer: 2 layers, 2 heads
  Epochs: 15, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.527
Metric val_auc_epoch improved by 0.010 >= min_delta = 0.0. New best score: 0.537
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.544
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.549
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.552
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.553
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.554
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.555
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.555
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.555. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_109-epoch=08-val_auc_epoch=0.5552.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_109-epoch=08-val_auc_epoch=0.5552.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5388991236686707
      val_auc_epoch         0.5551524758338928
      val_f1_epoch          0.5382007360458374
        val_loss            0.6879982352256775
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 109 completed - Val AUC: 0.5552
[I 2025-08-22 07:16:00,639] Trial 109 finished with value: -0.5551524758338928 and parameters: {'dataset.max_walk_length': 30, 'dataset.num_walks': 114092, 'training.lr': 1.8577016105578373e-05, 'training.weight_decay': 0.021888130518282953, 'training.batch_size': 128, 'training.gradient_clip_val': 1.7289151808322418, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 10, 'model.hidden_dim': 8, 'model.nlayers': 2, 'model.dropout': 0.5906284956760723, 'training.epochs': 15}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 110 hyperparameters:
  Walk length: 20, Num walks: 139,435
  LR: 3.85e-05, Batch size: 32
  Model: emb_dim=32, hidden_dim=16
  Transformer: 3 layers, 2 heads
  Epochs: 16, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.550
Metric val_auc_epoch improved by 0.010 >= min_delta = 0.0. New best score: 0.561
❌ Trial 110 failed: Trial was pruned at epoch 5.
[I 2025-08-22 07:20:54,281] Trial 110 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 20, 'dataset.num_walks': 139435, 'training.lr': 3.845034581328545e-05, 'training.weight_decay': 0.0017647190081750204, 'training.batch_size': 32, 'training.gradient_clip_val': 1.982786874099648, 'training.early_stopping_patience': 16, 'model.nhead_emb_combo': 9, 'model.hidden_dim': 16, 'model.nlayers': 3, 'model.dropout': 0.5198979408378881, 'training.epochs': 16}. Best is trial 1 with value: -0.6377121806144714.
🧹 Cleaning up old checkpoints and logs (keeping top 10)...
  Removed old checkpoint: trial_100-epoch=20-val_auc_epoch=0.5069.ckpt
  Removed old checkpoint: trial_99-epoch=04-val_auc_epoch=0.6081.ckpt
  Removed old checkpoint: trial_98-epoch=00-val_auc_epoch=0.5600.ckpt
  Removed old checkpoint: trial_97-epoch=14-val_auc_epoch=0.5465.ckpt
  Removed old checkpoint: trial_96-epoch=02-val_auc_epoch=0.5490.ckpt
  Removed old log dir: trial_100
  Removed old log dir: trial_99
  Removed old log dir: trial_98
  Removed old log dir: trial_97
  Removed old log dir: trial_96
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 111 hyperparameters:
  Walk length: 14, Num walks: 161,097
  LR: 2.71e-05, Batch size: 64
  Model: emb_dim=16, hidden_dim=16
  Transformer: 2 layers, 1 heads
  Epochs: 14, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.516
Metric val_auc_epoch improved by 0.017 >= min_delta = 0.0. New best score: 0.533
Metric val_auc_epoch improved by 0.019 >= min_delta = 0.0. New best score: 0.552
Metric val_auc_epoch improved by 0.011 >= min_delta = 0.0. New best score: 0.563
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.568
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.570
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.571
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.572
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.572
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.573
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.573
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.573
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.573
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.573
`Trainer.fit` stopped: `max_epochs=14` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_111-epoch=13-val_auc_epoch=0.5730.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_111-epoch=13-val_auc_epoch=0.5730.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5505284070968628
      val_auc_epoch         0.5729612112045288
      val_f1_epoch          0.5458673238754272
        val_loss            0.6863119602203369
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 111 completed - Val AUC: 0.5730
[I 2025-08-22 07:27:03,350] Trial 111 finished with value: -0.5729612112045288 and parameters: {'dataset.max_walk_length': 14, 'dataset.num_walks': 161097, 'training.lr': 2.7121080715734474e-05, 'training.weight_decay': 0.06600739032518141, 'training.batch_size': 64, 'training.gradient_clip_val': 1.8389060659033738, 'training.early_stopping_patience': 6, 'model.nhead_emb_combo': 2, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.6526134166692269, 'training.epochs': 14}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 112 hyperparameters:
  Walk length: 14, Num walks: 128,483
  LR: 3.05e-05, Batch size: 64
  Model: emb_dim=4, hidden_dim=16
  Transformer: 2 layers, 1 heads
  Epochs: 14, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.512
Monitored metric val_auc_epoch did not improve in the last 6 records. Best score: 0.512. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_112-epoch=00-val_auc_epoch=0.5115.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_112-epoch=00-val_auc_epoch=0.5115.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch          0.50225830078125
      val_auc_epoch         0.5115443468093872
      val_f1_epoch          0.3856376111507416
        val_loss            0.6934254765510559
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 112 completed - Val AUC: 0.5115
[I 2025-08-22 07:29:39,538] Trial 112 finished with value: -0.5115443468093872 and parameters: {'dataset.max_walk_length': 14, 'dataset.num_walks': 128483, 'training.lr': 3.0457350377488826e-05, 'training.weight_decay': 0.06590250758951996, 'training.batch_size': 64, 'training.gradient_clip_val': 1.7670077495238923, 'training.early_stopping_patience': 6, 'model.nhead_emb_combo': 0, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.651548513902119, 'training.epochs': 14}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 113 hyperparameters:
  Walk length: 19, Num walks: 153,803
  LR: 1.56e-05, Batch size: 64
  Model: emb_dim=8, hidden_dim=16
  Transformer: 2 layers, 1 heads
  Epochs: 13, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.511
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.514
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.516
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.517
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.518
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.519
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.520
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.521
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.521
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.521
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.521
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.522
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.522
`Trainer.fit` stopped: `max_epochs=13` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_113-epoch=12-val_auc_epoch=0.5216.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_113-epoch=12-val_auc_epoch=0.5216.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5072834491729736
      val_auc_epoch         0.5216217041015625
      val_f1_epoch          0.40189284086227417
        val_loss             0.692857563495636
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 113 completed - Val AUC: 0.5216
[I 2025-08-22 07:35:30,796] Trial 113 finished with value: -0.5216217041015625 and parameters: {'dataset.max_walk_length': 19, 'dataset.num_walks': 153803, 'training.lr': 1.559370576953327e-05, 'training.weight_decay': 0.07562207375052342, 'training.batch_size': 64, 'training.gradient_clip_val': 1.838111646718213, 'training.early_stopping_patience': 7, 'model.nhead_emb_combo': 1, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.6163067145009077, 'training.epochs': 13}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 114 hyperparameters:
  Walk length: 16, Num walks: 230,655
  LR: 4.69e-05, Batch size: 64
  Model: emb_dim=16, hidden_dim=16
  Transformer: 2 layers, 1 heads
  Epochs: 16, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.539
Metric val_auc_epoch improved by 0.017 >= min_delta = 0.0. New best score: 0.556
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.560
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.562
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.563
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.563
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.564
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.564
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.564
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.564. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_114-epoch=08-val_auc_epoch=0.5637.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_114-epoch=08-val_auc_epoch=0.5637.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5442581176757812
      val_auc_epoch         0.5637040138244629
      val_f1_epoch          0.5442460775375366
        val_loss            0.6869487166404724
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 114 completed - Val AUC: 0.5637
[I 2025-08-22 07:44:17,324] Trial 114 finished with value: -0.5637040138244629 and parameters: {'dataset.max_walk_length': 16, 'dataset.num_walks': 230655, 'training.lr': 4.690425958414335e-05, 'training.weight_decay': 0.028321823619300773, 'training.batch_size': 64, 'training.gradient_clip_val': 1.8926818357132278, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 2, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.6408186971662176, 'training.epochs': 16}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 115 hyperparameters:
  Walk length: 17, Num walks: 208,289
  LR: 4.56e-05, Batch size: 64
  Model: emb_dim=16, hidden_dim=256
  Transformer: 2 layers, 4 heads
  Epochs: 18, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.538
Metric val_auc_epoch improved by 0.021 >= min_delta = 0.0. New best score: 0.558
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.563
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.566
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.567
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.568
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.569
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.569
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.569
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.569
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.569
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.569. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_115-epoch=10-val_auc_epoch=0.5695.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_115-epoch=10-val_auc_epoch=0.5695.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5464812517166138
      val_auc_epoch         0.5694881677627563
      val_f1_epoch          0.5464730262756348
        val_loss            0.6872366666793823
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 115 completed - Val AUC: 0.5695
[I 2025-08-22 07:53:16,337] Trial 115 finished with value: -0.5694881677627563 and parameters: {'dataset.max_walk_length': 17, 'dataset.num_walks': 208289, 'training.lr': 4.5594794962851546e-05, 'training.weight_decay': 0.04686024582073389, 'training.batch_size': 64, 'training.gradient_clip_val': 1.9415322887741826, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 14, 'model.hidden_dim': 256, 'model.nlayers': 2, 'model.dropout': 0.6359397500515138, 'training.epochs': 18}. Best is trial 1 with value: -0.6377121806144714.
🧹 Cleaning up old checkpoints and logs (keeping top 10)...
  Removed old checkpoint: trial_105-epoch=00-val_auc_epoch=0.5506.ckpt
  Removed old checkpoint: trial_104-epoch=05-val_auc_epoch=0.5559.ckpt
  Removed old checkpoint: trial_103-epoch=04-val_auc_epoch=0.5625.ckpt
  Removed old checkpoint: trial_102-epoch=00-val_auc_epoch=0.5816.ckpt
  Removed old checkpoint: trial_101-epoch=15-val_auc_epoch=0.5477.ckpt
  Removed old log dir: trial_105
  Removed old log dir: trial_104
  Removed old log dir: trial_103
  Removed old log dir: trial_102
  Removed old log dir: trial_101
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 116 hyperparameters:
  Walk length: 12, Num walks: 238,166
  LR: 7.64e-05, Batch size: 64
  Model: emb_dim=16, hidden_dim=256
  Transformer: 2 layers, 4 heads
  Epochs: 18, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.565
Metric val_auc_epoch improved by 0.013 >= min_delta = 0.0. New best score: 0.577
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.580
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.582
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.584
❌ Trial 116 failed: Trial was pruned at epoch 5.
[I 2025-08-22 07:57:12,344] Trial 116 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 12, 'dataset.num_walks': 238166, 'training.lr': 7.639795589587117e-05, 'training.weight_decay': 0.0397882242293065, 'training.batch_size': 64, 'training.gradient_clip_val': 1.9485766132088496, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 14, 'model.hidden_dim': 256, 'model.nlayers': 2, 'model.dropout': 0.6297909224913166, 'training.epochs': 18}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 117 hyperparameters:
  Walk length: 16, Num walks: 209,502
  LR: 4.48e-05, Batch size: 64
  Model: emb_dim=8, hidden_dim=256
  Transformer: 1 layers, 4 heads
  Epochs: 16, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.506
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.514
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.519
Metric val_auc_epoch improved by 0.009 >= min_delta = 0.0. New best score: 0.528
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.535
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.543
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.548
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.550
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.552
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.553
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.554
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.555
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.555
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.556
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.556
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.556
`Trainer.fit` stopped: `max_epochs=16` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_117-epoch=15-val_auc_epoch=0.5556.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_117-epoch=15-val_auc_epoch=0.5556.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5363476872444153
      val_auc_epoch         0.5556403398513794
      val_f1_epoch          0.5234987735748291
        val_loss            0.6898253560066223
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 117 completed - Val AUC: 0.5556
[I 2025-08-22 08:05:11,790] Trial 117 finished with value: -0.5556403398513794 and parameters: {'dataset.max_walk_length': 16, 'dataset.num_walks': 209502, 'training.lr': 4.4813574577792415e-05, 'training.weight_decay': 0.09859173005070639, 'training.batch_size': 64, 'training.gradient_clip_val': 1.9092098879282406, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 13, 'model.hidden_dim': 256, 'model.nlayers': 1, 'model.dropout': 0.6407563666605164, 'training.epochs': 16}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 118 hyperparameters:
  Walk length: 10, Num walks: 196,962
  LR: 5.69e-05, Batch size: 64
  Model: emb_dim=128, hidden_dim=256
  Transformer: 2 layers, 4 heads
  Epochs: 15, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.576
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.583
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.588
❌ Trial 118 failed: Trial was pruned at epoch 5.
[I 2025-08-22 08:08:25,121] Trial 118 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 10, 'dataset.num_walks': 196962, 'training.lr': 5.6920487628882006e-05, 'training.weight_decay': 0.02817235556891983, 'training.batch_size': 64, 'training.gradient_clip_val': 1.8806738570404549, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 17, 'model.hidden_dim': 256, 'model.nlayers': 2, 'model.dropout': 0.5974904153943411, 'training.epochs': 15}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 119 hyperparameters:
  Walk length: 15, Num walks: 229,029
  LR: 6.86e-05, Batch size: 64
  Model: emb_dim=32, hidden_dim=256
  Transformer: 6 layers, 4 heads
  Epochs: 14, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.554
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.554. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_119-epoch=00-val_auc_epoch=0.5543.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_119-epoch=00-val_auc_epoch=0.5543.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
❌ Trial 119 failed: Trial was pruned at epoch 6.
[I 2025-08-22 08:14:12,653] Trial 119 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 15, 'dataset.num_walks': 229029, 'training.lr': 6.862778101239707e-05, 'training.weight_decay': 0.051216967463329155, 'training.batch_size': 64, 'training.gradient_clip_val': 1.9469622752714222, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 15, 'model.hidden_dim': 256, 'model.nlayers': 6, 'model.dropout': 0.6104626983978024, 'training.epochs': 14}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 120 hyperparameters:
  Walk length: 12, Num walks: 185,126
  LR: 1.17e-04, Batch size: 64
  Model: emb_dim=128, hidden_dim=16
  Transformer: 2 layers, 2 heads
  Epochs: 13, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.576
Metric val_auc_epoch improved by 0.022 >= min_delta = 0.0. New best score: 0.599
Metric val_auc_epoch improved by 0.009 >= min_delta = 0.0. New best score: 0.608
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.613
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.615
❌ Trial 120 failed: Trial was pruned at epoch 5.
[I 2025-08-22 08:17:14,710] Trial 120 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 12, 'dataset.num_walks': 185126, 'training.lr': 0.00011722629071390238, 'training.weight_decay': 0.07373523780971793, 'training.batch_size': 64, 'training.gradient_clip_val': 1.6827131822221568, 'training.early_stopping_patience': 14, 'model.nhead_emb_combo': 11, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.6823363068600206, 'training.epochs': 13}. Best is trial 1 with value: -0.6377121806144714.
🧹 Cleaning up old checkpoints and logs (keeping top 10)...
  Removed old checkpoint: trial_110-epoch=01-val_auc_epoch=0.5605.ckpt
  Removed old checkpoint: trial_109-epoch=08-val_auc_epoch=0.5552.ckpt
  Removed old checkpoint: trial_108-epoch=18-val_auc_epoch=0.5076.ckpt
  Removed old checkpoint: trial_107-epoch=07-val_auc_epoch=0.5518.ckpt
  Removed old checkpoint: trial_106-epoch=14-val_auc_epoch=0.5411.ckpt
  Removed old log dir: trial_110
  Removed old log dir: trial_109
  Removed old log dir: trial_108
  Removed old log dir: trial_107
  Removed old log dir: trial_106
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 121 hyperparameters:
  Walk length: 24, Num walks: 270,824
  LR: 2.58e-05, Batch size: 32
  Model: emb_dim=16, hidden_dim=16
  Transformer: 2 layers, 1 heads
  Epochs: 17, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.527
Metric val_auc_epoch improved by 0.012 >= min_delta = 0.0. New best score: 0.539
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.542
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.543
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.544
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.544
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.545
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.546
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.546
Monitored metric val_auc_epoch did not improve in the last 6 records. Best score: 0.546. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_121-epoch=08-val_auc_epoch=0.5456.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_121-epoch=08-val_auc_epoch=0.5456.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5330108404159546
      val_auc_epoch         0.5455937385559082
      val_f1_epoch          0.5328717827796936
        val_loss            0.6908146142959595
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 121 completed - Val AUC: 0.5456
[I 2025-08-22 08:37:50,456] Trial 121 finished with value: -0.5455937385559082 and parameters: {'dataset.max_walk_length': 24, 'dataset.num_walks': 270824, 'training.lr': 2.5767008222741975e-05, 'training.weight_decay': 0.0319062248670249, 'training.batch_size': 32, 'training.gradient_clip_val': 1.86162336389265, 'training.early_stopping_patience': 6, 'model.nhead_emb_combo': 2, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.583211538724987, 'training.epochs': 17}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 122 hyperparameters:
  Walk length: 18, Num walks: 171,890
  LR: 3.31e-05, Batch size: 64
  Model: emb_dim=16, hidden_dim=8
  Transformer: 2 layers, 1 heads
  Epochs: 29, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.527
Metric val_auc_epoch improved by 0.016 >= min_delta = 0.0. New best score: 0.543
Metric val_auc_epoch improved by 0.014 >= min_delta = 0.0. New best score: 0.557
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.565
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.568
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.569
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.570
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.571
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.572
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.573
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.573
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.574
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.574
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.575
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.575
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.575
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.576
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.576
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.576
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.576
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.576
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.576
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.576
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.576
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.576
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.576
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.576
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.576
`Trainer.fit` stopped: `max_epochs=29` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_122-epoch=27-val_auc_epoch=0.5764.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_122-epoch=27-val_auc_epoch=0.5764.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5525610446929932
      val_auc_epoch         0.5764172077178955
      val_f1_epoch          0.5509002208709717
        val_loss            0.6850611567497253
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 122 completed - Val AUC: 0.5764
[I 2025-08-22 08:51:38,851] Trial 122 finished with value: -0.5764172077178955 and parameters: {'dataset.max_walk_length': 18, 'dataset.num_walks': 171890, 'training.lr': 3.312957173977988e-05, 'training.weight_decay': 0.01484384819545746, 'training.batch_size': 64, 'training.gradient_clip_val': 1.8027954435983826, 'training.early_stopping_patience': 6, 'model.nhead_emb_combo': 2, 'model.hidden_dim': 8, 'model.nlayers': 2, 'model.dropout': 0.5420761800956986, 'training.epochs': 29}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 123 hyperparameters:
  Walk length: 18, Num walks: 170,684
  LR: 3.74e-05, Batch size: 64
  Model: emb_dim=16, hidden_dim=64
  Transformer: 2 layers, 4 heads
  Epochs: 29, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.532
Metric val_auc_epoch improved by 0.018 >= min_delta = 0.0. New best score: 0.550
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.558
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.561
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.563
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.564
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.565
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.566
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.566
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.567
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.567
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.567
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.567
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.567
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.567
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.567
Monitored metric val_auc_epoch did not improve in the last 6 records. Best score: 0.567. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_123-epoch=17-val_auc_epoch=0.5674.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_123-epoch=17-val_auc_epoch=0.5674.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch          0.545021653175354
      val_auc_epoch         0.5673614740371704
      val_f1_epoch          0.5451176762580872
        val_loss            0.6886504888534546
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 123 completed - Val AUC: 0.5674
[I 2025-08-22 09:03:10,310] Trial 123 finished with value: -0.5673614740371704 and parameters: {'dataset.max_walk_length': 18, 'dataset.num_walks': 170684, 'training.lr': 3.73843899878809e-05, 'training.weight_decay': 0.023632075570296233, 'training.batch_size': 64, 'training.gradient_clip_val': 1.7645342671092943, 'training.early_stopping_patience': 6, 'model.nhead_emb_combo': 14, 'model.hidden_dim': 64, 'model.nlayers': 2, 'model.dropout': 0.539194376248537, 'training.epochs': 29}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 124 hyperparameters:
  Walk length: 18, Num walks: 169,711
  LR: 3.64e-05, Batch size: 64
  Model: emb_dim=16, hidden_dim=64
  Transformer: 2 layers, 4 heads
  Epochs: 30, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.524
Metric val_auc_epoch improved by 0.015 >= min_delta = 0.0. New best score: 0.539
Metric val_auc_epoch improved by 0.013 >= min_delta = 0.0. New best score: 0.551
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.557
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.560
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.561
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.561
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.561
Monitored metric val_auc_epoch did not improve in the last 6 records. Best score: 0.561. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_124-epoch=07-val_auc_epoch=0.5615.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_124-epoch=07-val_auc_epoch=0.5615.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch          0.541844367980957
      val_auc_epoch          0.561493992805481
      val_f1_epoch          0.5334286689758301
        val_loss            0.6873805522918701
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 124 completed - Val AUC: 0.5615
[I 2025-08-22 09:10:02,281] Trial 124 finished with value: -0.561493992805481 and parameters: {'dataset.max_walk_length': 18, 'dataset.num_walks': 169711, 'training.lr': 3.635122865797956e-05, 'training.weight_decay': 0.04542939211317857, 'training.batch_size': 64, 'training.gradient_clip_val': 1.8112022120863782, 'training.early_stopping_patience': 6, 'model.nhead_emb_combo': 14, 'model.hidden_dim': 64, 'model.nlayers': 2, 'model.dropout': 0.5346695396008577, 'training.epochs': 30}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 125 hyperparameters:
  Walk length: 14, Num walks: 146,481
  LR: 3.08e-05, Batch size: 64
  Model: emb_dim=64, hidden_dim=64
  Transformer: 2 layers, 4 heads
  Epochs: 29, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.568
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.572
❌ Trial 125 failed: Trial was pruned at epoch 5.
[I 2025-08-22 09:12:28,689] Trial 125 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 14, 'dataset.num_walks': 146481, 'training.lr': 3.0791884887960504e-05, 'training.weight_decay': 0.004746146865101504, 'training.batch_size': 64, 'training.gradient_clip_val': 1.7641426411324925, 'training.early_stopping_patience': 15, 'model.nhead_emb_combo': 16, 'model.hidden_dim': 64, 'model.nlayers': 2, 'model.dropout': 0.5390812111096562, 'training.epochs': 29}. Best is trial 1 with value: -0.6377121806144714.
🧹 Cleaning up old checkpoints and logs (keeping top 10)...
  Removed old checkpoint: trial_115-epoch=10-val_auc_epoch=0.5695.ckpt
  Removed old checkpoint: trial_114-epoch=08-val_auc_epoch=0.5637.ckpt
  Removed old checkpoint: trial_113-epoch=12-val_auc_epoch=0.5216.ckpt
  Removed old checkpoint: trial_112-epoch=00-val_auc_epoch=0.5115.ckpt
  Removed old checkpoint: trial_111-epoch=13-val_auc_epoch=0.5730.ckpt
  Removed old log dir: trial_115
  Removed old log dir: trial_114
  Removed old log dir: trial_113
  Removed old log dir: trial_112
  Removed old log dir: trial_111
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 126 hyperparameters:
  Walk length: 21, Num walks: 194,294
  LR: 4.15e-05, Batch size: 64
  Model: emb_dim=16, hidden_dim=64
  Transformer: 2 layers, 4 heads
  Epochs: 27, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.530
Metric val_auc_epoch improved by 0.015 >= min_delta = 0.0. New best score: 0.544
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.550
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.552
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.553
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.553
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.553
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.554
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.554
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.555
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.555
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.556
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.556
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.556
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.557
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.557
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.557
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.557
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.557
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.557
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.557
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.557
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.557
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.557
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.557
`Trainer.fit` stopped: `max_epochs=27` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_126-epoch=26-val_auc_epoch=0.5572.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_126-epoch=26-val_auc_epoch=0.5572.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5387518405914307
      val_auc_epoch         0.5572296380996704
      val_f1_epoch          0.5387900471687317
        val_loss            0.6924939751625061
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 126 completed - Val AUC: 0.5572
[I 2025-08-22 09:27:12,989] Trial 126 finished with value: -0.5572296380996704 and parameters: {'dataset.max_walk_length': 21, 'dataset.num_walks': 194294, 'training.lr': 4.148988014584245e-05, 'training.weight_decay': 0.01067872879609114, 'training.batch_size': 64, 'training.gradient_clip_val': 1.5616395904691802, 'training.early_stopping_patience': 7, 'model.nhead_emb_combo': 14, 'model.hidden_dim': 64, 'model.nlayers': 2, 'model.dropout': 0.5186574790529883, 'training.epochs': 27}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 127 hyperparameters:
  Walk length: 18, Num walks: 175,660
  LR: 1.73e-04, Batch size: 64
  Model: emb_dim=8, hidden_dim=64
  Transformer: 2 layers, 8 heads
  Epochs: 28, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.533
Metric val_auc_epoch improved by 0.022 >= min_delta = 0.0. New best score: 0.555
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.557
Monitored metric val_auc_epoch did not improve in the last 6 records. Best score: 0.557. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_127-epoch=02-val_auc_epoch=0.5570.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_127-epoch=02-val_auc_epoch=0.5570.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5399378538131714
      val_auc_epoch         0.5570276975631714
      val_f1_epoch          0.5385996103286743
        val_loss            0.6880558133125305
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 127 completed - Val AUC: 0.5570
[I 2025-08-22 09:32:06,239] Trial 127 finished with value: -0.5570276975631714 and parameters: {'dataset.max_walk_length': 18, 'dataset.num_walks': 175660, 'training.lr': 0.00017347465796951913, 'training.weight_decay': 0.0026279808033142526, 'training.batch_size': 64, 'training.gradient_clip_val': 1.7387682829018292, 'training.early_stopping_patience': 6, 'model.nhead_emb_combo': 18, 'model.hidden_dim': 64, 'model.nlayers': 2, 'model.dropout': 0.5576279041697513, 'training.epochs': 28}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 128 hyperparameters:
  Walk length: 23, Num walks: 136,144
  LR: 8.40e-05, Batch size: 64
  Model: emb_dim=4, hidden_dim=8
  Transformer: 1 layers, 4 heads
  Epochs: 24, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.504
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.505
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.512
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.519
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.522
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.527
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.532
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.536
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.538
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.542
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.542
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.545
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.547
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.548
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.549
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.550
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.550
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.551
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.551
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.551
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.551
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.551
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.551
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.551
`Trainer.fit` stopped: `max_epochs=24` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_128-epoch=23-val_auc_epoch=0.5512.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_128-epoch=23-val_auc_epoch=0.5512.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5379674434661865
      val_auc_epoch         0.5512117743492126
      val_f1_epoch          0.5375986695289612
        val_loss            0.6896677613258362
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 128 completed - Val AUC: 0.5512
[I 2025-08-22 09:40:24,334] Trial 128 finished with value: -0.5512117743492126 and parameters: {'dataset.max_walk_length': 23, 'dataset.num_walks': 136144, 'training.lr': 8.396736906555799e-05, 'training.weight_decay': 0.02140565588602638, 'training.batch_size': 64, 'training.gradient_clip_val': 1.6371523659665428, 'training.early_stopping_patience': 6, 'model.nhead_emb_combo': 12, 'model.hidden_dim': 8, 'model.nlayers': 1, 'model.dropout': 0.5048180859736957, 'training.epochs': 24}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 129 hyperparameters:
  Walk length: 17, Num walks: 151,969
  LR: 2.81e-05, Batch size: 64
  Model: emb_dim=8, hidden_dim=4
  Transformer: 2 layers, 4 heads
  Epochs: 29, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.485
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.493
Metric val_auc_epoch improved by 0.014 >= min_delta = 0.0. New best score: 0.507
Metric val_auc_epoch improved by 0.022 >= min_delta = 0.0. New best score: 0.528
Metric val_auc_epoch improved by 0.019 >= min_delta = 0.0. New best score: 0.548
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.554
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.555
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.556
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.556
Monitored metric val_auc_epoch did not improve in the last 7 records. Best score: 0.556. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_129-epoch=08-val_auc_epoch=0.5557.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_129-epoch=08-val_auc_epoch=0.5557.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5391238331794739
      val_auc_epoch         0.5556857585906982
      val_f1_epoch          0.5358506441116333
        val_loss            0.6886717677116394
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 129 completed - Val AUC: 0.5557
[I 2025-08-22 09:47:13,354] Trial 129 finished with value: -0.5556857585906982 and parameters: {'dataset.max_walk_length': 17, 'dataset.num_walks': 151969, 'training.lr': 2.8107502268372256e-05, 'training.weight_decay': 0.04834021375333529, 'training.batch_size': 64, 'training.gradient_clip_val': 1.7113055871510312, 'training.early_stopping_patience': 7, 'model.nhead_emb_combo': 13, 'model.hidden_dim': 4, 'model.nlayers': 2, 'model.dropout': 0.02028586241389052, 'training.epochs': 29}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 130 hyperparameters:
  Walk length: 95, Num walks: 168,768
  LR: 5.26e-05, Batch size: 128
  Model: emb_dim=32, hidden_dim=8
  Transformer: 3 layers, 4 heads
  Epochs: 30, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.509
Metric val_auc_epoch improved by 0.013 >= min_delta = 0.0. New best score: 0.522
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.523
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.524
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.524
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.524
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.525
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.525
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.525
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.525
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.525
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.525
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.525
`Trainer.fit` stopped: `max_epochs=30` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_130-epoch=24-val_auc_epoch=0.5251.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_130-epoch=24-val_auc_epoch=0.5251.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5193679332733154
      val_auc_epoch         0.5251369476318359
      val_f1_epoch          0.5192209482192993
        val_loss            0.7045327425003052
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 130 completed - Val AUC: 0.5251
[I 2025-08-22 09:57:51,883] Trial 130 finished with value: -0.5251369476318359 and parameters: {'dataset.max_walk_length': 95, 'dataset.num_walks': 168768, 'training.lr': 5.256698697436002e-05, 'training.weight_decay': 0.013819700087777253, 'training.batch_size': 128, 'training.gradient_clip_val': 1.9970773204474324, 'training.early_stopping_patience': 11, 'model.nhead_emb_combo': 15, 'model.hidden_dim': 8, 'model.nlayers': 3, 'model.dropout': 0.4193166019452914, 'training.epochs': 30}. Best is trial 1 with value: -0.6377121806144714.
🧹 Cleaning up old checkpoints and logs (keeping top 10)...
  Removed old checkpoint: trial_120-epoch=04-val_auc_epoch=0.6147.ckpt
  Removed old checkpoint: trial_119-epoch=00-val_auc_epoch=0.5543.ckpt
  Removed old checkpoint: trial_118-epoch=04-val_auc_epoch=0.5878.ckpt
  Removed old checkpoint: trial_117-epoch=15-val_auc_epoch=0.5556.ckpt
  Removed old checkpoint: trial_116-epoch=04-val_auc_epoch=0.5837.ckpt
  Removed old log dir: trial_120
  Removed old log dir: trial_119
  Removed old log dir: trial_118
  Removed old log dir: trial_117
  Removed old log dir: trial_116
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 131 hyperparameters:
  Walk length: 15, Num walks: 213,842
  LR: 4.66e-05, Batch size: 64
  Model: emb_dim=8, hidden_dim=16
  Transformer: 2 layers, 1 heads
  Epochs: 28, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.526
Metric val_auc_epoch improved by 0.018 >= min_delta = 0.0. New best score: 0.543
Metric val_auc_epoch improved by 0.013 >= min_delta = 0.0. New best score: 0.557
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.562
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.563
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.564
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.565
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.565
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.565
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.565. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_131-epoch=08-val_auc_epoch=0.5654.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_131-epoch=08-val_auc_epoch=0.5654.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch          0.546558141708374
      val_auc_epoch         0.5653939247131348
      val_f1_epoch          0.5464993119239807
        val_loss             0.686694324016571
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 131 completed - Val AUC: 0.5654
[I 2025-08-22 10:06:01,552] Trial 131 finished with value: -0.5653939247131348 and parameters: {'dataset.max_walk_length': 15, 'dataset.num_walks': 213842, 'training.lr': 4.655980822000872e-05, 'training.weight_decay': 0.023458319062119586, 'training.batch_size': 64, 'training.gradient_clip_val': 1.8170174634774543, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 1, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.5725648478419747, 'training.epochs': 28}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 132 hyperparameters:
  Walk length: 13, Num walks: 205,255
  LR: 3.51e-05, Batch size: 64
  Model: emb_dim=8, hidden_dim=16
  Transformer: 2 layers, 1 heads
  Epochs: 28, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.489
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.497
Metric val_auc_epoch improved by 0.011 >= min_delta = 0.0. New best score: 0.508
Metric val_auc_epoch improved by 0.016 >= min_delta = 0.0. New best score: 0.523
Metric val_auc_epoch improved by 0.016 >= min_delta = 0.0. New best score: 0.540
Metric val_auc_epoch improved by 0.012 >= min_delta = 0.0. New best score: 0.552
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.558
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.561
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.562
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.563
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.563
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.564
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.564
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.564. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_132-epoch=13-val_auc_epoch=0.5637.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_132-epoch=13-val_auc_epoch=0.5637.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5439724922180176
      val_auc_epoch         0.5637481212615967
      val_f1_epoch          0.5396127104759216
        val_loss             0.687270998954773
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 132 completed - Val AUC: 0.5637
[I 2025-08-22 10:16:26,662] Trial 132 finished with value: -0.5637481212615967 and parameters: {'dataset.max_walk_length': 13, 'dataset.num_walks': 205255, 'training.lr': 3.514621483209854e-05, 'training.weight_decay': 0.008095206921230298, 'training.batch_size': 64, 'training.gradient_clip_val': 1.8142421512980311, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 1, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.5691220972151086, 'training.epochs': 28}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 133 hyperparameters:
  Walk length: 19, Num walks: 216,266
  LR: 6.55e-05, Batch size: 64
  Model: emb_dim=64, hidden_dim=32
  Transformer: 2 layers, 1 heads
  Epochs: 29, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.563
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.572
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.577
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.583
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.587
❌ Trial 133 failed: Trial was pruned at epoch 5.
[I 2025-08-22 10:20:17,533] Trial 133 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 19, 'dataset.num_walks': 216266, 'training.lr': 6.551758837325131e-05, 'training.weight_decay': 0.06320740785884102, 'training.batch_size': 64, 'training.gradient_clip_val': 1.7714815581968681, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 4, 'model.hidden_dim': 32, 'model.nlayers': 2, 'model.dropout': 0.5459971387788761, 'training.epochs': 29}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 134 hyperparameters:
  Walk length: 92, Num walks: 188,075
  LR: 2.30e-05, Batch size: 64
  Model: emb_dim=4, hidden_dim=128
  Transformer: 2 layers, 4 heads
  Epochs: 28, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.499
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.500
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.501
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.501
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.502
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.503
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.503
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.503
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.503
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.505
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.506
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.507
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.507
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.507
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.508
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.509
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.509
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.510
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.510
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.510
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.511
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.511
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.511
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.511
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.511
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.511
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.511
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.511
`Trainer.fit` stopped: `max_epochs=28` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_134-epoch=27-val_auc_epoch=0.5111.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_134-epoch=27-val_auc_epoch=0.5111.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch          0.506403923034668
      val_auc_epoch         0.5110822916030884
      val_f1_epoch          0.5040935277938843
        val_loss             0.693067729473114
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 134 completed - Val AUC: 0.5111
[I 2025-08-22 10:36:23,903] Trial 134 finished with value: -0.5110822916030884 and parameters: {'dataset.max_walk_length': 92, 'dataset.num_walks': 188075, 'training.lr': 2.2973680993030794e-05, 'training.weight_decay': 0.016395209148742578, 'training.batch_size': 64, 'training.gradient_clip_val': 1.8433363191916134, 'training.early_stopping_patience': 6, 'model.nhead_emb_combo': 12, 'model.hidden_dim': 128, 'model.nlayers': 2, 'model.dropout': 0.5216183754361354, 'training.epochs': 28}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 135 hyperparameters:
  Walk length: 15, Num walks: 307,112
  LR: 4.39e-05, Batch size: 64
  Model: emb_dim=8, hidden_dim=16
  Transformer: 5 layers, 1 heads
  Epochs: 29, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.515
Metric val_auc_epoch improved by 0.038 >= min_delta = 0.0. New best score: 0.554
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.559
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.561
Monitored metric val_auc_epoch did not improve in the last 6 records. Best score: 0.561. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_135-epoch=03-val_auc_epoch=0.5607.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_135-epoch=03-val_auc_epoch=0.5607.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5426086187362671
      val_auc_epoch          0.560742199420929
      val_f1_epoch          0.5406346321105957
        val_loss             0.68831866979599
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 135 completed - Val AUC: 0.5607
[I 2025-08-22 10:48:09,717] Trial 135 finished with value: -0.560742199420929 and parameters: {'dataset.max_walk_length': 15, 'dataset.num_walks': 307112, 'training.lr': 4.39486227417378e-05, 'training.weight_decay': 0.03612617859692735, 'training.batch_size': 64, 'training.gradient_clip_val': 1.6569052153107915, 'training.early_stopping_patience': 6, 'model.nhead_emb_combo': 1, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.3844963417534857, 'training.epochs': 29}. Best is trial 1 with value: -0.6377121806144714.
🧹 Cleaning up old checkpoints and logs (keeping top 10)...
  Removed old checkpoint: trial_125-epoch=01-val_auc_epoch=0.5722.ckpt
  Removed old checkpoint: trial_124-epoch=07-val_auc_epoch=0.5615.ckpt
  Removed old checkpoint: trial_123-epoch=17-val_auc_epoch=0.5674.ckpt
  Removed old checkpoint: trial_122-epoch=27-val_auc_epoch=0.5764.ckpt
  Removed old checkpoint: trial_121-epoch=08-val_auc_epoch=0.5456.ckpt
  Removed old log dir: trial_125
  Removed old log dir: trial_124
  Removed old log dir: trial_123
  Removed old log dir: trial_122
  Removed old log dir: trial_121
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 136 hyperparameters:
  Walk length: 72, Num walks: 252,505
  LR: 6.99e-03, Batch size: 64
  Model: emb_dim=4, hidden_dim=64
  Transformer: 2 layers, 1 heads
  Epochs: 26, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.535
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.541
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.542
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.542
Monitored metric val_auc_epoch did not improve in the last 7 records. Best score: 0.542. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_136-epoch=13-val_auc_epoch=0.5424.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_136-epoch=13-val_auc_epoch=0.5424.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5292898416519165
      val_auc_epoch         0.5423749685287476
      val_f1_epoch          0.5293262004852295
        val_loss            0.7241327166557312
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 136 completed - Val AUC: 0.5424
[I 2025-08-22 11:04:09,100] Trial 136 finished with value: -0.5423749685287476 and parameters: {'dataset.max_walk_length': 72, 'dataset.num_walks': 252505, 'training.lr': 0.006994884875455717, 'training.weight_decay': 0.023845460963776825, 'training.batch_size': 64, 'training.gradient_clip_val': 1.9332780244165413, 'training.early_stopping_patience': 7, 'model.nhead_emb_combo': 0, 'model.hidden_dim': 64, 'model.nlayers': 2, 'model.dropout': 0.6043860527417263, 'training.epochs': 26}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 137 hyperparameters:
  Walk length: 21, Num walks: 127,524
  LR: 3.38e-05, Batch size: 512
  Model: emb_dim=32, hidden_dim=256
  Transformer: 2 layers, 1 heads
  Epochs: 25, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.514
Metric val_auc_epoch improved by 0.014 >= min_delta = 0.0. New best score: 0.528
Metric val_auc_epoch improved by 0.011 >= min_delta = 0.0. New best score: 0.539
Metric val_auc_epoch improved by 0.009 >= min_delta = 0.0. New best score: 0.548
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.553
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.556
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.558
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.560
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.561
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.561
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.562
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.562
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.563
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.563
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.563
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.563
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.564
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.564
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.564
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.564
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.564
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.564
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.564
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.564
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.564
`Trainer.fit` stopped: `max_epochs=25` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_137-epoch=24-val_auc_epoch=0.5640.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_137-epoch=24-val_auc_epoch=0.5640.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5442091226577759
      val_auc_epoch          0.563988208770752
      val_f1_epoch          0.5438429117202759
        val_loss             0.686576247215271
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 137 completed - Val AUC: 0.5640
[I 2025-08-22 11:06:18,888] Trial 137 finished with value: -0.563988208770752 and parameters: {'dataset.max_walk_length': 21, 'dataset.num_walks': 127524, 'training.lr': 3.379155316796624e-05, 'training.weight_decay': 0.006311094859603019, 'training.batch_size': 512, 'training.gradient_clip_val': 1.707940865396162, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 3, 'model.hidden_dim': 256, 'model.nlayers': 2, 'model.dropout': 0.5098456207223637, 'training.epochs': 25}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 138 hyperparameters:
  Walk length: 51, Num walks: 125,381
  LR: 2.58e-05, Batch size: 512
  Model: emb_dim=32, hidden_dim=256
  Transformer: 2 layers, 1 heads
  Epochs: 25, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.507
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.510
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.513
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.517
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.520
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.522
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.525
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.526
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.528
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.529
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.530
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.531
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.531
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.532
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.532
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.532
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.532
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.532
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.533
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.533
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.533
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.533
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.533
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.533
`Trainer.fit` stopped: `max_epochs=25` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_138-epoch=24-val_auc_epoch=0.5326.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_138-epoch=24-val_auc_epoch=0.5326.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch          0.523291826248169
      val_auc_epoch         0.5326094627380371
      val_f1_epoch          0.5213824510574341
        val_loss             0.691326379776001
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 138 completed - Val AUC: 0.5326
[I 2025-08-22 11:08:54,369] Trial 138 finished with value: -0.5326094627380371 and parameters: {'dataset.max_walk_length': 51, 'dataset.num_walks': 125381, 'training.lr': 2.5822672249297713e-05, 'training.weight_decay': 0.006872206278078441, 'training.batch_size': 512, 'training.gradient_clip_val': 1.054950510448321, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 3, 'model.hidden_dim': 256, 'model.nlayers': 2, 'model.dropout': 0.46717543982854515, 'training.epochs': 25}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 139 hyperparameters:
  Walk length: 26, Num walks: 110,279
  LR: 3.09e-05, Batch size: 512
  Model: emb_dim=32, hidden_dim=256
  Transformer: 2 layers, 1 heads
  Epochs: 27, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.531
Metric val_auc_epoch improved by 0.014 >= min_delta = 0.0. New best score: 0.544
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.551
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.554
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.555
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.556
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.556
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.556
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.556
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.556. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_139-epoch=08-val_auc_epoch=0.5561.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_139-epoch=08-val_auc_epoch=0.5561.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5400670766830444
      val_auc_epoch         0.5561212301254272
      val_f1_epoch          0.5399121642112732
        val_loss            0.6882901191711426
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 139 completed - Val AUC: 0.5561
[I 2025-08-22 11:10:06,911] Trial 139 finished with value: -0.5561212301254272 and parameters: {'dataset.max_walk_length': 26, 'dataset.num_walks': 110279, 'training.lr': 3.094661223884139e-05, 'training.weight_decay': 0.0032846852433795863, 'training.batch_size': 512, 'training.gradient_clip_val': 1.8072063619605836, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 3, 'model.hidden_dim': 256, 'model.nlayers': 2, 'model.dropout': 0.1977586826081696, 'training.epochs': 27}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 140 hyperparameters:
  Walk length: 21, Num walks: 158,402
  LR: 2.80e-03, Batch size: 512
  Model: emb_dim=16, hidden_dim=256
  Transformer: 2 layers, 1 heads
  Epochs: 27, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.551
Metric val_auc_epoch improved by 0.021 >= min_delta = 0.0. New best score: 0.572
Metric val_auc_epoch improved by 0.010 >= min_delta = 0.0. New best score: 0.582
Metric val_auc_epoch improved by 0.015 >= min_delta = 0.0. New best score: 0.597
Metric val_auc_epoch improved by 0.012 >= min_delta = 0.0. New best score: 0.609
❌ Trial 140 failed: Trial was pruned at epoch 5.
[I 2025-08-22 11:10:56,554] Trial 140 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 21, 'dataset.num_walks': 158402, 'training.lr': 0.0027993705558538337, 'training.weight_decay': 0.008869259266553879, 'training.batch_size': 512, 'training.gradient_clip_val': 1.6131878393334456, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 2, 'model.hidden_dim': 256, 'model.nlayers': 2, 'model.dropout': 0.5058166552333005, 'training.epochs': 27}. Best is trial 1 with value: -0.6377121806144714.
🧹 Cleaning up old checkpoints and logs (keeping top 10)...
  Removed old checkpoint: trial_130-epoch=24-val_auc_epoch=0.5251.ckpt
  Removed old checkpoint: trial_129-epoch=08-val_auc_epoch=0.5557.ckpt
  Removed old checkpoint: trial_128-epoch=23-val_auc_epoch=0.5512.ckpt
  Removed old checkpoint: trial_127-epoch=02-val_auc_epoch=0.5570.ckpt
  Removed old checkpoint: trial_126-epoch=26-val_auc_epoch=0.5572.ckpt
  Removed old log dir: trial_130
  Removed old log dir: trial_129
  Removed old log dir: trial_128
  Removed old log dir: trial_127
  Removed old log dir: trial_126
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 141 hyperparameters:
  Walk length: 17, Num walks: 142,387
  LR: 3.66e-05, Batch size: 512
  Model: emb_dim=8, hidden_dim=256
  Transformer: 2 layers, 4 heads
  Epochs: 22, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.523
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.530
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.536
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.539
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.541
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.543
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.544
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.544
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.545
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.545
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.546
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.546
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.546
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.546
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.547
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.547
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.547
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.547
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.547
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.548
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.548
`Trainer.fit` stopped: `max_epochs=22` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_141-epoch=20-val_auc_epoch=0.5475.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_141-epoch=20-val_auc_epoch=0.5475.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5326284170150757
      val_auc_epoch          0.547508180141449
      val_f1_epoch          0.5246587991714478
        val_loss             0.691089928150177
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 141 completed - Val AUC: 0.5475
[I 2025-08-22 11:13:04,943] Trial 141 finished with value: -0.547508180141449 and parameters: {'dataset.max_walk_length': 17, 'dataset.num_walks': 142387, 'training.lr': 3.663563483200743e-05, 'training.weight_decay': 0.005645729732277558, 'training.batch_size': 512, 'training.gradient_clip_val': 1.6945804467052417, 'training.early_stopping_patience': 6, 'model.nhead_emb_combo': 13, 'model.hidden_dim': 256, 'model.nlayers': 2, 'model.dropout': 0.5275366032543707, 'training.epochs': 22}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 142 hyperparameters:
  Walk length: 89, Num walks: 166,296
  LR: 5.51e-05, Batch size: 32
  Model: emb_dim=64, hidden_dim=8
  Transformer: 2 layers, 1 heads
  Epochs: 28, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.559
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.560
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.564
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.570
❌ Trial 142 failed: Trial was pruned at epoch 5.
[I 2025-08-22 11:18:55,848] Trial 142 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 89, 'dataset.num_walks': 166296, 'training.lr': 5.513337032660154e-05, 'training.weight_decay': 0.014814078369374775, 'training.batch_size': 32, 'training.gradient_clip_val': 1.8694872520312489, 'training.early_stopping_patience': 6, 'model.nhead_emb_combo': 4, 'model.hidden_dim': 8, 'model.nlayers': 2, 'model.dropout': 0.553947827594312, 'training.epochs': 28}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 143 hyperparameters:
  Walk length: 14, Num walks: 133,098
  LR: 4.84e-05, Batch size: 256
  Model: emb_dim=16, hidden_dim=16
  Transformer: 2 layers, 4 heads
  Epochs: 23, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.504
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.512
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.518
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.526
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.534
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.540
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.545
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.548
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.551
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.552
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.553
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.554
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.555
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.555
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.556
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.556
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.556
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.556
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.556
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.556
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.556
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.556
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.556
`Trainer.fit` stopped: `max_epochs=23` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_143-epoch=22-val_auc_epoch=0.5564.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_143-epoch=22-val_auc_epoch=0.5564.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5403456687927246
      val_auc_epoch         0.5563760995864868
      val_f1_epoch          0.5384491682052612
        val_loss            0.6882011890411377
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 143 completed - Val AUC: 0.5564
[I 2025-08-22 11:21:52,821] Trial 143 finished with value: -0.5563760995864868 and parameters: {'dataset.max_walk_length': 14, 'dataset.num_walks': 133098, 'training.lr': 4.8374688978787794e-05, 'training.weight_decay': 0.003976820513388839, 'training.batch_size': 256, 'training.gradient_clip_val': 1.720600737216054, 'training.early_stopping_patience': 18, 'model.nhead_emb_combo': 14, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.5737965745118947, 'training.epochs': 23}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 144 hyperparameters:
  Walk length: 98, Num walks: 182,407
  LR: 8.50e-04, Batch size: 512
  Model: emb_dim=32, hidden_dim=8
  Transformer: 2 layers, 4 heads
  Epochs: 28, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.535
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.537
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.539
Metric val_auc_epoch improved by 0.020 >= min_delta = 0.0. New best score: 0.559
Metric val_auc_epoch improved by 0.018 >= min_delta = 0.0. New best score: 0.577
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.585
Metric val_auc_epoch improved by 0.009 >= min_delta = 0.0. New best score: 0.594
Metric val_auc_epoch improved by 0.009 >= min_delta = 0.0. New best score: 0.602
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.606
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.609
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.613
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.617
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.618
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.621
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.622
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.625
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.625
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.627
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.627
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.628
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.629
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.629
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.630
❌ Trial 144 failed: Trial was pruned at epoch 25.
[I 2025-08-22 11:27:45,937] Trial 144 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 98, 'dataset.num_walks': 182407, 'training.lr': 0.000849619789489911, 'training.weight_decay': 0.010977592603015052, 'training.batch_size': 512, 'training.gradient_clip_val': 1.782239889856592, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 15, 'model.hidden_dim': 8, 'model.nlayers': 2, 'model.dropout': 0.5388144089373939, 'training.epochs': 28}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 145 hyperparameters:
  Walk length: 20, Num walks: 119,726
  LR: 2.07e-05, Batch size: 32
  Model: emb_dim=16, hidden_dim=16
  Transformer: 2 layers, 1 heads
  Epochs: 30, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.510
Metric val_auc_epoch improved by 0.012 >= min_delta = 0.0. New best score: 0.522
Metric val_auc_epoch improved by 0.014 >= min_delta = 0.0. New best score: 0.537
Metric val_auc_epoch improved by 0.013 >= min_delta = 0.0. New best score: 0.550
Metric val_auc_epoch improved by 0.009 >= min_delta = 0.0. New best score: 0.558
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.562
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.564
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.565
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.565
Monitored metric val_auc_epoch did not improve in the last 6 records. Best score: 0.565. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_145-epoch=08-val_auc_epoch=0.5653.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_145-epoch=08-val_auc_epoch=0.5653.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5450957417488098
      val_auc_epoch         0.5653152465820312
      val_f1_epoch          0.5404971241950989
        val_loss            0.6872997283935547
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 145 completed - Val AUC: 0.5653
[I 2025-08-22 11:37:04,436] Trial 145 finished with value: -0.5653152465820312 and parameters: {'dataset.max_walk_length': 20, 'dataset.num_walks': 119726, 'training.lr': 2.0683052469733055e-05, 'training.weight_decay': 0.0022265393112732863, 'training.batch_size': 32, 'training.gradient_clip_val': 1.671408104705856, 'training.early_stopping_patience': 6, 'model.nhead_emb_combo': 2, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.4904597294276774, 'training.epochs': 30}. Best is trial 1 with value: -0.6377121806144714.
🧹 Cleaning up old checkpoints and logs (keeping top 10)...
  Removed old checkpoint: trial_135-epoch=03-val_auc_epoch=0.5607.ckpt
  Removed old checkpoint: trial_134-epoch=27-val_auc_epoch=0.5111.ckpt
  Removed old checkpoint: trial_133-epoch=04-val_auc_epoch=0.5866.ckpt
  Removed old checkpoint: trial_132-epoch=13-val_auc_epoch=0.5637.ckpt
  Removed old checkpoint: trial_131-epoch=08-val_auc_epoch=0.5654.ckpt
  Removed old log dir: trial_135
  Removed old log dir: trial_134
  Removed old log dir: trial_133
  Removed old log dir: trial_132
  Removed old log dir: trial_131
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 146 hyperparameters:
  Walk length: 23, Num walks: 119,561
  LR: 2.11e-05, Batch size: 64
  Model: emb_dim=16, hidden_dim=16
  Transformer: 2 layers, 1 heads
  Epochs: 30, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.507
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.512
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.518
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.525
Metric val_auc_epoch improved by 0.009 >= min_delta = 0.0. New best score: 0.534
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.542
Metric val_auc_epoch improved by 0.009 >= min_delta = 0.0. New best score: 0.551
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.556
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.560
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.562
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.564
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.565
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.566
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.566
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.566
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.567
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.567
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.567
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.567
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.567
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.567
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.568
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.568
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.568
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.568
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.568
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.568
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.568
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.568
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.568
`Trainer.fit` stopped: `max_epochs=30` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_146-epoch=29-val_auc_epoch=0.5677.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_146-epoch=29-val_auc_epoch=0.5677.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5461972951889038
      val_auc_epoch         0.5677382946014404
      val_f1_epoch          0.5447186231613159
        val_loss             0.685980498790741
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 146 completed - Val AUC: 0.5677
[I 2025-08-22 11:47:18,526] Trial 146 finished with value: -0.5677382946014404 and parameters: {'dataset.max_walk_length': 23, 'dataset.num_walks': 119561, 'training.lr': 2.1143553620742054e-05, 'training.weight_decay': 0.002007622258116937, 'training.batch_size': 64, 'training.gradient_clip_val': 1.8385798423484336, 'training.early_stopping_patience': 6, 'model.nhead_emb_combo': 2, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.4960015540034021, 'training.epochs': 30}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 147 hyperparameters:
  Walk length: 23, Num walks: 106,987
  LR: 1.76e-05, Batch size: 64
  Model: emb_dim=8, hidden_dim=16
  Transformer: 2 layers, 1 heads
  Epochs: 30, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.509
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.512
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.516
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.519
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.522
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.525
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.528
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.530
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.533
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.535
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.537
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.538
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.540
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.541
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.542
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.543
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.544
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.545
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.545
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.546
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.546
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.546
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.547
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.547
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.547
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.547
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.547
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.547
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.547
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.547
`Trainer.fit` stopped: `max_epochs=30` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_147-epoch=29-val_auc_epoch=0.5471.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_147-epoch=29-val_auc_epoch=0.5471.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5341140627861023
      val_auc_epoch         0.5470942258834839
      val_f1_epoch          0.5276683568954468
        val_loss            0.6901970505714417
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 147 completed - Val AUC: 0.5471
[I 2025-08-22 11:56:29,005] Trial 147 finished with value: -0.5470942258834839 and parameters: {'dataset.max_walk_length': 23, 'dataset.num_walks': 106987, 'training.lr': 1.7570522452535783e-05, 'training.weight_decay': 0.0020702458902806956, 'training.batch_size': 64, 'training.gradient_clip_val': 1.9079657448707594, 'training.early_stopping_patience': 6, 'model.nhead_emb_combo': 1, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.4748154231234731, 'training.epochs': 30}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 148 hyperparameters:
  Walk length: 27, Num walks: 118,041
  LR: 2.17e-05, Batch size: 64
  Model: emb_dim=16, hidden_dim=16
  Transformer: 2 layers, 1 heads
  Epochs: 30, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.505
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.511
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.519
Metric val_auc_epoch improved by 0.009 >= min_delta = 0.0. New best score: 0.528
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.536
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.542
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.545
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.547
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.549
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.550
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.550
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.551
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.551
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.552
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.552
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.552
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.552
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.552
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.552
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.552
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.552
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.552
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.552
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.552
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.552
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.552
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.552
`Trainer.fit` stopped: `max_epochs=30` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_148-epoch=28-val_auc_epoch=0.5522.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_148-epoch=28-val_auc_epoch=0.5522.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5324952602386475
      val_auc_epoch         0.5521743297576904
      val_f1_epoch          0.5140305161476135
        val_loss            0.6898131370544434
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 148 completed - Val AUC: 0.5522
[I 2025-08-22 12:06:41,454] Trial 148 finished with value: -0.5521743297576904 and parameters: {'dataset.max_walk_length': 27, 'dataset.num_walks': 118041, 'training.lr': 2.172819776255185e-05, 'training.weight_decay': 0.0015295273009749747, 'training.batch_size': 64, 'training.gradient_clip_val': 1.8366231387785674, 'training.early_stopping_patience': 16, 'model.nhead_emb_combo': 2, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.4930056790893693, 'training.epochs': 30}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 149 hyperparameters:
  Walk length: 38, Num walks: 100,276
  LR: 1.28e-05, Batch size: 64
  Model: emb_dim=4, hidden_dim=16
  Transformer: 2 layers, 1 heads
  Epochs: 29, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.500
Monitored metric val_auc_epoch did not improve in the last 6 records. Best score: 0.500. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_149-epoch=00-val_auc_epoch=0.4999.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_149-epoch=00-val_auc_epoch=0.4999.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.4999984800815582
      val_auc_epoch         0.4999426007270813
      val_f1_epoch          0.29679572582244873
        val_loss            0.7432776689529419
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 149 completed - Val AUC: 0.4999
[I 2025-08-22 12:08:59,533] Trial 149 finished with value: -0.4999426007270813 and parameters: {'dataset.max_walk_length': 38, 'dataset.num_walks': 100276, 'training.lr': 1.2822420909368049e-05, 'training.weight_decay': 0.0013004784801701602, 'training.batch_size': 64, 'training.gradient_clip_val': 1.9521616254479213, 'training.early_stopping_patience': 6, 'model.nhead_emb_combo': 0, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.6259071327682638, 'training.epochs': 29}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 150 hyperparameters:
  Walk length: 11, Num walks: 340,482
  LR: 1.55e-05, Batch size: 64
  Model: emb_dim=16, hidden_dim=16
  Transformer: 2 layers, 1 heads
  Epochs: 30, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.552
Metric val_auc_epoch improved by 0.013 >= min_delta = 0.0. New best score: 0.564
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.568
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.570
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.571
❌ Trial 150 failed: Trial was pruned at epoch 5.
[I 2025-08-22 12:14:35,693] Trial 150 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 11, 'dataset.num_walks': 340482, 'training.lr': 1.545324943810124e-05, 'training.weight_decay': 0.002455845817436482, 'training.batch_size': 64, 'training.gradient_clip_val': 1.132094069676692, 'training.early_stopping_patience': 6, 'model.nhead_emb_combo': 2, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.48437393838295423, 'training.epochs': 30}. Best is trial 1 with value: -0.6377121806144714.
🧹 Cleaning up old checkpoints and logs (keeping top 10)...
  Removed old checkpoint: trial_140-epoch=04-val_auc_epoch=0.6090.ckpt
  Removed old checkpoint: trial_139-epoch=08-val_auc_epoch=0.5561.ckpt
  Removed old checkpoint: trial_138-epoch=24-val_auc_epoch=0.5326.ckpt
  Removed old checkpoint: trial_137-epoch=24-val_auc_epoch=0.5640.ckpt
  Removed old checkpoint: trial_136-epoch=13-val_auc_epoch=0.5424.ckpt
  Removed old log dir: trial_140
  Removed old log dir: trial_139
  Removed old log dir: trial_138
  Removed old log dir: trial_137
  Removed old log dir: trial_136
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 151 hyperparameters:
  Walk length: 20, Num walks: 121,407
  LR: 2.94e-05, Batch size: 64
  Model: emb_dim=32, hidden_dim=16
  Transformer: 2 layers, 1 heads
  Epochs: 29, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.541
Metric val_auc_epoch improved by 0.023 >= min_delta = 0.0. New best score: 0.563
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.571
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.575
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.577
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.579
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.580
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.581
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.581
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.581
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.581
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.582
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.582
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.582
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.582
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.582
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.583
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.583
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.583
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.583
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.583
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.583
`Trainer.fit` stopped: `max_epochs=29` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_151-epoch=27-val_auc_epoch=0.5828.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_151-epoch=27-val_auc_epoch=0.5828.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5562024712562561
      val_auc_epoch         0.5827915668487549
      val_f1_epoch          0.5528815984725952
        val_loss            0.6811106204986572
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 151 completed - Val AUC: 0.5828
[I 2025-08-22 12:24:32,619] Trial 151 finished with value: -0.5827915668487549 and parameters: {'dataset.max_walk_length': 20, 'dataset.num_walks': 121407, 'training.lr': 2.9425265133926966e-05, 'training.weight_decay': 0.004757132118576101, 'training.batch_size': 64, 'training.gradient_clip_val': 1.768396659169011, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 3, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.5094641042560127, 'training.epochs': 29}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 152 hyperparameters:
  Walk length: 20, Num walks: 119,600
  LR: 2.67e-05, Batch size: 64
  Model: emb_dim=64, hidden_dim=16
  Transformer: 2 layers, 1 heads
  Epochs: 29, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.540
Metric val_auc_epoch improved by 0.012 >= min_delta = 0.0. New best score: 0.552
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.558
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.560
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.560
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.560
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.561
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.564
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.565
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.566
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.567
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.568
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.569
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.569
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.570
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.570
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.570
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.571
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.571
`Trainer.fit` stopped: `max_epochs=29` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_152-epoch=22-val_auc_epoch=0.5709.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_152-epoch=22-val_auc_epoch=0.5709.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5498756170272827
      val_auc_epoch         0.5708889961242676
      val_f1_epoch          0.5449210405349731
        val_loss            0.7029472589492798
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 152 completed - Val AUC: 0.5709
[I 2025-08-22 12:34:17,156] Trial 152 finished with value: -0.5708889961242676 and parameters: {'dataset.max_walk_length': 20, 'dataset.num_walks': 119600, 'training.lr': 2.6684081014629406e-05, 'training.weight_decay': 0.0009113196935510941, 'training.batch_size': 64, 'training.gradient_clip_val': 1.7874241821712753, 'training.early_stopping_patience': 15, 'model.nhead_emb_combo': 4, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.496125208761508, 'training.epochs': 29}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 153 hyperparameters:
  Walk length: 24, Num walks: 113,244
  LR: 2.04e-05, Batch size: 64
  Model: emb_dim=64, hidden_dim=16
  Transformer: 2 layers, 1 heads
  Epochs: 29, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.542
Metric val_auc_epoch improved by 0.016 >= min_delta = 0.0. New best score: 0.558
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.562
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.564
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.564
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.564
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.565
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.565
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.566
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.567
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.567
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.569
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.569
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.570
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.571
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.572
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.572
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.572
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.573
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.573
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.573
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.573
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.573
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.573
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.573
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.573
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.573
`Trainer.fit` stopped: `max_epochs=29` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_153-epoch=28-val_auc_epoch=0.5734.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_153-epoch=28-val_auc_epoch=0.5734.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5508056282997131
      val_auc_epoch         0.5734379291534424
      val_f1_epoch           0.550286591053009
        val_loss            0.6878718733787537
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 153 completed - Val AUC: 0.5734
[I 2025-08-22 12:43:40,513] Trial 153 finished with value: -0.5734379291534424 and parameters: {'dataset.max_walk_length': 24, 'dataset.num_walks': 113244, 'training.lr': 2.0414271971096084e-05, 'training.weight_decay': 0.0010138486224175681, 'training.batch_size': 64, 'training.gradient_clip_val': 1.7996772874725009, 'training.early_stopping_patience': 14, 'model.nhead_emb_combo': 4, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.502853990281247, 'training.epochs': 29}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 154 hyperparameters:
  Walk length: 25, Num walks: 107,637
  LR: 2.54e-05, Batch size: 64
  Model: emb_dim=64, hidden_dim=16
  Transformer: 2 layers, 1 heads
  Epochs: 28, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.541
Metric val_auc_epoch improved by 0.017 >= min_delta = 0.0. New best score: 0.558
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.561
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.562
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.563
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.564
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.564
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.565
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.565
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.566
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.566
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.567
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.567
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.567
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.568
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.568
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.568
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.568
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.569
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.569
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.569
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.569
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.569
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.569
`Trainer.fit` stopped: `max_epochs=28` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_154-epoch=27-val_auc_epoch=0.5689.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_154-epoch=27-val_auc_epoch=0.5689.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch          0.548516571521759
      val_auc_epoch          0.568897008895874
      val_f1_epoch          0.5468714237213135
        val_loss            0.6912164092063904
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 154 completed - Val AUC: 0.5689
[I 2025-08-22 12:52:23,913] Trial 154 finished with value: -0.568897008895874 and parameters: {'dataset.max_walk_length': 25, 'dataset.num_walks': 107637, 'training.lr': 2.5417741489099844e-05, 'training.weight_decay': 0.0007205538855761632, 'training.batch_size': 64, 'training.gradient_clip_val': 1.8638735472482233, 'training.early_stopping_patience': 15, 'model.nhead_emb_combo': 4, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.46393696499159454, 'training.epochs': 28}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 155 hyperparameters:
  Walk length: 24, Num walks: 108,633
  LR: 2.43e-05, Batch size: 64
  Model: emb_dim=64, hidden_dim=16
  Transformer: 2 layers, 1 heads
  Epochs: 29, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.547
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.554
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.555
❌ Trial 155 failed: Trial was pruned at epoch 6.
[I 2025-08-22 12:54:42,193] Trial 155 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 24, 'dataset.num_walks': 108633, 'training.lr': 2.428854791115678e-05, 'training.weight_decay': 0.0007547647036399409, 'training.batch_size': 64, 'training.gradient_clip_val': 1.8839761959905141, 'training.early_stopping_patience': 15, 'model.nhead_emb_combo': 4, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.44847707258293207, 'training.epochs': 29}. Best is trial 1 with value: -0.6377121806144714.
🧹 Cleaning up old checkpoints and logs (keeping top 10)...
  Removed old checkpoint: trial_145-epoch=08-val_auc_epoch=0.5653.ckpt
  Removed old checkpoint: trial_144-epoch=22-val_auc_epoch=0.6299.ckpt
  Removed old checkpoint: trial_143-epoch=22-val_auc_epoch=0.5564.ckpt
  Removed old checkpoint: trial_142-epoch=04-val_auc_epoch=0.5702.ckpt
  Removed old checkpoint: trial_141-epoch=20-val_auc_epoch=0.5475.ckpt
  Removed old log dir: trial_145
  Removed old log dir: trial_144
  Removed old log dir: trial_143
  Removed old log dir: trial_142
  Removed old log dir: trial_141
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 156 hyperparameters:
  Walk length: 30, Num walks: 114,310
  LR: 1.79e-05, Batch size: 64
  Model: emb_dim=128, hidden_dim=16
  Transformer: 2 layers, 1 heads
  Epochs: 29, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.556
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.560
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.560
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.561
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.564
❌ Trial 156 failed: Trial was pruned at epoch 5.
[I 2025-08-22 12:56:49,842] Trial 156 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 30, 'dataset.num_walks': 114310, 'training.lr': 1.793026207432259e-05, 'training.weight_decay': 0.0011760197376189626, 'training.batch_size': 64, 'training.gradient_clip_val': 1.8561460541574204, 'training.early_stopping_patience': 15, 'model.nhead_emb_combo': 5, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.4608237641177816, 'training.epochs': 29}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 157 hyperparameters:
  Walk length: 33, Num walks: 105,436
  LR: 2.64e-05, Batch size: 64
  Model: emb_dim=64, hidden_dim=16
  Transformer: 2 layers, 1 heads
  Epochs: 29, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.530
Metric val_auc_epoch improved by 0.014 >= min_delta = 0.0. New best score: 0.544
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.552
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.554
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.555
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.555
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.556
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.558
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.558
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.560
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.561
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.561
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.563
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.563
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.565
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.565
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.566
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.567
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.567
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.567
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.568
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.568
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.568
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.568
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.568
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.568
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.568
`Trainer.fit` stopped: `max_epochs=29` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_157-epoch=28-val_auc_epoch=0.5685.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_157-epoch=28-val_auc_epoch=0.5685.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5486291646957397
      val_auc_epoch         0.5684728622436523
      val_f1_epoch          0.5484935641288757
        val_loss            0.6898910403251648
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 157 completed - Val AUC: 0.5685
[I 2025-08-22 13:05:44,943] Trial 157 finished with value: -0.5684728622436523 and parameters: {'dataset.max_walk_length': 33, 'dataset.num_walks': 105436, 'training.lr': 2.6366129135060194e-05, 'training.weight_decay': 0.0005725870651530531, 'training.batch_size': 64, 'training.gradient_clip_val': 1.9326959631795322, 'training.early_stopping_patience': 14, 'model.nhead_emb_combo': 4, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.5005090818331742, 'training.epochs': 29}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 158 hyperparameters:
  Walk length: 35, Num walks: 105,014
  LR: 2.75e-05, Batch size: 64
  Model: emb_dim=64, hidden_dim=16
  Transformer: 2 layers, 1 heads
  Epochs: 29, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.558
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.565
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.568
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.569
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.570
❌ Trial 158 failed: Trial was pruned at epoch 5.
[I 2025-08-22 13:07:44,049] Trial 158 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 35, 'dataset.num_walks': 105014, 'training.lr': 2.7474017303664376e-05, 'training.weight_decay': 0.0008554386507308344, 'training.batch_size': 64, 'training.gradient_clip_val': 1.7883402215094213, 'training.early_stopping_patience': 14, 'model.nhead_emb_combo': 4, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.5076633783648408, 'training.epochs': 29}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 159 hyperparameters:
  Walk length: 33, Num walks: 124,631
  LR: 2.15e-05, Batch size: 64
  Model: emb_dim=128, hidden_dim=16
  Transformer: 2 layers, 1 heads
  Epochs: 30, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.554
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.559
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.562
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.562
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.565
❌ Trial 159 failed: Trial was pruned at epoch 5.
[I 2025-08-22 13:10:05,020] Trial 159 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 33, 'dataset.num_walks': 124631, 'training.lr': 2.145589594514284e-05, 'training.weight_decay': 0.001591800709610513, 'training.batch_size': 64, 'training.gradient_clip_val': 1.9680742667397637, 'training.early_stopping_patience': 14, 'model.nhead_emb_combo': 5, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.4811840646363227, 'training.epochs': 30}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 160 hyperparameters:
  Walk length: 25, Num walks: 100,331
  LR: 1.44e-05, Batch size: 64
  Model: emb_dim=64, hidden_dim=16
  Transformer: 2 layers, 1 heads
  Epochs: 28, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.517
Metric val_auc_epoch improved by 0.018 >= min_delta = 0.0. New best score: 0.534
Metric val_auc_epoch improved by 0.014 >= min_delta = 0.0. New best score: 0.548
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.556
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.560
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.563
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.565
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.567
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.568
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.569
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.570
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.570
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.571
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.572
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.572
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.573
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.573
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.574
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.574
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.574
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.574
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.574
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.574
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.574
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.574
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.574
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.574
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.574
`Trainer.fit` stopped: `max_epochs=28` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_160-epoch=27-val_auc_epoch=0.5742.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_160-epoch=27-val_auc_epoch=0.5742.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5489295721054077
      val_auc_epoch         0.5742249488830566
      val_f1_epoch          0.5425710082054138
        val_loss            0.6834977269172668
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 160 completed - Val AUC: 0.5742
[I 2025-08-22 13:18:09,854] Trial 160 finished with value: -0.5742249488830566 and parameters: {'dataset.max_walk_length': 25, 'dataset.num_walks': 100331, 'training.lr': 1.4380382722742891e-05, 'training.weight_decay': 0.0006382553762898943, 'training.batch_size': 64, 'training.gradient_clip_val': 1.925224006550741, 'training.early_stopping_patience': 15, 'model.nhead_emb_combo': 4, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.490471941448925, 'training.epochs': 28}. Best is trial 1 with value: -0.6377121806144714.
🧹 Cleaning up old checkpoints and logs (keeping top 10)...
  Removed old checkpoint: trial_150-epoch=04-val_auc_epoch=0.5707.ckpt
  Removed old checkpoint: trial_149-epoch=00-val_auc_epoch=0.4999.ckpt
  Removed old checkpoint: trial_148-epoch=28-val_auc_epoch=0.5522.ckpt
  Removed old checkpoint: trial_147-epoch=29-val_auc_epoch=0.5471.ckpt
  Removed old checkpoint: trial_146-epoch=29-val_auc_epoch=0.5677.ckpt
  Removed old log dir: trial_150
  Removed old log dir: trial_149
  Removed old log dir: trial_148
  Removed old log dir: trial_147
  Removed old log dir: trial_146
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 161 hyperparameters:
  Walk length: 26, Num walks: 100,517
  LR: 1.50e-05, Batch size: 64
  Model: emb_dim=64, hidden_dim=16
  Transformer: 2 layers, 1 heads
  Epochs: 28, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.540
Metric val_auc_epoch improved by 0.013 >= min_delta = 0.0. New best score: 0.554
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.559
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.563
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.564
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.565
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.566
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.566
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.567
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.567
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.567
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.568
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.568
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.568
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.569
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.569
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.569
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.569
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.569
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.570
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.570
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.570
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.570
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.570
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.570
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.570
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.570
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.570
`Trainer.fit` stopped: `max_epochs=28` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_161-epoch=27-val_auc_epoch=0.5700.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_161-epoch=27-val_auc_epoch=0.5700.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5478830933570862
      val_auc_epoch         0.5700098276138306
      val_f1_epoch          0.5478504300117493
        val_loss            0.6868872046470642
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 161 completed - Val AUC: 0.5700
[I 2025-08-22 13:26:16,072] Trial 161 finished with value: -0.5700098276138306 and parameters: {'dataset.max_walk_length': 26, 'dataset.num_walks': 100517, 'training.lr': 1.4991804021700107e-05, 'training.weight_decay': 0.000962470592256076, 'training.batch_size': 64, 'training.gradient_clip_val': 1.9255202484362262, 'training.early_stopping_patience': 15, 'model.nhead_emb_combo': 4, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.4986468843071681, 'training.epochs': 28}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 162 hyperparameters:
  Walk length: 28, Num walks: 103,115
  LR: 1.21e-05, Batch size: 64
  Model: emb_dim=64, hidden_dim=16
  Transformer: 2 layers, 1 heads
  Epochs: 28, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.523
Metric val_auc_epoch improved by 0.015 >= min_delta = 0.0. New best score: 0.538
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.544
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.547
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.548
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.549
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.550
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.550
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.550
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.551
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.551
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.551
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.551
`Trainer.fit` stopped: `max_epochs=28` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_162-epoch=16-val_auc_epoch=0.5511.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_162-epoch=16-val_auc_epoch=0.5511.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5359991788864136
      val_auc_epoch          0.551122784614563
      val_f1_epoch           0.536040186882019
        val_loss            0.6887564659118652
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 162 completed - Val AUC: 0.5511
[I 2025-08-22 13:34:36,569] Trial 162 finished with value: -0.551122784614563 and parameters: {'dataset.max_walk_length': 28, 'dataset.num_walks': 103115, 'training.lr': 1.2096586950441068e-05, 'training.weight_decay': 0.0006393697976483144, 'training.batch_size': 64, 'training.gradient_clip_val': 1.9994467672492449, 'training.early_stopping_patience': 15, 'model.nhead_emb_combo': 4, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.49568658707820695, 'training.epochs': 28}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 163 hyperparameters:
  Walk length: 26, Num walks: 112,049
  LR: 1.46e-05, Batch size: 64
  Model: emb_dim=128, hidden_dim=16
  Transformer: 2 layers, 1 heads
  Epochs: 27, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.551
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.558
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.561
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.564
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.566
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.567
❌ Trial 163 failed: Trial was pruned at epoch 6.
[I 2025-08-22 13:37:00,004] Trial 163 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 26, 'dataset.num_walks': 112049, 'training.lr': 1.4582770985677672e-05, 'training.weight_decay': 0.000457574761075534, 'training.batch_size': 64, 'training.gradient_clip_val': 1.915102906414575, 'training.early_stopping_patience': 16, 'model.nhead_emb_combo': 5, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.4521382187757064, 'training.epochs': 27}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 164 hyperparameters:
  Walk length: 31, Num walks: 116,887
  LR: 1.00e-05, Batch size: 64
  Model: emb_dim=64, hidden_dim=16
  Transformer: 2 layers, 1 heads
  Epochs: 29, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.533
Metric val_auc_epoch improved by 0.010 >= min_delta = 0.0. New best score: 0.543
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.549
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.552
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.554
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.556
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.557
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.557
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.558
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.558
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.558
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.559
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.559
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.559
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.559
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.560
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.560
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.560
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.560
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.560
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.561
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.561
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.561
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.561
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.561
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.561
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.561
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.561
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.561
`Trainer.fit` stopped: `max_epochs=29` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_164-epoch=28-val_auc_epoch=0.5609.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_164-epoch=28-val_auc_epoch=0.5609.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5399859547615051
      val_auc_epoch          0.560868501663208
      val_f1_epoch          0.5400338172912598
        val_loss            0.6866576671600342
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 164 completed - Val AUC: 0.5609
[I 2025-08-22 13:46:47,651] Trial 164 finished with value: -0.560868501663208 and parameters: {'dataset.max_walk_length': 31, 'dataset.num_walks': 116887, 'training.lr': 1.0024787898117093e-05, 'training.weight_decay': 0.0010047234984180602, 'training.batch_size': 64, 'training.gradient_clip_val': 1.9399508004516326, 'training.early_stopping_patience': 15, 'model.nhead_emb_combo': 4, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.47413650799210627, 'training.epochs': 29}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 165 hyperparameters:
  Walk length: 25, Num walks: 107,055
  LR: 1.68e-05, Batch size: 64
  Model: emb_dim=128, hidden_dim=16
  Transformer: 2 layers, 1 heads
  Epochs: 28, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.551
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.558
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.564
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.565
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.567
❌ Trial 165 failed: Trial was pruned at epoch 5.
[I 2025-08-22 13:48:46,896] Trial 165 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 25, 'dataset.num_walks': 107055, 'training.lr': 1.677381135634254e-05, 'training.weight_decay': 0.0005201075870932001, 'training.batch_size': 64, 'training.gradient_clip_val': 1.8897334023832968, 'training.early_stopping_patience': 13, 'model.nhead_emb_combo': 5, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.4377581809098911, 'training.epochs': 28}. Best is trial 1 with value: -0.6377121806144714.
🧹 Cleaning up old checkpoints and logs (keeping top 10)...
  Removed old checkpoint: trial_155-epoch=02-val_auc_epoch=0.5554.ckpt
  Removed old checkpoint: trial_154-epoch=27-val_auc_epoch=0.5689.ckpt
  Removed old checkpoint: trial_153-epoch=28-val_auc_epoch=0.5734.ckpt
  Removed old checkpoint: trial_152-epoch=22-val_auc_epoch=0.5709.ckpt
  Removed old checkpoint: trial_151-epoch=27-val_auc_epoch=0.5828.ckpt
  Removed old log dir: trial_155
  Removed old log dir: trial_154
  Removed old log dir: trial_153
  Removed old log dir: trial_152
  Removed old log dir: trial_151
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 166 hyperparameters:
  Walk length: 68, Num walks: 101,944
  LR: 1.40e-05, Batch size: 64
  Model: emb_dim=32, hidden_dim=16
  Transformer: 2 layers, 1 heads
  Epochs: 29, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.501
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.504
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.506
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.509
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.512
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.516
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.520
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.523
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.527
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.531
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.534
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.536
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.538
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.540
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.541
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.542
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.543
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.543
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.543
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.544
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.544
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.544
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.544
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.544
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.544
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.544
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.544
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.544
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.544
`Trainer.fit` stopped: `max_epochs=29` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_166-epoch=28-val_auc_epoch=0.5443.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_166-epoch=28-val_auc_epoch=0.5443.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5315521955490112
      val_auc_epoch         0.5443443059921265
      val_f1_epoch          0.5307501554489136
        val_loss            0.6900938153266907
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 166 completed - Val AUC: 0.5443
[I 2025-08-22 13:57:37,734] Trial 166 finished with value: -0.5443443059921265 and parameters: {'dataset.max_walk_length': 68, 'dataset.num_walks': 101944, 'training.lr': 1.4029196161812809e-05, 'training.weight_decay': 0.000876218382756669, 'training.batch_size': 64, 'training.gradient_clip_val': 1.3634916341055665, 'training.early_stopping_patience': 15, 'model.nhead_emb_combo': 3, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.4942695512220346, 'training.epochs': 29}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 167 hyperparameters:
  Walk length: 27, Num walks: 130,252
  LR: 2.08e-05, Batch size: 64
  Model: emb_dim=4, hidden_dim=16
  Transformer: 2 layers, 2 heads
  Epochs: 27, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.497
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.497
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.498
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.498
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.499
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.499
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.499
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.499
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.499
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.500
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.500
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.500
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.500
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.500
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.500
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.501
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.501
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.501
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.501
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.501
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.501
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.501
`Trainer.fit` stopped: `max_epochs=27` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_167-epoch=26-val_auc_epoch=0.5006.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_167-epoch=26-val_auc_epoch=0.5006.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5004357695579529
      val_auc_epoch         0.5006290674209595
      val_f1_epoch          0.5002301335334778
        val_loss            0.6931459903717041
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 167 completed - Val AUC: 0.5006
[I 2025-08-22 14:08:00,711] Trial 167 finished with value: -0.5006290674209595 and parameters: {'dataset.max_walk_length': 27, 'dataset.num_walks': 130252, 'training.lr': 2.0815987899868596e-05, 'training.weight_decay': 0.0016931721695485783, 'training.batch_size': 64, 'training.gradient_clip_val': 1.8528542792265192, 'training.early_stopping_patience': 14, 'model.nhead_emb_combo': 6, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.4725662393610366, 'training.epochs': 27}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 168 hyperparameters:
  Walk length: 29, Num walks: 100,196
  LR: 1.73e-05, Batch size: 64
  Model: emb_dim=64, hidden_dim=16
  Transformer: 2 layers, 1 heads
  Epochs: 28, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.529
Metric val_auc_epoch improved by 0.012 >= min_delta = 0.0. New best score: 0.541
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.545
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.547
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.547
Monitored metric val_auc_epoch did not improve in the last 16 records. Best score: 0.547. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_168-epoch=04-val_auc_epoch=0.5469.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_168-epoch=04-val_auc_epoch=0.5469.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5332539081573486
      val_auc_epoch         0.5469356775283813
      val_f1_epoch          0.5297726988792419
        val_loss            0.6932841539382935
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 168 completed - Val AUC: 0.5469
[I 2025-08-22 14:14:12,897] Trial 168 finished with value: -0.5469356775283813 and parameters: {'dataset.max_walk_length': 29, 'dataset.num_walks': 100196, 'training.lr': 1.7264894074358036e-05, 'training.weight_decay': 0.00037245133448957595, 'training.batch_size': 64, 'training.gradient_clip_val': 1.9683791931950414, 'training.early_stopping_patience': 16, 'model.nhead_emb_combo': 4, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.5095494260706931, 'training.epochs': 28}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 169 hyperparameters:
  Walk length: 33, Num walks: 114,476
  LR: 1.20e-05, Batch size: 64
  Model: emb_dim=4, hidden_dim=16
  Transformer: 2 layers, 2 heads
  Epochs: 30, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.477
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.477
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.478
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.479
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.480
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.481
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.482
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.482
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.483
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.483
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.483
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.484
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.484
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.484
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.484
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.484
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.484
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.484
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.484
`Trainer.fit` stopped: `max_epochs=30` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_169-epoch=29-val_auc_epoch=0.4843.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_169-epoch=29-val_auc_epoch=0.4843.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.4930433928966522
      val_auc_epoch         0.4842788577079773
      val_f1_epoch          0.48386624455451965
        val_loss            0.6933528780937195
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 169 completed - Val AUC: 0.4843
[I 2025-08-22 14:24:29,126] Trial 169 finished with value: -0.4842788577079773 and parameters: {'dataset.max_walk_length': 33, 'dataset.num_walks': 114476, 'training.lr': 1.2013593991284026e-05, 'training.weight_decay': 0.0011604030092124574, 'training.batch_size': 64, 'training.gradient_clip_val': 1.8206789918463955, 'training.early_stopping_patience': 15, 'model.nhead_emb_combo': 6, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.48263486900894104, 'training.epochs': 30}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 170 hyperparameters:
  Walk length: 24, Num walks: 123,621
  LR: 2.53e-05, Batch size: 64
  Model: emb_dim=32, hidden_dim=16
  Transformer: 2 layers, 1 heads
  Epochs: 29, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.517
Metric val_auc_epoch improved by 0.030 >= min_delta = 0.0. New best score: 0.546
Metric val_auc_epoch improved by 0.009 >= min_delta = 0.0. New best score: 0.555
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.559
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.560
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.560
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.561
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.561
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.562
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.562
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.562
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.562
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.562
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.562
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.562
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.563
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.563
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.563
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.563
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.563
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.563
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.563
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.563
`Trainer.fit` stopped: `max_epochs=29` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_170-epoch=28-val_auc_epoch=0.5631.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_170-epoch=28-val_auc_epoch=0.5631.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5438745617866516
      val_auc_epoch         0.5630634427070618
      val_f1_epoch          0.5428650975227356
        val_loss            0.6884301900863647
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 170 completed - Val AUC: 0.5631
[I 2025-08-22 14:34:54,083] Trial 170 finished with value: -0.5630634427070618 and parameters: {'dataset.max_walk_length': 24, 'dataset.num_walks': 123621, 'training.lr': 2.5264875415115897e-05, 'training.weight_decay': 0.0007280727329365636, 'training.batch_size': 64, 'training.gradient_clip_val': 1.9353237615405703, 'training.early_stopping_patience': 14, 'model.nhead_emb_combo': 3, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.27969145234662174, 'training.epochs': 29}. Best is trial 1 with value: -0.6377121806144714.
🧹 Cleaning up old checkpoints and logs (keeping top 10)...
  Removed old checkpoint: trial_160-epoch=27-val_auc_epoch=0.5742.ckpt
  Removed old checkpoint: trial_159-epoch=04-val_auc_epoch=0.5647.ckpt
  Removed old checkpoint: trial_158-epoch=04-val_auc_epoch=0.5700.ckpt
  Removed old checkpoint: trial_157-epoch=28-val_auc_epoch=0.5685.ckpt
  Removed old checkpoint: trial_156-epoch=04-val_auc_epoch=0.5638.ckpt
  Removed old log dir: trial_160
  Removed old log dir: trial_159
  Removed old log dir: trial_158
  Removed old log dir: trial_157
  Removed old log dir: trial_156
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 171 hyperparameters:
  Walk length: 22, Num walks: 140,354
  LR: 1.93e-05, Batch size: 64
  Model: emb_dim=32, hidden_dim=16
  Transformer: 2 layers, 1 heads
  Epochs: 29, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.523
Metric val_auc_epoch improved by 0.019 >= min_delta = 0.0. New best score: 0.542
Metric val_auc_epoch improved by 0.011 >= min_delta = 0.0. New best score: 0.553
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.558
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.559
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.560
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.561
Monitored metric val_auc_epoch did not improve in the last 15 records. Best score: 0.561. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_171-epoch=06-val_auc_epoch=0.5607.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_171-epoch=06-val_auc_epoch=0.5607.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5403735041618347
      val_auc_epoch         0.5607012510299683
      val_f1_epoch          0.5340495109558105
        val_loss             0.687159538269043
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 171 completed - Val AUC: 0.5607
[I 2025-08-22 14:43:56,311] Trial 171 finished with value: -0.5607012510299683 and parameters: {'dataset.max_walk_length': 22, 'dataset.num_walks': 140354, 'training.lr': 1.9349820578103056e-05, 'training.weight_decay': 0.002791699288285813, 'training.batch_size': 64, 'training.gradient_clip_val': 1.7617116462771563, 'training.early_stopping_patience': 15, 'model.nhead_emb_combo': 3, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.5183999870318401, 'training.epochs': 29}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 172 hyperparameters:
  Walk length: 20, Num walks: 112,929
  LR: 2.97e-05, Batch size: 64
  Model: emb_dim=128, hidden_dim=64
  Transformer: 2 layers, 1 heads
  Epochs: 28, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.569
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.577
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.583
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.587
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.591
❌ Trial 172 failed: Trial was pruned at epoch 5.
[I 2025-08-22 14:46:00,945] Trial 172 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 20, 'dataset.num_walks': 112929, 'training.lr': 2.9735955641625355e-05, 'training.weight_decay': 0.003865515749542434, 'training.batch_size': 64, 'training.gradient_clip_val': 1.8725805914149207, 'training.early_stopping_patience': 15, 'model.nhead_emb_combo': 5, 'model.hidden_dim': 64, 'model.nlayers': 2, 'model.dropout': 0.49533805689245397, 'training.epochs': 28}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 173 hyperparameters:
  Walk length: 22, Num walks: 133,328
  LR: 1.52e-03, Batch size: 64
  Model: emb_dim=64, hidden_dim=16
  Transformer: 2 layers, 1 heads
  Epochs: 30, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.603
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.611
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.614
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.615
❌ Trial 173 failed: Trial was pruned at epoch 5.
[I 2025-08-22 14:48:28,310] Trial 173 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 22, 'dataset.num_walks': 133328, 'training.lr': 0.0015209549710592982, 'training.weight_decay': 0.0005193057314210995, 'training.batch_size': 64, 'training.gradient_clip_val': 1.2534869339207217, 'training.early_stopping_patience': 16, 'model.nhead_emb_combo': 4, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.4267380296315836, 'training.epochs': 30}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 174 hyperparameters:
  Walk length: 25, Num walks: 149,629
  LR: 2.34e-05, Batch size: 64
  Model: emb_dim=64, hidden_dim=16
  Transformer: 2 layers, 1 heads
  Epochs: 29, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.538
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.542
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.542
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.542
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.543
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.543
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.545
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.548
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.550
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.552
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.554
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.555
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.557
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.557
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.558
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.559
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.560
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.560
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.560
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.560
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.561
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.561
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.561
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.561
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.561
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.561
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.562
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.562
`Trainer.fit` stopped: `max_epochs=29` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_174-epoch=28-val_auc_epoch=0.5615.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_174-epoch=28-val_auc_epoch=0.5615.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5453792810440063
      val_auc_epoch         0.5615290403366089
      val_f1_epoch          0.5428406596183777
        val_loss            0.7127718925476074
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 174 completed - Val AUC: 0.5615
[I 2025-08-22 15:00:57,361] Trial 174 finished with value: -0.5615290403366089 and parameters: {'dataset.max_walk_length': 25, 'dataset.num_walks': 149629, 'training.lr': 2.339209916714972e-05, 'training.weight_decay': 0.00027457587579034275, 'training.batch_size': 64, 'training.gradient_clip_val': 0.8706421704807321, 'training.early_stopping_patience': 13, 'model.nhead_emb_combo': 4, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.4661748375227322, 'training.epochs': 29}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 175 hyperparameters:
  Walk length: 19, Num walks: 121,287
  LR: 3.78e-05, Batch size: 64
  Model: emb_dim=32, hidden_dim=16
  Transformer: 2 layers, 1 heads
  Epochs: 28, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.558
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.562
❌ Trial 175 failed: Trial was pruned at epoch 5.
[I 2025-08-22 15:03:09,149] Trial 175 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 19, 'dataset.num_walks': 121287, 'training.lr': 3.779869744496162e-05, 'training.weight_decay': 0.0014455189039537311, 'training.batch_size': 64, 'training.gradient_clip_val': 1.9015614067605544, 'training.early_stopping_patience': 14, 'model.nhead_emb_combo': 3, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.45614289132924607, 'training.epochs': 28}. Best is trial 1 with value: -0.6377121806144714.
🧹 Cleaning up old checkpoints and logs (keeping top 10)...
  Removed old checkpoint: trial_165-epoch=04-val_auc_epoch=0.5669.ckpt
  Removed old checkpoint: trial_164-epoch=28-val_auc_epoch=0.5609.ckpt
  Removed old checkpoint: trial_163-epoch=05-val_auc_epoch=0.5675.ckpt
  Removed old checkpoint: trial_162-epoch=16-val_auc_epoch=0.5511.ckpt
  Removed old checkpoint: trial_161-epoch=27-val_auc_epoch=0.5700.ckpt
  Removed old log dir: trial_165
  Removed old log dir: trial_164
  Removed old log dir: trial_163
  Removed old log dir: trial_162
  Removed old log dir: trial_161
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 176 hyperparameters:
  Walk length: 30, Num walks: 100,223
  LR: 3.18e-05, Batch size: 64
  Model: emb_dim=64, hidden_dim=4
  Transformer: 2 layers, 8 heads
  Epochs: 27, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.543
Metric val_auc_epoch improved by 0.017 >= min_delta = 0.0. New best score: 0.560
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.564
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.567
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.568
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.568
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.568
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.569
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.569
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.570
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.571
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.571
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.571
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.571
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.571
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.571
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.571
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.571
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.571
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.571
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.571
`Trainer.fit` stopped: `max_epochs=27` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_176-epoch=24-val_auc_epoch=0.5714.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_176-epoch=24-val_auc_epoch=0.5714.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5496596097946167
      val_auc_epoch         0.5714227557182312
      val_f1_epoch          0.5480945706367493
        val_loss            0.6950275301933289
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 176 completed - Val AUC: 0.5714
[I 2025-08-22 15:11:02,206] Trial 176 finished with value: -0.5714227557182312 and parameters: {'dataset.max_walk_length': 30, 'dataset.num_walks': 100223, 'training.lr': 3.175346268609169e-05, 'training.weight_decay': 0.002135267760024138, 'training.batch_size': 64, 'training.gradient_clip_val': 1.788575284062954, 'training.early_stopping_patience': 15, 'model.nhead_emb_combo': 21, 'model.hidden_dim': 4, 'model.nlayers': 2, 'model.dropout': 0.3958750412586822, 'training.epochs': 27}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 177 hyperparameters:
  Walk length: 30, Num walks: 109,885
  LR: 3.07e-05, Batch size: 64
  Model: emb_dim=16, hidden_dim=4
  Transformer: 2 layers, 16 heads
  Epochs: 27, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.495
Metric val_auc_epoch improved by 0.012 >= min_delta = 0.0. New best score: 0.508
Metric val_auc_epoch improved by 0.012 >= min_delta = 0.0. New best score: 0.519
Metric val_auc_epoch improved by 0.013 >= min_delta = 0.0. New best score: 0.532
Metric val_auc_epoch improved by 0.010 >= min_delta = 0.0. New best score: 0.542
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.548
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.552
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.553
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.554
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.555
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.555
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.556
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.556
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.556
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.556
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.556
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.556
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.556
`Trainer.fit` stopped: `max_epochs=27` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_177-epoch=19-val_auc_epoch=0.5562.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_177-epoch=19-val_auc_epoch=0.5562.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5380433201789856
      val_auc_epoch         0.5562314987182617
      val_f1_epoch          0.5379230976104736
        val_loss            0.6881573796272278
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 177 completed - Val AUC: 0.5562
[I 2025-08-22 15:19:52,318] Trial 177 finished with value: -0.5562314987182617 and parameters: {'dataset.max_walk_length': 30, 'dataset.num_walks': 109885, 'training.lr': 3.0656389762421095e-05, 'training.weight_decay': 0.0025721075273672325, 'training.batch_size': 64, 'training.gradient_clip_val': 0.4807020415145684, 'training.early_stopping_patience': 15, 'model.nhead_emb_combo': 23, 'model.hidden_dim': 4, 'model.nlayers': 2, 'model.dropout': 0.5079899956776486, 'training.epochs': 27}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 178 hyperparameters:
  Walk length: 27, Num walks: 100,384
  LR: 1.56e-05, Batch size: 64
  Model: emb_dim=32, hidden_dim=4
  Transformer: 2 layers, 8 heads
  Epochs: 26, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.518
Metric val_auc_epoch improved by 0.009 >= min_delta = 0.0. New best score: 0.527
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.534
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.540
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.544
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.547
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.548
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.549
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.550
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.550
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.550
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.550
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.550
`Trainer.fit` stopped: `max_epochs=26` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_178-epoch=13-val_auc_epoch=0.5504.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_178-epoch=13-val_auc_epoch=0.5504.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5345361232757568
      val_auc_epoch         0.5503716468811035
      val_f1_epoch          0.5343924164772034
        val_loss            0.6895771622657776
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 178 completed - Val AUC: 0.5504
[I 2025-08-22 15:27:23,858] Trial 178 finished with value: -0.5503716468811035 and parameters: {'dataset.max_walk_length': 27, 'dataset.num_walks': 100384, 'training.lr': 1.5560108751747174e-05, 'training.weight_decay': 0.0016879640771802872, 'training.batch_size': 64, 'training.gradient_clip_val': 1.8318107565870314, 'training.early_stopping_patience': 14, 'model.nhead_emb_combo': 20, 'model.hidden_dim': 4, 'model.nlayers': 2, 'model.dropout': 0.4103145562888936, 'training.epochs': 26}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 179 hyperparameters:
  Walk length: 32, Num walks: 108,846
  LR: 1.55e-02, Batch size: 64
  Model: emb_dim=128, hidden_dim=4
  Transformer: 2 layers, 8 heads
  Epochs: 28, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.509
Monitored metric val_auc_epoch did not improve in the last 16 records. Best score: 0.509. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_179-epoch=00-val_auc_epoch=0.5092.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_179-epoch=00-val_auc_epoch=0.5092.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch                 0.5
      val_auc_epoch         0.5091800689697266
      val_f1_epoch          0.3636126220226288
        val_loss            0.6931620240211487
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 179 completed - Val AUC: 0.5092
[I 2025-08-22 15:32:55,422] Trial 179 finished with value: -0.5091800689697266 and parameters: {'dataset.max_walk_length': 32, 'dataset.num_walks': 108846, 'training.lr': 0.015548967782967906, 'training.weight_decay': 0.0009924403492054972, 'training.batch_size': 64, 'training.gradient_clip_val': 1.7831081687374413, 'training.early_stopping_patience': 16, 'model.nhead_emb_combo': 22, 'model.hidden_dim': 4, 'model.nlayers': 2, 'model.dropout': 0.435425351655186, 'training.epochs': 28}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 180 hyperparameters:
  Walk length: 29, Num walks: 121,895
  LR: 2.70e-05, Batch size: 64
  Model: emb_dim=8, hidden_dim=4
  Transformer: 2 layers, 2 heads
  Epochs: 30, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.513
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.520
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.527
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.533
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.539
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.543
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.546
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.548
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.550
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.551
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.552
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.553
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.553
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.554
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.554
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.555
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.555
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.556
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.556
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.556
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.556
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.556
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.556
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.556
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.556
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.557
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.557
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.557
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.557
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.557
`Trainer.fit` stopped: `max_epochs=30` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_180-epoch=29-val_auc_epoch=0.5566.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_180-epoch=29-val_auc_epoch=0.5566.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5405969619750977
      val_auc_epoch         0.5565690398216248
      val_f1_epoch          0.5406627655029297
        val_loss            0.6887478828430176
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 180 completed - Val AUC: 0.5566
[I 2025-08-22 15:43:26,325] Trial 180 finished with value: -0.5565690398216248 and parameters: {'dataset.max_walk_length': 29, 'dataset.num_walks': 121895, 'training.lr': 2.6991242868270975e-05, 'training.weight_decay': 0.002092804608272053, 'training.batch_size': 64, 'training.gradient_clip_val': 0.2811833084371173, 'training.early_stopping_patience': 14, 'model.nhead_emb_combo': 7, 'model.hidden_dim': 4, 'model.nlayers': 2, 'model.dropout': 0.3696875049846096, 'training.epochs': 30}. Best is trial 1 with value: -0.6377121806144714.
🧹 Cleaning up old checkpoints and logs (keeping top 10)...
  Removed old checkpoint: trial_170-epoch=28-val_auc_epoch=0.5631.ckpt
  Removed old checkpoint: trial_169-epoch=29-val_auc_epoch=0.4843.ckpt
  Removed old checkpoint: trial_168-epoch=04-val_auc_epoch=0.5469.ckpt
  Removed old checkpoint: trial_167-epoch=26-val_auc_epoch=0.5006.ckpt
  Removed old checkpoint: trial_166-epoch=28-val_auc_epoch=0.5443.ckpt
  Removed old log dir: trial_170
  Removed old log dir: trial_169
  Removed old log dir: trial_168
  Removed old log dir: trial_167
  Removed old log dir: trial_166
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 181 hyperparameters:
  Walk length: 23, Num walks: 100,134
  LR: 3.35e-05, Batch size: 64
  Model: emb_dim=64, hidden_dim=64
  Transformer: 2 layers, 16 heads
  Epochs: 29, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.542
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.550
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.553
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.554
Monitored metric val_auc_epoch did not improve in the last 15 records. Best score: 0.554. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_181-epoch=03-val_auc_epoch=0.5536.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_181-epoch=03-val_auc_epoch=0.5536.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5371692776679993
      val_auc_epoch         0.5536155104637146
      val_f1_epoch          0.5360483527183533
        val_loss            0.6903168559074402
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 181 completed - Val AUC: 0.5536
[I 2025-08-22 15:48:57,772] Trial 181 finished with value: -0.5536155104637146 and parameters: {'dataset.max_walk_length': 23, 'dataset.num_walks': 100134, 'training.lr': 3.3468556627145464e-05, 'training.weight_decay': 0.004362377300769427, 'training.batch_size': 64, 'training.gradient_clip_val': 1.7418062197841955, 'training.early_stopping_patience': 15, 'model.nhead_emb_combo': 25, 'model.hidden_dim': 64, 'model.nlayers': 2, 'model.dropout': 0.4503342915026624, 'training.epochs': 29}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 182 hyperparameters:
  Walk length: 17, Num walks: 457,689
  LR: 5.03e-04, Batch size: 64
  Model: emb_dim=64, hidden_dim=16
  Transformer: 2 layers, 8 heads
  Epochs: 28, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.634
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.638
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.641
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.642
❌ Trial 182 failed: Trial was pruned at epoch 5.
[I 2025-08-22 15:56:38,246] Trial 182 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 17, 'dataset.num_walks': 457689, 'training.lr': 0.0005026839727935997, 'training.weight_decay': 0.000545632135092996, 'training.batch_size': 64, 'training.gradient_clip_val': 0.6489380174970747, 'training.early_stopping_patience': 15, 'model.nhead_emb_combo': 21, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.14273461863024076, 'training.epochs': 28}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 183 hyperparameters:
  Walk length: 21, Num walks: 132,209
  LR: 3.40e-04, Batch size: 256
  Model: emb_dim=64, hidden_dim=32
  Transformer: 2 layers, 1 heads
  Epochs: 29, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.565
Metric val_auc_epoch improved by 0.013 >= min_delta = 0.0. New best score: 0.578
Metric val_auc_epoch improved by 0.012 >= min_delta = 0.0. New best score: 0.590
Metric val_auc_epoch improved by 0.009 >= min_delta = 0.0. New best score: 0.599
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.604
❌ Trial 183 failed: Trial was pruned at epoch 5.
[I 2025-08-22 15:57:34,170] Trial 183 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 21, 'dataset.num_walks': 132209, 'training.lr': 0.00033993994080864647, 'training.weight_decay': 0.0007802415668108335, 'training.batch_size': 256, 'training.gradient_clip_val': 1.7977279719981887, 'training.early_stopping_patience': 16, 'model.nhead_emb_combo': 4, 'model.hidden_dim': 32, 'model.nlayers': 2, 'model.dropout': 0.5245724519006102, 'training.epochs': 29}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 184 hyperparameters:
  Walk length: 25, Num walks: 115,114
  LR: 2.01e-05, Batch size: 64
  Model: emb_dim=32, hidden_dim=128
  Transformer: 6 layers, 1 heads
  Epochs: 28, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.542
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.548
Monitored metric val_auc_epoch did not improve in the last 15 records. Best score: 0.548. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_184-epoch=01-val_auc_epoch=0.5484.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_184-epoch=01-val_auc_epoch=0.5484.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5345972776412964
      val_auc_epoch         0.5484213829040527
      val_f1_epoch          0.5346364974975586
        val_loss            0.6898037791252136
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 184 completed - Val AUC: 0.5484
[I 2025-08-22 16:05:59,757] Trial 184 finished with value: -0.5484213829040527 and parameters: {'dataset.max_walk_length': 25, 'dataset.num_walks': 115114, 'training.lr': 2.010727609598473e-05, 'training.weight_decay': 0.003025736664337901, 'training.batch_size': 64, 'training.gradient_clip_val': 1.8468141738665236, 'training.early_stopping_patience': 15, 'model.nhead_emb_combo': 3, 'model.hidden_dim': 128, 'model.nlayers': 6, 'model.dropout': 0.39931267869682274, 'training.epochs': 28}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 185 hyperparameters:
  Walk length: 19, Num walks: 147,485
  LR: 3.76e-05, Batch size: 64
  Model: emb_dim=64, hidden_dim=16
  Transformer: 4 layers, 4 heads
  Epochs: 29, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.560
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.561
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.563
❌ Trial 185 failed: Trial was pruned at epoch 5.
[I 2025-08-22 16:09:13,693] Trial 185 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 19, 'dataset.num_walks': 147485, 'training.lr': 3.757432076868534e-05, 'training.weight_decay': 0.0011184690237246134, 'training.batch_size': 64, 'training.gradient_clip_val': 1.3083247582007116, 'training.early_stopping_patience': 14, 'model.nhead_emb_combo': 16, 'model.hidden_dim': 16, 'model.nlayers': 4, 'model.dropout': 0.38383395194222886, 'training.epochs': 29}. Best is trial 1 with value: -0.6377121806144714.
🧹 Cleaning up old checkpoints and logs (keeping top 10)...
  Removed old checkpoint: trial_175-epoch=01-val_auc_epoch=0.5623.ckpt
  Removed old checkpoint: trial_174-epoch=28-val_auc_epoch=0.5615.ckpt
  Removed old checkpoint: trial_173-epoch=03-val_auc_epoch=0.6149.ckpt
  Removed old checkpoint: trial_172-epoch=04-val_auc_epoch=0.5909.ckpt
  Removed old checkpoint: trial_171-epoch=06-val_auc_epoch=0.5607.ckpt
  Removed old log dir: trial_175
  Removed old log dir: trial_174
  Removed old log dir: trial_173
  Removed old log dir: trial_172
  Removed old log dir: trial_171
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 186 hyperparameters:
  Walk length: 23, Num walks: 122,248
  LR: 2.60e-05, Batch size: 64
  Model: emb_dim=16, hidden_dim=16
  Transformer: 2 layers, 1 heads
  Epochs: 30, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.516
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.521
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.526
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.530
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.534
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.538
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.542
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.545
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.548
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.549
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.551
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.551
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.551
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.552
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.552
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.552
`Trainer.fit` stopped: `max_epochs=30` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_186-epoch=15-val_auc_epoch=0.5523.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_186-epoch=15-val_auc_epoch=0.5523.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch          0.535624623298645
      val_auc_epoch         0.5522728562355042
      val_f1_epoch          0.5329302549362183
        val_loss             0.688826858997345
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 186 completed - Val AUC: 0.5523
[I 2025-08-22 16:19:35,972] Trial 186 finished with value: -0.5522728562355042 and parameters: {'dataset.max_walk_length': 23, 'dataset.num_walks': 122248, 'training.lr': 2.6041488972934625e-05, 'training.weight_decay': 0.0018965886597456206, 'training.batch_size': 64, 'training.gradient_clip_val': 1.8934136410489533, 'training.early_stopping_patience': 15, 'model.nhead_emb_combo': 2, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.48327657694560583, 'training.epochs': 30}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 187 hyperparameters:
  Walk length: 28, Num walks: 110,023
  LR: 4.28e-05, Batch size: 64
  Model: emb_dim=16, hidden_dim=16
  Transformer: 2 layers, 8 heads
  Epochs: 27, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.521
Metric val_auc_epoch improved by 0.013 >= min_delta = 0.0. New best score: 0.533
Metric val_auc_epoch improved by 0.009 >= min_delta = 0.0. New best score: 0.542
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.547
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.550
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.552
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.553
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.553
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.554
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.555
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.555
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.555
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.555
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.555
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.556
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.556
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.556
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.556
`Trainer.fit` stopped: `max_epochs=27` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_187-epoch=19-val_auc_epoch=0.5555.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_187-epoch=19-val_auc_epoch=0.5555.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5381799340248108
      val_auc_epoch         0.5555279850959778
      val_f1_epoch          0.5379631519317627
        val_loss            0.6882725954055786
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 187 completed - Val AUC: 0.5555
[I 2025-08-22 16:28:22,069] Trial 187 finished with value: -0.5555279850959778 and parameters: {'dataset.max_walk_length': 28, 'dataset.num_walks': 110023, 'training.lr': 4.284345106699819e-05, 'training.weight_decay': 0.00031189420401465327, 'training.batch_size': 64, 'training.gradient_clip_val': 1.7540021603842473, 'training.early_stopping_patience': 15, 'model.nhead_emb_combo': 19, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.5002344279280809, 'training.epochs': 27}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 188 hyperparameters:
  Walk length: 31, Num walks: 159,401
  LR: 2.42e-04, Batch size: 128
  Model: emb_dim=128, hidden_dim=64
  Transformer: 2 layers, 1 heads
  Epochs: 30, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.597
Metric val_auc_epoch improved by 0.013 >= min_delta = 0.0. New best score: 0.610
Metric val_auc_epoch improved by 0.011 >= min_delta = 0.0. New best score: 0.621
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.621
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.625
❌ Trial 188 failed: Trial was pruned at epoch 5.
[I 2025-08-22 16:30:08,345] Trial 188 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 31, 'dataset.num_walks': 159401, 'training.lr': 0.00024233458848609089, 'training.weight_decay': 0.0006651785762561676, 'training.batch_size': 128, 'training.gradient_clip_val': 1.4609488026502144, 'training.early_stopping_patience': 14, 'model.nhead_emb_combo': 5, 'model.hidden_dim': 64, 'model.nlayers': 2, 'model.dropout': 0.36467060714211735, 'training.epochs': 30}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 189 hyperparameters:
  Walk length: 34, Num walks: 747,081
  LR: 2.31e-05, Batch size: 64
  Model: emb_dim=64, hidden_dim=16
  Transformer: 2 layers, 1 heads
  Epochs: 29, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.552
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.560
Metric val_auc_epoch improved by 0.012 >= min_delta = 0.0. New best score: 0.572
Metric val_auc_epoch improved by 0.010 >= min_delta = 0.0. New best score: 0.582
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.589
❌ Trial 189 failed: Trial was pruned at epoch 5.
[I 2025-08-22 16:44:02,561] Trial 189 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 34, 'dataset.num_walks': 747081, 'training.lr': 2.3105063364130603e-05, 'training.weight_decay': 0.004898956767131981, 'training.batch_size': 64, 'training.gradient_clip_val': 1.9253916324443368, 'training.early_stopping_patience': 17, 'model.nhead_emb_combo': 4, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.3427650847966823, 'training.epochs': 29}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 190 hyperparameters:
  Walk length: 18, Num walks: 136,826
  LR: 1.41e-05, Batch size: 64
  Model: emb_dim=16, hidden_dim=4
  Transformer: 2 layers, 1 heads
  Epochs: 26, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.509
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.518
Metric val_auc_epoch improved by 0.009 >= min_delta = 0.0. New best score: 0.527
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.535
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.540
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.543
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.545
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.546
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.547
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.548
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.548
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.548
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.549
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.549
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.549
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.549
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.549
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.549
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.549
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.549
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.549
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.549
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.549
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.549
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.549
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.549
`Trainer.fit` stopped: `max_epochs=26` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_190-epoch=25-val_auc_epoch=0.5494.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_190-epoch=25-val_auc_epoch=0.5494.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5349917411804199
      val_auc_epoch         0.5494273900985718
      val_f1_epoch          0.5347017645835876
        val_loss            0.6902589797973633
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 190 completed - Val AUC: 0.5494
[I 2025-08-22 16:54:01,839] Trial 190 finished with value: -0.5494273900985718 and parameters: {'dataset.max_walk_length': 18, 'dataset.num_walks': 136826, 'training.lr': 1.4054485705190422e-05, 'training.weight_decay': 0.00022577285362775993, 'training.batch_size': 64, 'training.gradient_clip_val': 1.817032164894276, 'training.early_stopping_patience': 10, 'model.nhead_emb_combo': 2, 'model.hidden_dim': 4, 'model.nlayers': 2, 'model.dropout': 0.3117232007301565, 'training.epochs': 26}. Best is trial 1 with value: -0.6377121806144714.
🧹 Cleaning up old checkpoints and logs (keeping top 10)...
  Removed old checkpoint: trial_180-epoch=29-val_auc_epoch=0.5566.ckpt
  Removed old checkpoint: trial_179-epoch=00-val_auc_epoch=0.5092.ckpt
  Removed old checkpoint: trial_178-epoch=13-val_auc_epoch=0.5504.ckpt
  Removed old checkpoint: trial_177-epoch=19-val_auc_epoch=0.5562.ckpt
  Removed old checkpoint: trial_176-epoch=24-val_auc_epoch=0.5714.ckpt
  Removed old log dir: trial_180
  Removed old log dir: trial_179
  Removed old log dir: trial_178
  Removed old log dir: trial_177
  Removed old log dir: trial_176
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 191 hyperparameters:
  Walk length: 22, Num walks: 115,986
  LR: 3.28e-05, Batch size: 64
  Model: emb_dim=32, hidden_dim=8
  Transformer: 2 layers, 1 heads
  Epochs: 15, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.514
Metric val_auc_epoch improved by 0.026 >= min_delta = 0.0. New best score: 0.540
Metric val_auc_epoch improved by 0.011 >= min_delta = 0.0. New best score: 0.551
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.553
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.553
`Trainer.fit` stopped: `max_epochs=15` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_191-epoch=04-val_auc_epoch=0.5535.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_191-epoch=04-val_auc_epoch=0.5535.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5377579927444458
      val_auc_epoch         0.5534873008728027
      val_f1_epoch          0.5358165502548218
        val_loss            0.6886931657791138
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 191 completed - Val AUC: 0.5535
[I 2025-08-22 16:59:03,290] Trial 191 finished with value: -0.5534873008728027 and parameters: {'dataset.max_walk_length': 22, 'dataset.num_walks': 115986, 'training.lr': 3.279130742972076e-05, 'training.weight_decay': 0.0033749561797639855, 'training.batch_size': 64, 'training.gradient_clip_val': 1.8710716955846693, 'training.early_stopping_patience': 15, 'model.nhead_emb_combo': 3, 'model.hidden_dim': 8, 'model.nlayers': 2, 'model.dropout': 0.47029819920236454, 'training.epochs': 15}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 192 hyperparameters:
  Walk length: 26, Num walks: 123,972
  LR: 4.05e-05, Batch size: 256
  Model: emb_dim=32, hidden_dim=16
  Transformer: 2 layers, 1 heads
  Epochs: 14, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.538
Metric val_auc_epoch improved by 0.013 >= min_delta = 0.0. New best score: 0.551
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.558
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.561
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.563
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.564
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.564
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.565
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.565
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.565
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.565
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.565
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.565
`Trainer.fit` stopped: `max_epochs=14` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_192-epoch=13-val_auc_epoch=0.5653.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_192-epoch=13-val_auc_epoch=0.5653.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5445795059204102
      val_auc_epoch         0.5652763843536377
      val_f1_epoch          0.5437626242637634
        val_loss            0.6857978701591492
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 192 completed - Val AUC: 0.5653
[I 2025-08-22 17:00:52,864] Trial 192 finished with value: -0.5652763843536377 and parameters: {'dataset.max_walk_length': 26, 'dataset.num_walks': 123972, 'training.lr': 4.050430323749746e-05, 'training.weight_decay': 0.0012930225707811509, 'training.batch_size': 256, 'training.gradient_clip_val': 1.4071036273240332, 'training.early_stopping_patience': 16, 'model.nhead_emb_combo': 3, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.3222880427247623, 'training.epochs': 14}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 193 hyperparameters:
  Walk length: 24, Num walks: 107,137
  LR: 1.84e-05, Batch size: 64
  Model: emb_dim=32, hidden_dim=8
  Transformer: 2 layers, 1 heads
  Epochs: 15, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.519
Metric val_auc_epoch improved by 0.012 >= min_delta = 0.0. New best score: 0.531
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.538
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.542
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.544
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.546
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.547
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.548
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.548
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.548
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.549
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.549
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.549
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.549
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.549
`Trainer.fit` stopped: `max_epochs=15` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_193-epoch=14-val_auc_epoch=0.5489.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_193-epoch=14-val_auc_epoch=0.5489.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5347595810890198
      val_auc_epoch         0.5488525629043579
      val_f1_epoch          0.5329220294952393
        val_loss            0.6897067427635193
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 193 completed - Val AUC: 0.5489
[I 2025-08-22 17:05:34,062] Trial 193 finished with value: -0.5488525629043579 and parameters: {'dataset.max_walk_length': 24, 'dataset.num_walks': 107137, 'training.lr': 1.840628489728555e-05, 'training.weight_decay': 0.0022907590613939167, 'training.batch_size': 64, 'training.gradient_clip_val': 1.9700102885163355, 'training.early_stopping_patience': 7, 'model.nhead_emb_combo': 3, 'model.hidden_dim': 8, 'model.nlayers': 2, 'model.dropout': 0.5929012715694669, 'training.epochs': 15}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 194 hyperparameters:
  Walk length: 47, Num walks: 130,217
  LR: 2.76e-05, Batch size: 64
  Model: emb_dim=128, hidden_dim=16
  Transformer: 2 layers, 1 heads
  Epochs: 16, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.533
Metric val_auc_epoch improved by 0.009 >= min_delta = 0.0. New best score: 0.542
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.545
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.546
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.548
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.550
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.554
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.557
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.559
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.559
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.561
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.562
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.562
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.562
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.562
`Trainer.fit` stopped: `max_epochs=16` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_194-epoch=15-val_auc_epoch=0.5624.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_194-epoch=15-val_auc_epoch=0.5624.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5431727170944214
      val_auc_epoch         0.5623770952224731
      val_f1_epoch           0.542101263999939
        val_loss            0.6966609954833984
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 194 completed - Val AUC: 0.5624
[I 2025-08-22 17:11:48,406] Trial 194 finished with value: -0.5623770952224731 and parameters: {'dataset.max_walk_length': 47, 'dataset.num_walks': 130217, 'training.lr': 2.758680688240435e-05, 'training.weight_decay': 0.005651244907892818, 'training.batch_size': 64, 'training.gradient_clip_val': 1.9320663433090923, 'training.early_stopping_patience': 15, 'model.nhead_emb_combo': 5, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.529055804841615, 'training.epochs': 16}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 195 hyperparameters:
  Walk length: 20, Num walks: 177,243
  LR: 3.39e-05, Batch size: 64
  Model: emb_dim=64, hidden_dim=16
  Transformer: 2 layers, 1 heads
  Epochs: 14, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.560
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.568
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.569
❌ Trial 195 failed: Trial was pruned at epoch 5.
[I 2025-08-22 17:14:58,802] Trial 195 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 20, 'dataset.num_walks': 177243, 'training.lr': 3.3927900062606066e-05, 'training.weight_decay': 0.00045860098584118243, 'training.batch_size': 64, 'training.gradient_clip_val': 1.856670927269455, 'training.early_stopping_patience': 14, 'model.nhead_emb_combo': 4, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.5136187721069256, 'training.epochs': 14}. Best is trial 1 with value: -0.6377121806144714.
🧹 Cleaning up old checkpoints and logs (keeping top 10)...
  Removed old checkpoint: trial_185-epoch=02-val_auc_epoch=0.5625.ckpt
  Removed old checkpoint: trial_184-epoch=01-val_auc_epoch=0.5484.ckpt
  Removed old checkpoint: trial_183-epoch=04-val_auc_epoch=0.6042.ckpt
  Removed old checkpoint: trial_182-epoch=04-val_auc_epoch=0.6416.ckpt
  Removed old checkpoint: trial_181-epoch=03-val_auc_epoch=0.5536.ckpt
  Removed old log dir: trial_185
  Removed old log dir: trial_184
  Removed old log dir: trial_183
  Removed old log dir: trial_182
  Removed old log dir: trial_181
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 196 hyperparameters:
  Walk length: 16, Num walks: 616,440
  LR: 2.22e-05, Batch size: 64
  Model: emb_dim=16, hidden_dim=64
  Transformer: 2 layers, 1 heads
  Epochs: 28, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.563
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.571
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.574
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.575
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.577
❌ Trial 196 failed: Trial was pruned at epoch 5.
[I 2025-08-22 17:25:14,996] Trial 196 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 16, 'dataset.num_walks': 616440, 'training.lr': 2.219372771225089e-05, 'training.weight_decay': 0.03945614577279472, 'training.batch_size': 64, 'training.gradient_clip_val': 1.908965285846751, 'training.early_stopping_patience': 7, 'model.nhead_emb_combo': 2, 'model.hidden_dim': 64, 'model.nlayers': 2, 'model.dropout': 0.42728092589778266, 'training.epochs': 28}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 197 hyperparameters:
  Walk length: 22, Num walks: 100,235
  LR: 4.13e-05, Batch size: 64
  Model: emb_dim=128, hidden_dim=8
  Transformer: 2 layers, 4 heads
  Epochs: 16, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.574
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.582
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.585
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.588
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.591
❌ Trial 197 failed: Trial was pruned at epoch 5.
[I 2025-08-22 17:27:04,190] Trial 197 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 22, 'dataset.num_walks': 100235, 'training.lr': 4.132167150657108e-05, 'training.weight_decay': 0.0009693883397522937, 'training.batch_size': 64, 'training.gradient_clip_val': 1.1008095114139542, 'training.early_stopping_patience': 16, 'model.nhead_emb_combo': 17, 'model.hidden_dim': 8, 'model.nlayers': 2, 'model.dropout': 0.49169720030262043, 'training.epochs': 16}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 198 hyperparameters:
  Walk length: 27, Num walks: 365,669
  LR: 1.63e-05, Batch size: 64
  Model: emb_dim=16, hidden_dim=16
  Transformer: 2 layers, 4 heads
  Epochs: 29, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.503
Metric val_auc_epoch improved by 0.015 >= min_delta = 0.0. New best score: 0.517
Metric val_auc_epoch improved by 0.021 >= min_delta = 0.0. New best score: 0.538
Metric val_auc_epoch improved by 0.018 >= min_delta = 0.0. New best score: 0.556
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.561
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.563
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.563
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.564
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.564
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.565
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.565
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.565
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.565
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.565
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.565
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.565
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.565
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.565
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.565
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.565
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.565
`Trainer.fit` stopped: `max_epochs=29` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_198-epoch=22-val_auc_epoch=0.5652.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_198-epoch=22-val_auc_epoch=0.5652.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5450043082237244
      val_auc_epoch         0.5652185678482056
      val_f1_epoch          0.5423306226730347
        val_loss            0.6876901388168335
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 198 completed - Val AUC: 0.5652
[I 2025-08-22 17:57:08,114] Trial 198 finished with value: -0.5652185678482056 and parameters: {'dataset.max_walk_length': 27, 'dataset.num_walks': 365669, 'training.lr': 1.633257056938025e-05, 'training.weight_decay': 0.00013926526670213815, 'training.batch_size': 64, 'training.gradient_clip_val': 1.7996651834010104, 'training.early_stopping_patience': 13, 'model.nhead_emb_combo': 14, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.6097813164627823, 'training.epochs': 29}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 199 hyperparameters:
  Walk length: 37, Num walks: 144,055
  LR: 3.42e-03, Batch size: 64
  Model: emb_dim=32, hidden_dim=16
  Transformer: 2 layers, 1 heads
  Epochs: 27, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.624
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.624
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.625
❌ Trial 199 failed: Trial was pruned at epoch 5.
[I 2025-08-22 17:59:51,635] Trial 199 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 37, 'dataset.num_walks': 144055, 'training.lr': 0.0034155448836343427, 'training.weight_decay': 0.0841989353765836, 'training.batch_size': 64, 'training.gradient_clip_val': 1.8792545259948814, 'training.early_stopping_patience': 12, 'model.nhead_emb_combo': 3, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.5476156060571569, 'training.epochs': 27}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 200 hyperparameters:
  Walk length: 24, Num walks: 194,758
  LR: 2.92e-05, Batch size: 64
  Model: emb_dim=128, hidden_dim=16
  Transformer: 2 layers, 1 heads
  Epochs: 29, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.560
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.562
Metric val_auc_epoch improved by 0.011 >= min_delta = 0.0. New best score: 0.573
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.581
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.587
❌ Trial 200 failed: Trial was pruned at epoch 5.
[I 2025-08-22 18:03:24,747] Trial 200 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 24, 'dataset.num_walks': 194758, 'training.lr': 2.9218431896382733e-05, 'training.weight_decay': 0.05736902221710343, 'training.batch_size': 64, 'training.gradient_clip_val': 1.9928955662246477, 'training.early_stopping_patience': 15, 'model.nhead_emb_combo': 5, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.475771266692967, 'training.epochs': 29}. Best is trial 1 with value: -0.6377121806144714.
🧹 Cleaning up old checkpoints and logs (keeping top 10)...
  Removed old checkpoint: trial_190-epoch=25-val_auc_epoch=0.5494.ckpt
  Removed old checkpoint: trial_189-epoch=04-val_auc_epoch=0.5894.ckpt
  Removed old checkpoint: trial_188-epoch=04-val_auc_epoch=0.6245.ckpt
  Removed old checkpoint: trial_187-epoch=19-val_auc_epoch=0.5555.ckpt
  Removed old checkpoint: trial_186-epoch=15-val_auc_epoch=0.5523.ckpt
  Removed old log dir: trial_190
  Removed old log dir: trial_189
  Removed old log dir: trial_188
  Removed old log dir: trial_187
  Removed old log dir: trial_186
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 201 hyperparameters:
  Walk length: 14, Num walks: 212,057
  LR: 4.93e-05, Batch size: 64
  Model: emb_dim=8, hidden_dim=16
  Transformer: 2 layers, 1 heads
  Epochs: 28, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.516
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.523
Metric val_auc_epoch improved by 0.010 >= min_delta = 0.0. New best score: 0.533
Metric val_auc_epoch improved by 0.011 >= min_delta = 0.0. New best score: 0.544
Metric val_auc_epoch improved by 0.012 >= min_delta = 0.0. New best score: 0.556
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.564
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.568
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.570
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.571
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.572
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.572. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_201-epoch=09-val_auc_epoch=0.5716.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_201-epoch=09-val_auc_epoch=0.5716.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5497798919677734
      val_auc_epoch          0.571556031703949
      val_f1_epoch          0.5492871403694153
        val_loss             0.68595290184021
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 201 completed - Val AUC: 0.5716
[I 2025-08-22 18:12:04,122] Trial 201 finished with value: -0.571556031703949 and parameters: {'dataset.max_walk_length': 14, 'dataset.num_walks': 212057, 'training.lr': 4.92698579972828e-05, 'training.weight_decay': 0.007683393907745039, 'training.batch_size': 64, 'training.gradient_clip_val': 1.8140776257285758, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 1, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.5803225152948104, 'training.epochs': 28}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 202 hyperparameters:
  Walk length: 77, Num walks: 292,895
  LR: 5.58e-05, Batch size: 64
  Model: emb_dim=8, hidden_dim=16
  Transformer: 2 layers, 1 heads
  Epochs: 28, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.525
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.532
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.534
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.536
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.536
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.537
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.537
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.537. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_202-epoch=06-val_auc_epoch=0.5368.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_202-epoch=06-val_auc_epoch=0.5368.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5248594284057617
      val_auc_epoch          0.536787748336792
      val_f1_epoch          0.5246560573577881
        val_loss            0.6919133067131042
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 202 completed - Val AUC: 0.5368
[I 2025-08-22 18:23:07,963] Trial 202 finished with value: -0.536787748336792 and parameters: {'dataset.max_walk_length': 77, 'dataset.num_walks': 292895, 'training.lr': 5.577304152494287e-05, 'training.weight_decay': 0.009847162769149672, 'training.batch_size': 64, 'training.gradient_clip_val': 1.8268739051313119, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 1, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.5814544621870079, 'training.epochs': 28}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 203 hyperparameters:
  Walk length: 17, Num walks: 211,964
  LR: 4.47e-05, Batch size: 64
  Model: emb_dim=8, hidden_dim=16
  Transformer: 2 layers, 8 heads
  Epochs: 28, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.516
Metric val_auc_epoch improved by 0.012 >= min_delta = 0.0. New best score: 0.528
Metric val_auc_epoch improved by 0.014 >= min_delta = 0.0. New best score: 0.542
Metric val_auc_epoch improved by 0.010 >= min_delta = 0.0. New best score: 0.552
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.558
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.560
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.562
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.563
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.564
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.565
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.565
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.566
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.566
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.567
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.567
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.567
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.567
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.567
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.568
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.568
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.568
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.568
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.568
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.568
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.568
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.568
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.568
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.568
`Trainer.fit` stopped: `max_epochs=28` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_203-epoch=27-val_auc_epoch=0.5678.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_203-epoch=27-val_auc_epoch=0.5678.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5468237996101379
      val_auc_epoch         0.5677876472473145
      val_f1_epoch          0.5469417572021484
        val_loss            0.6868523359298706
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 203 completed - Val AUC: 0.5678
[I 2025-08-22 18:39:22,626] Trial 203 finished with value: -0.5677876472473145 and parameters: {'dataset.max_walk_length': 17, 'dataset.num_walks': 211964, 'training.lr': 4.4673576428767664e-05, 'training.weight_decay': 0.0042735912422554884, 'training.batch_size': 64, 'training.gradient_clip_val': 0.9972799360451313, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 18, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.5612361232694721, 'training.epochs': 28}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 204 hyperparameters:
  Walk length: 17, Num walks: 234,015
  LR: 6.44e-05, Batch size: 64
  Model: emb_dim=16, hidden_dim=16
  Transformer: 2 layers, 8 heads
  Epochs: 28, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.521
Metric val_auc_epoch improved by 0.029 >= min_delta = 0.0. New best score: 0.550
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.556
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.557
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.557
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.557. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_204-epoch=04-val_auc_epoch=0.5574.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_204-epoch=04-val_auc_epoch=0.5574.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5392123460769653
      val_auc_epoch         0.5574060678482056
      val_f1_epoch          0.5375397801399231
        val_loss            0.6901274919509888
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 204 completed - Val AUC: 0.5574
[I 2025-08-22 18:46:07,711] Trial 204 finished with value: -0.5574060678482056 and parameters: {'dataset.max_walk_length': 17, 'dataset.num_walks': 234015, 'training.lr': 6.43516972358281e-05, 'training.weight_decay': 0.0032937098258133887, 'training.batch_size': 64, 'training.gradient_clip_val': 1.5120263742183302, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 19, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.559791707038268, 'training.epochs': 28}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 205 hyperparameters:
  Walk length: 14, Num walks: 206,968
  LR: 4.44e-05, Batch size: 64
  Model: emb_dim=128, hidden_dim=16
  Transformer: 2 layers, 4 heads
  Epochs: 27, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.582
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.590
Metric val_auc_epoch improved by 0.011 >= min_delta = 0.0. New best score: 0.601
Metric val_auc_epoch improved by 0.010 >= min_delta = 0.0. New best score: 0.611
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.617
❌ Trial 205 failed: Trial was pruned at epoch 5.
[I 2025-08-22 18:49:36,136] Trial 205 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 14, 'dataset.num_walks': 206968, 'training.lr': 4.437485768974806e-05, 'training.weight_decay': 0.006795015074346093, 'training.batch_size': 64, 'training.gradient_clip_val': 0.9831373731636568, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 17, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.5442640935999264, 'training.epochs': 27}. Best is trial 1 with value: -0.6377121806144714.
🧹 Cleaning up old checkpoints and logs (keeping top 10)...
  Removed old checkpoint: trial_195-epoch=02-val_auc_epoch=0.5688.ckpt
  Removed old checkpoint: trial_194-epoch=15-val_auc_epoch=0.5624.ckpt
  Removed old checkpoint: trial_193-epoch=14-val_auc_epoch=0.5489.ckpt
  Removed old checkpoint: trial_192-epoch=13-val_auc_epoch=0.5653.ckpt
  Removed old checkpoint: trial_191-epoch=04-val_auc_epoch=0.5535.ckpt
  Removed old log dir: trial_195
  Removed old log dir: trial_194
  Removed old log dir: trial_193
  Removed old log dir: trial_192
  Removed old log dir: trial_191
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 206 hyperparameters:
  Walk length: 16, Num walks: 266,039
  LR: 5.03e-05, Batch size: 64
  Model: emb_dim=32, hidden_dim=16
  Transformer: 2 layers, 4 heads
  Epochs: 28, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.560
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.565
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.565
❌ Trial 206 failed: Trial was pruned at epoch 5.
[I 2025-08-22 18:54:12,791] Trial 206 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 16, 'dataset.num_walks': 266039, 'training.lr': 5.033606522584245e-05, 'training.weight_decay': 0.004008996508390304, 'training.batch_size': 64, 'training.gradient_clip_val': 0.7618304042363608, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 15, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.5330978555780184, 'training.epochs': 28}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 207 hyperparameters:
  Walk length: 20, Num walks: 199,515
  LR: 1.51e-04, Batch size: 64
  Model: emb_dim=8, hidden_dim=16
  Transformer: 2 layers, 8 heads
  Epochs: 29, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.544
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.551
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.551. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_207-epoch=01-val_auc_epoch=0.5513.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_207-epoch=01-val_auc_epoch=0.5513.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5356206893920898
      val_auc_epoch         0.5512521862983704
      val_f1_epoch          0.5340805053710938
        val_loss            0.6895450353622437
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 207 completed - Val AUC: 0.5513
[I 2025-08-22 18:58:38,442] Trial 207 finished with value: -0.5512521862983704 and parameters: {'dataset.max_walk_length': 20, 'dataset.num_walks': 199515, 'training.lr': 0.00015084681762023782, 'training.weight_decay': 0.001512888820433281, 'training.batch_size': 64, 'training.gradient_clip_val': 1.7677926348726258, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 18, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.5031116202107062, 'training.epochs': 29}. Best is trial 1 with value: -0.6377121806144714.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 208 hyperparameters:
  Walk length: 84, Num walks: 222,360
  LR: 7.21e-04, Batch size: 64
  Model: emb_dim=32, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 28, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.549
Metric val_auc_epoch improved by 0.025 >= min_delta = 0.0. New best score: 0.574
Metric val_auc_epoch improved by 0.017 >= min_delta = 0.0. New best score: 0.590
Metric val_auc_epoch improved by 0.013 >= min_delta = 0.0. New best score: 0.603
Metric val_auc_epoch improved by 0.011 >= min_delta = 0.0. New best score: 0.614
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.622
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.625
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.630
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.634
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.635
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.635
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.636
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.638
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.639
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.639
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.639
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.639. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_208-epoch=19-val_auc_epoch=0.6391.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_208-epoch=19-val_auc_epoch=0.6391.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.6009341478347778
      val_auc_epoch         0.6390637159347534
      val_f1_epoch          0.5956357717514038
        val_loss            1.3610291481018066
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 208 completed - Val AUC: 0.6391
[I 2025-08-22 19:23:28,102] Trial 208 finished with value: -0.6390637159347534 and parameters: {'dataset.max_walk_length': 84, 'dataset.num_walks': 222360, 'training.lr': 0.0007207729485498136, 'training.weight_decay': 0.004946703017850352, 'training.batch_size': 64, 'training.gradient_clip_val': 1.0531176915435314, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 20, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.5649118299887371, 'training.epochs': 28}. Best is trial 208 with value: -0.6390637159347534.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 209 hyperparameters:
  Walk length: 13, Num walks: 229,964
  LR: 2.25e-04, Batch size: 64
  Model: emb_dim=128, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 28, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.562
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.565
Metric val_auc_epoch improved by 0.043 >= min_delta = 0.0. New best score: 0.608
Metric val_auc_epoch improved by 0.011 >= min_delta = 0.0. New best score: 0.619
❌ Trial 209 failed: Trial was pruned at epoch 5.
[I 2025-08-22 19:28:42,410] Trial 209 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 13, 'dataset.num_walks': 229964, 'training.lr': 0.00022501173319376948, 'training.weight_decay': 0.003944998101454783, 'training.batch_size': 64, 'training.gradient_clip_val': 0.8979301640211896, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 22, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.4577018718726713, 'training.epochs': 28}. Best is trial 208 with value: -0.6390637159347534.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 210 hyperparameters:
  Walk length: 60, Num walks: 248,521
  LR: 4.60e-03, Batch size: 64
  Model: emb_dim=8, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 27, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.533
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.534
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.535
Monitored metric val_auc_epoch did not improve in the last 6 records. Best score: 0.535. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_210-epoch=04-val_auc_epoch=0.5348.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_210-epoch=04-val_auc_epoch=0.5348.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5224767923355103
      val_auc_epoch         0.5348098874092102
      val_f1_epoch           0.520526647567749
        val_loss            0.7492291331291199
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 210 completed - Val AUC: 0.5348
[I 2025-08-22 19:40:37,980] Trial 210 finished with value: -0.5348098874092102 and parameters: {'dataset.max_walk_length': 60, 'dataset.num_walks': 248521, 'training.lr': 0.004600098508505966, 'training.weight_decay': 0.0050013827158825064, 'training.batch_size': 64, 'training.gradient_clip_val': 1.0192991813825727, 'training.early_stopping_patience': 6, 'model.nhead_emb_combo': 18, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.5542501736026276, 'training.epochs': 27}. Best is trial 208 with value: -0.6390637159347534.
🧹 Cleaning up old checkpoints and logs (keeping top 10)...
  Removed old checkpoint: trial_200-epoch=04-val_auc_epoch=0.5875.ckpt
  Removed old checkpoint: trial_199-epoch=03-val_auc_epoch=0.6247.ckpt
  Removed old checkpoint: trial_198-epoch=22-val_auc_epoch=0.5652.ckpt
  Removed old checkpoint: trial_197-epoch=04-val_auc_epoch=0.5911.ckpt
  Removed old checkpoint: trial_196-epoch=04-val_auc_epoch=0.5769.ckpt
  Removed old log dir: trial_200
  Removed old log dir: trial_199
  Removed old log dir: trial_198
  Removed old log dir: trial_197
  Removed old log dir: trial_196
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 211 hyperparameters:
  Walk length: 85, Num walks: 185,774
  LR: 9.33e-04, Batch size: 64
  Model: emb_dim=16, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 28, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.539
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.539
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.546
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.550
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.558
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.565
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.572
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.578
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.584
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.589
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.595
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.597
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.601
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.604
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.607
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.608
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.609
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.610
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.611
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.612
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.613
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.613
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.613
`Trainer.fit` stopped: `max_epochs=28` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_211-epoch=27-val_auc_epoch=0.6125.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_211-epoch=27-val_auc_epoch=0.6125.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch          0.579610288143158
      val_auc_epoch         0.6125340461730957
      val_f1_epoch          0.5778467655181885
        val_loss            0.7513702511787415
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 211 completed - Val AUC: 0.6125
[I 2025-08-22 20:10:52,114] Trial 211 finished with value: -0.6125340461730957 and parameters: {'dataset.max_walk_length': 85, 'dataset.num_walks': 185774, 'training.lr': 0.0009329606625351711, 'training.weight_decay': 0.002630331201692162, 'training.batch_size': 64, 'training.gradient_clip_val': 0.6013279937373869, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 19, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.5698748291843818, 'training.epochs': 28}. Best is trial 208 with value: -0.6390637159347534.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 212 hyperparameters:
  Walk length: 84, Num walks: 218,085
  LR: 7.60e-04, Batch size: 64
  Model: emb_dim=32, hidden_dim=16
  Transformer: 2 layers, 8 heads
  Epochs: 28, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.536
Metric val_auc_epoch improved by 0.021 >= min_delta = 0.0. New best score: 0.558
Metric val_auc_epoch improved by 0.020 >= min_delta = 0.0. New best score: 0.577
Metric val_auc_epoch improved by 0.009 >= min_delta = 0.0. New best score: 0.586
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.594
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.600
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.601
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.606
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.610
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.614
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.616
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.618
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.619
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.622
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.624
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.625
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.626
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.626
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.627
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.628
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.628
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.628. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_212-epoch=20-val_auc_epoch=0.6281.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_212-epoch=20-val_auc_epoch=0.6281.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5973916053771973
      val_auc_epoch         0.6280593872070312
      val_f1_epoch          0.5917167067527771
        val_loss            1.3637099266052246
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 212 completed - Val AUC: 0.6281
[I 2025-08-22 20:28:45,516] Trial 212 finished with value: -0.6280593872070312 and parameters: {'dataset.max_walk_length': 84, 'dataset.num_walks': 218085, 'training.lr': 0.0007595709409866898, 'training.weight_decay': 0.0024976108793733306, 'training.batch_size': 64, 'training.gradient_clip_val': 0.6383935212991609, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 20, 'model.hidden_dim': 16, 'model.nlayers': 2, 'model.dropout': 0.580564983467473, 'training.epochs': 28}. Best is trial 208 with value: -0.6390637159347534.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 213 hyperparameters:
  Walk length: 85, Num walks: 215,745
  LR: 3.03e-04, Batch size: 64
  Model: emb_dim=64, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 28, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.551
Metric val_auc_epoch improved by 0.011 >= min_delta = 0.0. New best score: 0.561
Metric val_auc_epoch improved by 0.022 >= min_delta = 0.0. New best score: 0.584
Metric val_auc_epoch improved by 0.012 >= min_delta = 0.0. New best score: 0.596
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.600
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.606
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.612
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.616
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.618
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.621
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.622
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.624
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.625
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.626
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.626
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.627
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.627
`Trainer.fit` stopped: `max_epochs=28` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_213-epoch=26-val_auc_epoch=0.6266.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_213-epoch=26-val_auc_epoch=0.6266.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5937855243682861
      val_auc_epoch         0.6266352534294128
      val_f1_epoch          0.5920279026031494
        val_loss            1.1172542572021484
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 213 completed - Val AUC: 0.6266
[I 2025-08-22 20:56:08,031] Trial 213 finished with value: -0.6266352534294128 and parameters: {'dataset.max_walk_length': 85, 'dataset.num_walks': 215745, 'training.lr': 0.000302975816408459, 'training.weight_decay': 0.003260962696978169, 'training.batch_size': 64, 'training.gradient_clip_val': 0.6048740485208325, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 21, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.5881630656314254, 'training.epochs': 28}. Best is trial 208 with value: -0.6390637159347534.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 214 hyperparameters:
  Walk length: 84, Num walks: 221,453
  LR: 7.95e-04, Batch size: 64
  Model: emb_dim=32, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 28, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.550
Metric val_auc_epoch improved by 0.020 >= min_delta = 0.0. New best score: 0.570
Metric val_auc_epoch improved by 0.025 >= min_delta = 0.0. New best score: 0.595
Metric val_auc_epoch improved by 0.009 >= min_delta = 0.0. New best score: 0.604
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.605
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.612
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.615
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.618
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.620
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.622
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.623
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.623. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_214-epoch=12-val_auc_epoch=0.6229.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_214-epoch=12-val_auc_epoch=0.6229.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5892112255096436
      val_auc_epoch         0.6228766441345215
      val_f1_epoch          0.5854821801185608
        val_loss            1.0870743989944458
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 214 completed - Val AUC: 0.6229
[I 2025-08-22 21:13:53,569] Trial 214 finished with value: -0.6228766441345215 and parameters: {'dataset.max_walk_length': 84, 'dataset.num_walks': 221453, 'training.lr': 0.0007949029049507154, 'training.weight_decay': 0.002844573412996048, 'training.batch_size': 64, 'training.gradient_clip_val': 0.5738205793793405, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 20, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.5874077607312175, 'training.epochs': 28}. Best is trial 208 with value: -0.6390637159347534.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 215 hyperparameters:
  Walk length: 83, Num walks: 217,040
  LR: 7.73e-04, Batch size: 64
  Model: emb_dim=64, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 27, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.536
Metric val_auc_epoch improved by 0.031 >= min_delta = 0.0. New best score: 0.566
Metric val_auc_epoch improved by 0.041 >= min_delta = 0.0. New best score: 0.608
Metric val_auc_epoch improved by 0.014 >= min_delta = 0.0. New best score: 0.622
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.628
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.631
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.633
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.633
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.639
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.639. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_215-epoch=08-val_auc_epoch=0.6391.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_215-epoch=08-val_auc_epoch=0.6391.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.6029962301254272
      val_auc_epoch         0.6391385197639465
      val_f1_epoch          0.5975730419158936
        val_loss            1.1715307235717773
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 215 completed - Val AUC: 0.6391
[I 2025-08-22 21:27:48,662] Trial 215 finished with value: -0.6391385197639465 and parameters: {'dataset.max_walk_length': 83, 'dataset.num_walks': 217040, 'training.lr': 0.0007725691293108694, 'training.weight_decay': 0.0027544634700189695, 'training.batch_size': 64, 'training.gradient_clip_val': 0.5517043191379128, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 21, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.589907674225925, 'training.epochs': 27}. Best is trial 215 with value: -0.6391385197639465.
🧹 Cleaning up old checkpoints and logs (keeping top 10)...
  Removed old checkpoint: trial_205-epoch=04-val_auc_epoch=0.6166.ckpt
  Removed old checkpoint: trial_204-epoch=04-val_auc_epoch=0.5574.ckpt
  Removed old checkpoint: trial_203-epoch=27-val_auc_epoch=0.5678.ckpt
  Removed old checkpoint: trial_202-epoch=06-val_auc_epoch=0.5368.ckpt
  Removed old checkpoint: trial_201-epoch=09-val_auc_epoch=0.5716.ckpt
  Removed old log dir: trial_205
  Removed old log dir: trial_204
  Removed old log dir: trial_203
  Removed old log dir: trial_202
  Removed old log dir: trial_201
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 216 hyperparameters:
  Walk length: 84, Num walks: 243,914
  LR: 7.15e-04, Batch size: 64
  Model: emb_dim=32, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 27, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.549
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.551
Metric val_auc_epoch improved by 0.029 >= min_delta = 0.0. New best score: 0.580
Metric val_auc_epoch improved by 0.021 >= min_delta = 0.0. New best score: 0.601
Metric val_auc_epoch improved by 0.017 >= min_delta = 0.0. New best score: 0.618
❌ Trial 216 failed: Trial was pruned at epoch 6.
[I 2025-08-22 21:35:39,003] Trial 216 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 84, 'dataset.num_walks': 243914, 'training.lr': 0.0007146258566349287, 'training.weight_decay': 0.002197436792765809, 'training.batch_size': 64, 'training.gradient_clip_val': 0.5839672454731111, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 20, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.5948201097621362, 'training.epochs': 27}. Best is trial 215 with value: -0.6391385197639465.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 217 hyperparameters:
  Walk length: 82, Num walks: 222,731
  LR: 1.09e-03, Batch size: 64
  Model: emb_dim=64, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 27, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.531
Metric val_auc_epoch improved by 0.032 >= min_delta = 0.0. New best score: 0.563
Metric val_auc_epoch improved by 0.027 >= min_delta = 0.0. New best score: 0.590
Metric val_auc_epoch improved by 0.010 >= min_delta = 0.0. New best score: 0.600
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.607
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.610
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.611
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.612
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.612
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.612. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_217-epoch=10-val_auc_epoch=0.6120.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_217-epoch=10-val_auc_epoch=0.6120.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5791089534759521
      val_auc_epoch         0.6119699478149414
      val_f1_epoch          0.5752929449081421
        val_loss             1.836412787437439
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 217 completed - Val AUC: 0.6120
[I 2025-08-22 21:51:43,217] Trial 217 finished with value: -0.6119699478149414 and parameters: {'dataset.max_walk_length': 82, 'dataset.num_walks': 222731, 'training.lr': 0.0010878574334999007, 'training.weight_decay': 0.0030862804335487215, 'training.batch_size': 64, 'training.gradient_clip_val': 0.5541944906931371, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 21, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6164479622163417, 'training.epochs': 27}. Best is trial 215 with value: -0.6391385197639465.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 218 hyperparameters:
  Walk length: 80, Num walks: 233,696
  LR: 1.14e-03, Batch size: 64
  Model: emb_dim=64, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 26, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.533
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.538
Metric val_auc_epoch improved by 0.041 >= min_delta = 0.0. New best score: 0.579
Metric val_auc_epoch improved by 0.025 >= min_delta = 0.0. New best score: 0.604
Metric val_auc_epoch improved by 0.012 >= min_delta = 0.0. New best score: 0.617
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.618
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.625
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.626
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.626. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_218-epoch=07-val_auc_epoch=0.6257.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_218-epoch=07-val_auc_epoch=0.6257.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch          0.588208794593811
      val_auc_epoch         0.6257302761077881
      val_f1_epoch           0.586435079574585
        val_loss            1.2373312711715698
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 218 completed - Val AUC: 0.6257
[I 2025-08-22 22:05:33,545] Trial 218 finished with value: -0.6257302761077881 and parameters: {'dataset.max_walk_length': 80, 'dataset.num_walks': 233696, 'training.lr': 0.0011358174218198457, 'training.weight_decay': 0.002857344972061855, 'training.batch_size': 64, 'training.gradient_clip_val': 0.5550754912771471, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 21, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6133546537289731, 'training.epochs': 26}. Best is trial 215 with value: -0.6391385197639465.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 219 hyperparameters:
  Walk length: 83, Num walks: 219,589
  LR: 1.20e-03, Batch size: 64
  Model: emb_dim=32, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 26, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.534
Metric val_auc_epoch improved by 0.012 >= min_delta = 0.0. New best score: 0.546
Metric val_auc_epoch improved by 0.044 >= min_delta = 0.0. New best score: 0.590
Metric val_auc_epoch improved by 0.019 >= min_delta = 0.0. New best score: 0.609
Metric val_auc_epoch improved by 0.014 >= min_delta = 0.0. New best score: 0.622
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.628
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.633
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.639
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.642
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.645
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.649
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.651
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.652
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.654
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.655
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.656
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.656. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_219-epoch=16-val_auc_epoch=0.6563.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_219-epoch=16-val_auc_epoch=0.6563.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.6072036027908325
      val_auc_epoch         0.6563096642494202
      val_f1_epoch          0.5929727554321289
        val_loss            0.8712694644927979
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 219 completed - Val AUC: 0.6563
[I 2025-08-22 22:26:58,420] Trial 219 finished with value: -0.6563096642494202 and parameters: {'dataset.max_walk_length': 83, 'dataset.num_walks': 219589, 'training.lr': 0.0011990397793339518, 'training.weight_decay': 0.0026821863636421073, 'training.batch_size': 64, 'training.gradient_clip_val': 0.5956847053697083, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 20, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6207573207736868, 'training.epochs': 26}. Best is trial 219 with value: -0.6563096642494202.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 220 hyperparameters:
  Walk length: 82, Num walks: 218,292
  LR: 1.02e-03, Batch size: 64
  Model: emb_dim=64, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 26, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.518
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.519
Metric val_auc_epoch improved by 0.032 >= min_delta = 0.0. New best score: 0.551
Metric val_auc_epoch improved by 0.028 >= min_delta = 0.0. New best score: 0.579
Metric val_auc_epoch improved by 0.010 >= min_delta = 0.0. New best score: 0.589
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.596
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.596
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.601
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.603
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.606
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.609
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.609. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_220-epoch=10-val_auc_epoch=0.6095.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_220-epoch=10-val_auc_epoch=0.6095.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5849645137786865
      val_auc_epoch         0.6094998717308044
      val_f1_epoch          0.5807094573974609
        val_loss            1.4572089910507202
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 220 completed - Val AUC: 0.6095
[I 2025-08-22 22:43:00,016] Trial 220 finished with value: -0.6094998717308044 and parameters: {'dataset.max_walk_length': 82, 'dataset.num_walks': 218292, 'training.lr': 0.001016400149701485, 'training.weight_decay': 0.002824797638876165, 'training.batch_size': 64, 'training.gradient_clip_val': 0.5630255765279523, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 21, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6132361253484968, 'training.epochs': 26}. Best is trial 219 with value: -0.6563096642494202.
🧹 Cleaning up old checkpoints and logs (keeping top 10)...
  Removed old checkpoint: trial_210-epoch=04-val_auc_epoch=0.5348.ckpt
  Removed old checkpoint: trial_209-epoch=03-val_auc_epoch=0.6190.ckpt
  Removed old checkpoint: trial_208-epoch=19-val_auc_epoch=0.6391.ckpt
  Removed old checkpoint: trial_207-epoch=01-val_auc_epoch=0.5513.ckpt
  Removed old checkpoint: trial_206-epoch=02-val_auc_epoch=0.5646.ckpt
  Removed old log dir: trial_210
  Removed old log dir: trial_209
  Removed old log dir: trial_208
  Removed old log dir: trial_207
  Removed old log dir: trial_206
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 221 hyperparameters:
  Walk length: 79, Num walks: 225,182
  LR: 8.21e-04, Batch size: 64
  Model: emb_dim=64, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 26, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.530
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.535
Metric val_auc_epoch improved by 0.073 >= min_delta = 0.0. New best score: 0.609
Metric val_auc_epoch improved by 0.017 >= min_delta = 0.0. New best score: 0.625
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.629
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.630
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.631
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.631. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_221-epoch=08-val_auc_epoch=0.6309.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_221-epoch=08-val_auc_epoch=0.6309.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch          0.598599910736084
      val_auc_epoch         0.6309078931808472
      val_f1_epoch          0.5887367725372314
        val_loss            1.2644143104553223
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 221 completed - Val AUC: 0.6309
[I 2025-08-22 22:57:23,815] Trial 221 finished with value: -0.6309078931808472 and parameters: {'dataset.max_walk_length': 79, 'dataset.num_walks': 225182, 'training.lr': 0.0008208829193542514, 'training.weight_decay': 0.0028876997375931125, 'training.batch_size': 64, 'training.gradient_clip_val': 0.5551782572745194, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 21, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6151759044335047, 'training.epochs': 26}. Best is trial 219 with value: -0.6563096642494202.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 222 hyperparameters:
  Walk length: 80, Num walks: 221,451
  LR: 1.09e-03, Batch size: 64
  Model: emb_dim=64, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 26, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.537
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.537
Metric val_auc_epoch improved by 0.026 >= min_delta = 0.0. New best score: 0.563
Metric val_auc_epoch improved by 0.050 >= min_delta = 0.0. New best score: 0.613
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.622
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.625
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.627
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.630
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.630. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_222-epoch=08-val_auc_epoch=0.6304.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_222-epoch=08-val_auc_epoch=0.6304.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch          0.602154016494751
      val_auc_epoch         0.6304216384887695
      val_f1_epoch           0.601165771484375
        val_loss             1.11202871799469
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 222 completed - Val AUC: 0.6304
[I 2025-08-22 23:11:38,576] Trial 222 finished with value: -0.6304216384887695 and parameters: {'dataset.max_walk_length': 80, 'dataset.num_walks': 221451, 'training.lr': 0.001093948090350528, 'training.weight_decay': 0.002768528550345684, 'training.batch_size': 64, 'training.gradient_clip_val': 0.556549495577711, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 21, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6179938107113793, 'training.epochs': 26}. Best is trial 219 with value: -0.6563096642494202.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 223 hyperparameters:
  Walk length: 80, Num walks: 223,049
  LR: 1.03e-03, Batch size: 64
  Model: emb_dim=64, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 26, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.536
Metric val_auc_epoch improved by 0.058 >= min_delta = 0.0. New best score: 0.594
Metric val_auc_epoch improved by 0.022 >= min_delta = 0.0. New best score: 0.616
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.620
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.622
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.625
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.625. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_223-epoch=06-val_auc_epoch=0.6253.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_223-epoch=06-val_auc_epoch=0.6253.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5903693437576294
      val_auc_epoch          0.625349223613739
      val_f1_epoch          0.5790901780128479
        val_loss             1.126272201538086
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 223 completed - Val AUC: 0.6253
[I 2025-08-22 23:24:05,368] Trial 223 finished with value: -0.625349223613739 and parameters: {'dataset.max_walk_length': 80, 'dataset.num_walks': 223049, 'training.lr': 0.0010327343537264106, 'training.weight_decay': 0.0027390977657048665, 'training.batch_size': 64, 'training.gradient_clip_val': 0.5591301354731385, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 21, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6081574761673626, 'training.epochs': 26}. Best is trial 219 with value: -0.6563096642494202.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 224 hyperparameters:
  Walk length: 80, Num walks: 227,148
  LR: 1.12e-03, Batch size: 64
  Model: emb_dim=64, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 26, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.534
Metric val_auc_epoch improved by 0.051 >= min_delta = 0.0. New best score: 0.585
Metric val_auc_epoch improved by 0.020 >= min_delta = 0.0. New best score: 0.604
Metric val_auc_epoch improved by 0.010 >= min_delta = 0.0. New best score: 0.614
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.616
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.619
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.620
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.620. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_224-epoch=08-val_auc_epoch=0.6199.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_224-epoch=08-val_auc_epoch=0.6199.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5909754037857056
      val_auc_epoch         0.6199275255203247
      val_f1_epoch          0.5871906876564026
        val_loss             1.326415777206421
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 224 completed - Val AUC: 0.6199
[I 2025-08-22 23:38:44,027] Trial 224 finished with value: -0.6199275255203247 and parameters: {'dataset.max_walk_length': 80, 'dataset.num_walks': 227148, 'training.lr': 0.0011164223011600669, 'training.weight_decay': 0.0030153851924825327, 'training.batch_size': 64, 'training.gradient_clip_val': 0.5755043540371904, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 21, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6184818616626031, 'training.epochs': 26}. Best is trial 219 with value: -0.6563096642494202.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 225 hyperparameters:
  Walk length: 79, Num walks: 223,185
  LR: 1.10e-03, Batch size: 64
  Model: emb_dim=64, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 26, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.528
Metric val_auc_epoch improved by 0.058 >= min_delta = 0.0. New best score: 0.586
Metric val_auc_epoch improved by 0.017 >= min_delta = 0.0. New best score: 0.603
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.610
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.615
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.620
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.622
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.622
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.622
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.622. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_225-epoch=10-val_auc_epoch=0.6222.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_225-epoch=10-val_auc_epoch=0.6222.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5892965793609619
      val_auc_epoch          0.62217116355896
      val_f1_epoch          0.5829726457595825
        val_loss            1.7262985706329346
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 225 completed - Val AUC: 0.6222
[I 2025-08-22 23:54:55,174] Trial 225 finished with value: -0.62217116355896 and parameters: {'dataset.max_walk_length': 79, 'dataset.num_walks': 223185, 'training.lr': 0.0010978765347555949, 'training.weight_decay': 0.003253582921661881, 'training.batch_size': 64, 'training.gradient_clip_val': 0.5714661457542165, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 21, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.618655115620726, 'training.epochs': 26}. Best is trial 219 with value: -0.6563096642494202.
🧹 Cleaning up old checkpoints and logs (keeping top 10)...
  Removed old checkpoint: trial_215-epoch=08-val_auc_epoch=0.6391.ckpt
  Removed old checkpoint: trial_214-epoch=12-val_auc_epoch=0.6229.ckpt
  Removed old checkpoint: trial_213-epoch=26-val_auc_epoch=0.6266.ckpt
  Removed old checkpoint: trial_212-epoch=20-val_auc_epoch=0.6281.ckpt
  Removed old checkpoint: trial_211-epoch=27-val_auc_epoch=0.6125.ckpt
  Removed old log dir: trial_215
  Removed old log dir: trial_214
  Removed old log dir: trial_213
  Removed old log dir: trial_212
  Removed old log dir: trial_211
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 226 hyperparameters:
  Walk length: 80, Num walks: 242,739
  LR: 1.20e-03, Batch size: 64
  Model: emb_dim=64, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 26, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.557
Metric val_auc_epoch improved by 0.052 >= min_delta = 0.0. New best score: 0.609
Metric val_auc_epoch improved by 0.015 >= min_delta = 0.0. New best score: 0.624
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.629
❌ Trial 226 failed: Trial was pruned at epoch 5.
[I 2025-08-23 00:01:50,636] Trial 226 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 80, 'dataset.num_walks': 242739, 'training.lr': 0.0011987965307103062, 'training.weight_decay': 0.00310485621285688, 'training.batch_size': 64, 'training.gradient_clip_val': 0.5619287629245096, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 21, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6177849290556606, 'training.epochs': 26}. Best is trial 219 with value: -0.6563096642494202.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 227 hyperparameters:
  Walk length: 83, Num walks: 224,809
  LR: 8.36e-04, Batch size: 64
  Model: emb_dim=128, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 25, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.530
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.531
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.531. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_227-epoch=01-val_auc_epoch=0.5307.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_227-epoch=01-val_auc_epoch=0.5307.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5199255347251892
      val_auc_epoch         0.5306544303894043
      val_f1_epoch          0.5163271427154541
        val_loss            0.7975924611091614
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 227 completed - Val AUC: 0.5307
[I 2025-08-23 00:10:01,599] Trial 227 finished with value: -0.5306544303894043 and parameters: {'dataset.max_walk_length': 83, 'dataset.num_walks': 224809, 'training.lr': 0.0008359102056073511, 'training.weight_decay': 0.002805724396042411, 'training.batch_size': 64, 'training.gradient_clip_val': 0.6237504756964278, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 22, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6225865641044238, 'training.epochs': 25}. Best is trial 219 with value: -0.6563096642494202.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 228 hyperparameters:
  Walk length: 85, Num walks: 261,123
  LR: 1.05e-03, Batch size: 64
  Model: emb_dim=64, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 26, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.530
Metric val_auc_epoch improved by 0.024 >= min_delta = 0.0. New best score: 0.554
Metric val_auc_epoch improved by 0.043 >= min_delta = 0.0. New best score: 0.597
Metric val_auc_epoch improved by 0.010 >= min_delta = 0.0. New best score: 0.607
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.608
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.611
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.611. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_228-epoch=06-val_auc_epoch=0.6108.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_228-epoch=06-val_auc_epoch=0.6108.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch          0.582868218421936
      val_auc_epoch         0.6107531785964966
      val_f1_epoch           0.581445038318634
        val_loss            1.2988197803497314
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 228 completed - Val AUC: 0.6108
[I 2025-08-23 00:24:52,677] Trial 228 finished with value: -0.6107531785964966 and parameters: {'dataset.max_walk_length': 85, 'dataset.num_walks': 261123, 'training.lr': 0.0010500146768155933, 'training.weight_decay': 0.002891882584547115, 'training.batch_size': 64, 'training.gradient_clip_val': 0.5282484352232037, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 21, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6042106601603054, 'training.epochs': 26}. Best is trial 219 with value: -0.6563096642494202.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 229 hyperparameters:
  Walk length: 85, Num walks: 277,151
  LR: 1.19e-03, Batch size: 64
  Model: emb_dim=64, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 26, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.544
Metric val_auc_epoch improved by 0.056 >= min_delta = 0.0. New best score: 0.600
Metric val_auc_epoch improved by 0.036 >= min_delta = 0.0. New best score: 0.636
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.643
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.649
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.656
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.656. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_229-epoch=06-val_auc_epoch=0.6563.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_229-epoch=06-val_auc_epoch=0.6563.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.6157498359680176
      val_auc_epoch         0.6563454866409302
      val_f1_epoch          0.6145455837249756
        val_loss            1.3339431285858154
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 229 completed - Val AUC: 0.6563
[I 2025-08-23 00:40:36,800] Trial 229 finished with value: -0.6563454866409302 and parameters: {'dataset.max_walk_length': 85, 'dataset.num_walks': 277151, 'training.lr': 0.0011876925156916666, 'training.weight_decay': 0.0033199855323530303, 'training.batch_size': 64, 'training.gradient_clip_val': 0.5353917183461155, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 21, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6142171549657814, 'training.epochs': 26}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 230 hyperparameters:
  Walk length: 86, Num walks: 269,124
  LR: 1.03e-03, Batch size: 64
  Model: emb_dim=32, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 26, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.525
Metric val_auc_epoch improved by 0.018 >= min_delta = 0.0. New best score: 0.543
Metric val_auc_epoch improved by 0.034 >= min_delta = 0.0. New best score: 0.577
Metric val_auc_epoch improved by 0.011 >= min_delta = 0.0. New best score: 0.588
Metric val_auc_epoch improved by 0.012 >= min_delta = 0.0. New best score: 0.600
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.602
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.608
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.614
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.617
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.619
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.620
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.621
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.621. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_230-epoch=11-val_auc_epoch=0.6212.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_230-epoch=11-val_auc_epoch=0.6212.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5823050737380981
      val_auc_epoch         0.6212034225463867
      val_f1_epoch          0.5746064186096191
        val_loss            1.1521689891815186
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 230 completed - Val AUC: 0.6212
[I 2025-08-23 01:01:22,078] Trial 230 finished with value: -0.6212034225463867 and parameters: {'dataset.max_walk_length': 86, 'dataset.num_walks': 269124, 'training.lr': 0.0010348197348329315, 'training.weight_decay': 0.0027969139770632322, 'training.batch_size': 64, 'training.gradient_clip_val': 0.5477863749046344, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 20, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.60657512943552, 'training.epochs': 26}. Best is trial 229 with value: -0.6563454866409302.
🧹 Cleaning up old checkpoints and logs (keeping top 10)...
  Removed old checkpoint: trial_220-epoch=10-val_auc_epoch=0.6095.ckpt
  Removed old checkpoint: trial_219-epoch=16-val_auc_epoch=0.6563.ckpt
  Removed old checkpoint: trial_218-epoch=07-val_auc_epoch=0.6257.ckpt
  Removed old checkpoint: trial_217-epoch=10-val_auc_epoch=0.6120.ckpt
  Removed old checkpoint: trial_216-epoch=05-val_auc_epoch=0.6182.ckpt
  Removed old log dir: trial_220
  Removed old log dir: trial_219
  Removed old log dir: trial_218
  Removed old log dir: trial_217
  Removed old log dir: trial_216
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 231 hyperparameters:
  Walk length: 85, Num walks: 266,435
  LR: 9.81e-04, Batch size: 64
  Model: emb_dim=32, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 26, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.537
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.544
Metric val_auc_epoch improved by 0.011 >= min_delta = 0.0. New best score: 0.554
Metric val_auc_epoch improved by 0.038 >= min_delta = 0.0. New best score: 0.592
Metric val_auc_epoch improved by 0.017 >= min_delta = 0.0. New best score: 0.609
Metric val_auc_epoch improved by 0.012 >= min_delta = 0.0. New best score: 0.622
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.627
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.632
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.636
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.639
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.644
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.645
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.645
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.647
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.647
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.647. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_231-epoch=15-val_auc_epoch=0.6474.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_231-epoch=15-val_auc_epoch=0.6474.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.6101759672164917
      val_auc_epoch         0.6474412679672241
      val_f1_epoch          0.6009532809257507
        val_loss            0.8069466352462769
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 231 completed - Val AUC: 0.6474
[I 2025-08-23 01:26:25,146] Trial 231 finished with value: -0.6474412679672241 and parameters: {'dataset.max_walk_length': 85, 'dataset.num_walks': 266435, 'training.lr': 0.0009806988801613803, 'training.weight_decay': 0.0027195683961095322, 'training.batch_size': 64, 'training.gradient_clip_val': 0.5204106298638991, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 20, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6082329158609546, 'training.epochs': 26}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 232 hyperparameters:
  Walk length: 85, Num walks: 263,992
  LR: 1.04e-03, Batch size: 64
  Model: emb_dim=64, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 26, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.525
Metric val_auc_epoch improved by 0.062 >= min_delta = 0.0. New best score: 0.588
Metric val_auc_epoch improved by 0.021 >= min_delta = 0.0. New best score: 0.609
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.613
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.616
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.616
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.618
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.624
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.624
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.625
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.626
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.626. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_232-epoch=12-val_auc_epoch=0.6258.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_232-epoch=12-val_auc_epoch=0.6258.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch          0.600925087928772
      val_auc_epoch         0.6258333921432495
      val_f1_epoch          0.5900540947914124
        val_loss             2.373103141784668
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 232 completed - Val AUC: 0.6258
[I 2025-08-23 01:48:14,550] Trial 232 finished with value: -0.6258333921432495 and parameters: {'dataset.max_walk_length': 85, 'dataset.num_walks': 263992, 'training.lr': 0.001035161555251635, 'training.weight_decay': 0.0028656824564775897, 'training.batch_size': 64, 'training.gradient_clip_val': 0.542429763132455, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 21, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6070174559717628, 'training.epochs': 26}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 233 hyperparameters:
  Walk length: 85, Num walks: 266,647
  LR: 1.06e-03, Batch size: 64
  Model: emb_dim=64, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 26, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.518
Metric val_auc_epoch improved by 0.039 >= min_delta = 0.0. New best score: 0.557
Metric val_auc_epoch improved by 0.034 >= min_delta = 0.0. New best score: 0.591
Metric val_auc_epoch improved by 0.016 >= min_delta = 0.0. New best score: 0.608
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.608
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.609
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.612
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.616
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.617
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.617. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_233-epoch=10-val_auc_epoch=0.6166.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_233-epoch=10-val_auc_epoch=0.6166.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5812676548957825
      val_auc_epoch          0.616557776927948
      val_f1_epoch          0.5759732127189636
        val_loss            1.8332945108413696
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 233 completed - Val AUC: 0.6166
[I 2025-08-23 02:07:52,846] Trial 233 finished with value: -0.616557776927948 and parameters: {'dataset.max_walk_length': 85, 'dataset.num_walks': 266647, 'training.lr': 0.0010648044803514129, 'training.weight_decay': 0.0029367957280965365, 'training.batch_size': 64, 'training.gradient_clip_val': 0.5459109416027758, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 21, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6072649167103183, 'training.epochs': 26}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 234 hyperparameters:
  Walk length: 86, Num walks: 272,671
  LR: 1.03e-03, Batch size: 64
  Model: emb_dim=64, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 26, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.537
Metric val_auc_epoch improved by 0.065 >= min_delta = 0.0. New best score: 0.602
Metric val_auc_epoch improved by 0.017 >= min_delta = 0.0. New best score: 0.619
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.623
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.625
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.625. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_234-epoch=04-val_auc_epoch=0.6251.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_234-epoch=04-val_auc_epoch=0.6251.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5906296968460083
      val_auc_epoch         0.6251075863838196
      val_f1_epoch          0.5868121385574341
        val_loss             1.017259955406189
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 234 completed - Val AUC: 0.6251
[I 2025-08-23 02:21:06,053] Trial 234 finished with value: -0.6251075863838196 and parameters: {'dataset.max_walk_length': 86, 'dataset.num_walks': 272671, 'training.lr': 0.0010310654700622609, 'training.weight_decay': 0.0028281234760937413, 'training.batch_size': 64, 'training.gradient_clip_val': 0.5244397985395197, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 21, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6132815588374065, 'training.epochs': 26}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 235 hyperparameters:
  Walk length: 85, Num walks: 267,205
  LR: 1.05e-03, Batch size: 64
  Model: emb_dim=64, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 26, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.542
Metric val_auc_epoch improved by 0.058 >= min_delta = 0.0. New best score: 0.600
Metric val_auc_epoch improved by 0.009 >= min_delta = 0.0. New best score: 0.609
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.611
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.612
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.616
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.616. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_235-epoch=07-val_auc_epoch=0.6156.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_235-epoch=07-val_auc_epoch=0.6156.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5818456411361694
      val_auc_epoch         0.6156224012374878
      val_f1_epoch          0.5769329071044922
        val_loss            1.3628413677215576
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 235 completed - Val AUC: 0.6156
[I 2025-08-23 02:37:29,198] Trial 235 finished with value: -0.6156224012374878 and parameters: {'dataset.max_walk_length': 85, 'dataset.num_walks': 267205, 'training.lr': 0.0010487008117660546, 'training.weight_decay': 0.002734590820126782, 'training.batch_size': 64, 'training.gradient_clip_val': 0.5351813416085731, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 21, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.611543044272828, 'training.epochs': 26}. Best is trial 229 with value: -0.6563454866409302.
🧹 Cleaning up old checkpoints and logs (keeping top 10)...
  Removed old checkpoint: trial_225-epoch=10-val_auc_epoch=0.6222.ckpt
  Removed old checkpoint: trial_224-epoch=08-val_auc_epoch=0.6199.ckpt
  Removed old checkpoint: trial_223-epoch=06-val_auc_epoch=0.6253.ckpt
  Removed old checkpoint: trial_222-epoch=08-val_auc_epoch=0.6304.ckpt
  Removed old checkpoint: trial_221-epoch=08-val_auc_epoch=0.6309.ckpt
  Removed old log dir: trial_225
  Removed old log dir: trial_224
  Removed old log dir: trial_223
  Removed old log dir: trial_222
  Removed old log dir: trial_221
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 236 hyperparameters:
  Walk length: 86, Num walks: 275,276
  LR: 1.03e-03, Batch size: 64
  Model: emb_dim=64, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 26, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.523
Metric val_auc_epoch improved by 0.057 >= min_delta = 0.0. New best score: 0.581
Metric val_auc_epoch improved by 0.023 >= min_delta = 0.0. New best score: 0.603
Metric val_auc_epoch improved by 0.009 >= min_delta = 0.0. New best score: 0.613
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.618
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.618. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_236-epoch=04-val_auc_epoch=0.6179.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_236-epoch=04-val_auc_epoch=0.6179.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5832617282867432
      val_auc_epoch         0.6178821325302124
      val_f1_epoch          0.5763960480690002
        val_loss            0.9278169870376587
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 236 completed - Val AUC: 0.6179
[I 2025-08-23 02:50:45,518] Trial 236 finished with value: -0.6178821325302124 and parameters: {'dataset.max_walk_length': 86, 'dataset.num_walks': 275276, 'training.lr': 0.0010277022949445925, 'training.weight_decay': 0.002835253299865295, 'training.batch_size': 64, 'training.gradient_clip_val': 0.5365778133362669, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 21, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6086008966444768, 'training.epochs': 26}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 237 hyperparameters:
  Walk length: 87, Num walks: 266,556
  LR: 1.05e-03, Batch size: 64
  Model: emb_dim=32, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 26, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.542
Metric val_auc_epoch improved by 0.019 >= min_delta = 0.0. New best score: 0.561
Metric val_auc_epoch improved by 0.027 >= min_delta = 0.0. New best score: 0.588
Metric val_auc_epoch improved by 0.013 >= min_delta = 0.0. New best score: 0.602
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.609
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.614
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.616
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.618
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.620
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.622
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.622. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_237-epoch=11-val_auc_epoch=0.6216.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_237-epoch=11-val_auc_epoch=0.6216.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5891255140304565
      val_auc_epoch         0.6216483116149902
      val_f1_epoch          0.5874191522598267
        val_loss             0.872560977935791
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 237 completed - Val AUC: 0.6216
[I 2025-08-23 03:11:20,640] Trial 237 finished with value: -0.6216483116149902 and parameters: {'dataset.max_walk_length': 87, 'dataset.num_walks': 266556, 'training.lr': 0.001049272668292614, 'training.weight_decay': 0.0027958232452370926, 'training.batch_size': 64, 'training.gradient_clip_val': 0.5179423056048191, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 20, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6048321994299137, 'training.epochs': 26}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 238 hyperparameters:
  Walk length: 88, Num walks: 288,954
  LR: 1.20e-03, Batch size: 64
  Model: emb_dim=32, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 25, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.535
Metric val_auc_epoch improved by 0.010 >= min_delta = 0.0. New best score: 0.545
Metric val_auc_epoch improved by 0.028 >= min_delta = 0.0. New best score: 0.573
Metric val_auc_epoch improved by 0.017 >= min_delta = 0.0. New best score: 0.590
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.594
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.599
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.607
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.610
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.611
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.614
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.618
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.618. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_238-epoch=11-val_auc_epoch=0.6183.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_238-epoch=11-val_auc_epoch=0.6183.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5901552438735962
      val_auc_epoch          0.618255615234375
      val_f1_epoch           0.588902473449707
        val_loss            0.7365281581878662
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 238 completed - Val AUC: 0.6183
[I 2025-08-23 03:33:46,523] Trial 238 finished with value: -0.618255615234375 and parameters: {'dataset.max_walk_length': 88, 'dataset.num_walks': 288954, 'training.lr': 0.001201453092644754, 'training.weight_decay': 0.0023481716472643684, 'training.batch_size': 64, 'training.gradient_clip_val': 0.5090167087127556, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 20, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6292572221377849, 'training.epochs': 25}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 239 hyperparameters:
  Walk length: 88, Num walks: 280,858
  LR: 1.47e-03, Batch size: 64
  Model: emb_dim=32, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 25, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.551
Metric val_auc_epoch improved by 0.027 >= min_delta = 0.0. New best score: 0.579
Metric val_auc_epoch improved by 0.023 >= min_delta = 0.0. New best score: 0.602
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.611
Metric val_auc_epoch improved by 0.009 >= min_delta = 0.0. New best score: 0.620
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.621
❌ Trial 239 failed: Trial was pruned at epoch 6.
[I 2025-08-23 03:43:02,439] Trial 239 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 88, 'dataset.num_walks': 280858, 'training.lr': 0.0014703653277104362, 'training.weight_decay': 0.002334165447486569, 'training.batch_size': 64, 'training.gradient_clip_val': 0.517804406110791, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 20, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6306522073520456, 'training.epochs': 25}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 240 hyperparameters:
  Walk length: 86, Num walks: 275,089
  LR: 8.75e-04, Batch size: 64
  Model: emb_dim=32, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 25, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.556
Metric val_auc_epoch improved by 0.020 >= min_delta = 0.0. New best score: 0.575
Metric val_auc_epoch improved by 0.021 >= min_delta = 0.0. New best score: 0.596
Metric val_auc_epoch improved by 0.015 >= min_delta = 0.0. New best score: 0.611
❌ Trial 240 failed: Trial was pruned at epoch 6.
[I 2025-08-23 03:52:04,345] Trial 240 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 86, 'dataset.num_walks': 275089, 'training.lr': 0.0008753192135549737, 'training.weight_decay': 0.0018924594911917708, 'training.batch_size': 64, 'training.gradient_clip_val': 0.48539427927288015, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 20, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6022562983062258, 'training.epochs': 25}. Best is trial 229 with value: -0.6563454866409302.
🧹 Cleaning up old checkpoints and logs (keeping top 10)...
  Removed old checkpoint: trial_230-epoch=11-val_auc_epoch=0.6212.ckpt
  Removed old checkpoint: trial_229-epoch=06-val_auc_epoch=0.6563.ckpt
  Removed old checkpoint: trial_228-epoch=06-val_auc_epoch=0.6108.ckpt
  Removed old checkpoint: trial_227-epoch=01-val_auc_epoch=0.5307.ckpt
  Removed old checkpoint: trial_226-epoch=03-val_auc_epoch=0.6293.ckpt
  Removed old log dir: trial_230
  Removed old log dir: trial_229
  Removed old log dir: trial_228
  Removed old log dir: trial_227
  Removed old log dir: trial_226
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 241 hyperparameters:
  Walk length: 79, Num walks: 297,029
  LR: 1.19e-03, Batch size: 64
  Model: emb_dim=64, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 26, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.531
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.531. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_241-epoch=00-val_auc_epoch=0.5309.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_241-epoch=00-val_auc_epoch=0.5309.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5251228213310242
      val_auc_epoch         0.5309238433837891
      val_f1_epoch           0.525165855884552
        val_loss            0.7615460753440857
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 241 completed - Val AUC: 0.5309
[I 2025-08-23 04:00:56,849] Trial 241 finished with value: -0.5309238433837891 and parameters: {'dataset.max_walk_length': 79, 'dataset.num_walks': 297029, 'training.lr': 0.001186337356735398, 'training.weight_decay': 0.0034467810258657374, 'training.batch_size': 64, 'training.gradient_clip_val': 0.55113725129472, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 21, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6202102345105125, 'training.epochs': 26}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 242 hyperparameters:
  Walk length: 81, Num walks: 257,388
  LR: 1.03e-03, Batch size: 64
  Model: emb_dim=128, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 26, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.537
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.539
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.541
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.541. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_242-epoch=05-val_auc_epoch=0.5408.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_242-epoch=05-val_auc_epoch=0.5408.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5245564579963684
      val_auc_epoch         0.5407998561859131
      val_f1_epoch          0.5134627819061279
        val_loss            0.8012797832489014
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 242 completed - Val AUC: 0.5408
[I 2025-08-23 04:14:51,685] Trial 242 finished with value: -0.5407998561859131 and parameters: {'dataset.max_walk_length': 81, 'dataset.num_walks': 257388, 'training.lr': 0.0010251138330786113, 'training.weight_decay': 0.0027206463199648382, 'training.batch_size': 64, 'training.gradient_clip_val': 0.6098118848844539, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 22, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6305751068461629, 'training.epochs': 26}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 243 hyperparameters:
  Walk length: 84, Num walks: 309,770
  LR: 7.24e-04, Batch size: 64
  Model: emb_dim=64, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 25, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.525
Metric val_auc_epoch improved by 0.049 >= min_delta = 0.0. New best score: 0.574
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.578
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.583
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.583
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.584
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.584. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_243-epoch=07-val_auc_epoch=0.5839.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_243-epoch=07-val_auc_epoch=0.5839.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5611892938613892
      val_auc_epoch         0.5839360952377319
      val_f1_epoch          0.5536870956420898
        val_loss            1.3254973888397217
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 243 completed - Val AUC: 0.5839
[I 2025-08-23 04:33:47,096] Trial 243 finished with value: -0.5839360952377319 and parameters: {'dataset.max_walk_length': 84, 'dataset.num_walks': 309770, 'training.lr': 0.000723993524257283, 'training.weight_decay': 0.0035922669392717084, 'training.batch_size': 64, 'training.gradient_clip_val': 0.5184011102085225, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 21, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6134198786116296, 'training.epochs': 25}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 244 hyperparameters:
  Walk length: 87, Num walks: 274,064
  LR: 1.25e-03, Batch size: 64
  Model: emb_dim=32, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 24, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.537
Metric val_auc_epoch improved by 0.043 >= min_delta = 0.0. New best score: 0.580
Metric val_auc_epoch improved by 0.021 >= min_delta = 0.0. New best score: 0.601
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.608
Metric val_auc_epoch improved by 0.010 >= min_delta = 0.0. New best score: 0.618
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.619
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.621
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.622
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.622. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_244-epoch=07-val_auc_epoch=0.6224.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_244-epoch=07-val_auc_epoch=0.6224.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5890538692474365
      val_auc_epoch          0.62238609790802
      val_f1_epoch          0.5858167409896851
        val_loss            0.7826169729232788
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 244 completed - Val AUC: 0.6224
[I 2025-08-23 04:50:17,889] Trial 244 finished with value: -0.62238609790802 and parameters: {'dataset.max_walk_length': 87, 'dataset.num_walks': 274064, 'training.lr': 0.0012473353666475689, 'training.weight_decay': 0.00518349278778683, 'training.batch_size': 64, 'training.gradient_clip_val': 0.5909180098818877, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 20, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.5931464705618454, 'training.epochs': 24}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 245 hyperparameters:
  Walk length: 87, Num walks: 273,178
  LR: 1.31e-03, Batch size: 64
  Model: emb_dim=32, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 24, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.544
Metric val_auc_epoch improved by 0.049 >= min_delta = 0.0. New best score: 0.593
Metric val_auc_epoch improved by 0.021 >= min_delta = 0.0. New best score: 0.614
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.622
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.629
Metric val_auc_epoch improved by 0.009 >= min_delta = 0.0. New best score: 0.637
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.638
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.638. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_245-epoch=06-val_auc_epoch=0.6380.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_245-epoch=06-val_auc_epoch=0.6380.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5971615314483643
      val_auc_epoch         0.6379965543746948
      val_f1_epoch          0.5936927795410156
        val_loss            0.8106527328491211
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 245 completed - Val AUC: 0.6380
[I 2025-08-23 05:05:35,508] Trial 245 finished with value: -0.6379965543746948 and parameters: {'dataset.max_walk_length': 87, 'dataset.num_walks': 273178, 'training.lr': 0.0013131144864766049, 'training.weight_decay': 0.004739871116268576, 'training.batch_size': 64, 'training.gradient_clip_val': 0.5886243521147281, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 20, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.5932649139466483, 'training.epochs': 24}. Best is trial 229 with value: -0.6563454866409302.
🧹 Cleaning up old checkpoints and logs (keeping top 10)...
  Removed old checkpoint: trial_235-epoch=07-val_auc_epoch=0.6156.ckpt
  Removed old checkpoint: trial_234-epoch=04-val_auc_epoch=0.6251.ckpt
  Removed old checkpoint: trial_233-epoch=10-val_auc_epoch=0.6166.ckpt
  Removed old checkpoint: trial_232-epoch=12-val_auc_epoch=0.6258.ckpt
  Removed old checkpoint: trial_231-epoch=15-val_auc_epoch=0.6474.ckpt
  Removed old log dir: trial_235
  Removed old log dir: trial_234
  Removed old log dir: trial_233
  Removed old log dir: trial_232
  Removed old log dir: trial_231
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 246 hyperparameters:
  Walk length: 89, Num walks: 271,403
  LR: 1.29e-03, Batch size: 64
  Model: emb_dim=32, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 24, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.532
Metric val_auc_epoch improved by 0.031 >= min_delta = 0.0. New best score: 0.563
Metric val_auc_epoch improved by 0.026 >= min_delta = 0.0. New best score: 0.589
Metric val_auc_epoch improved by 0.011 >= min_delta = 0.0. New best score: 0.599
Metric val_auc_epoch improved by 0.009 >= min_delta = 0.0. New best score: 0.608
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.614
Metric val_auc_epoch improved by 0.009 >= min_delta = 0.0. New best score: 0.623
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.623
Metric val_auc_epoch improved by 0.010 >= min_delta = 0.0. New best score: 0.633
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.633. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_246-epoch=08-val_auc_epoch=0.6330.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_246-epoch=08-val_auc_epoch=0.6330.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5970720648765564
      val_auc_epoch         0.6330345869064331
      val_f1_epoch          0.5934329032897949
        val_loss            0.9591436982154846
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 246 completed - Val AUC: 0.6330
[I 2025-08-23 05:23:14,349] Trial 246 finished with value: -0.6330345869064331 and parameters: {'dataset.max_walk_length': 89, 'dataset.num_walks': 271403, 'training.lr': 0.0012922083990385767, 'training.weight_decay': 0.006034542665835165, 'training.batch_size': 64, 'training.gradient_clip_val': 0.6518213854620872, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 20, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.5928953488933479, 'training.epochs': 24}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 247 hyperparameters:
  Walk length: 90, Num walks: 279,641
  LR: 1.37e-03, Batch size: 64
  Model: emb_dim=32, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 24, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.542
Metric val_auc_epoch improved by 0.031 >= min_delta = 0.0. New best score: 0.573
Metric val_auc_epoch improved by 0.025 >= min_delta = 0.0. New best score: 0.598
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.604
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.604
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.606
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.607
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.613
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.614
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.614
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.614. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_247-epoch=10-val_auc_epoch=0.6143.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_247-epoch=10-val_auc_epoch=0.6143.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5843650102615356
      val_auc_epoch         0.6142944097518921
      val_f1_epoch          0.5811713933944702
        val_loss            0.7569464445114136
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 247 completed - Val AUC: 0.6143
[I 2025-08-23 05:43:52,208] Trial 247 finished with value: -0.6142944097518921 and parameters: {'dataset.max_walk_length': 90, 'dataset.num_walks': 279641, 'training.lr': 0.001370234928566842, 'training.weight_decay': 0.005542643331048921, 'training.batch_size': 64, 'training.gradient_clip_val': 0.6554916229682024, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 20, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.5929214529162891, 'training.epochs': 24}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 248 hyperparameters:
  Walk length: 88, Num walks: 249,817
  LR: 1.53e-03, Batch size: 64
  Model: emb_dim=32, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 24, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.530
Metric val_auc_epoch improved by 0.042 >= min_delta = 0.0. New best score: 0.572
Metric val_auc_epoch improved by 0.012 >= min_delta = 0.0. New best score: 0.584
Metric val_auc_epoch improved by 0.012 >= min_delta = 0.0. New best score: 0.596
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.598
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.601
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.602
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.604
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.605
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.606
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.606. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_248-epoch=12-val_auc_epoch=0.6063.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_248-epoch=12-val_auc_epoch=0.6063.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5815925002098083
      val_auc_epoch         0.6062523126602173
      val_f1_epoch          0.5712023973464966
        val_loss            1.0549545288085938
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 248 completed - Val AUC: 0.6063
[I 2025-08-23 06:04:05,381] Trial 248 finished with value: -0.6062523126602173 and parameters: {'dataset.max_walk_length': 88, 'dataset.num_walks': 249817, 'training.lr': 0.0015279997528734053, 'training.weight_decay': 0.005097475390827188, 'training.batch_size': 64, 'training.gradient_clip_val': 0.5857036029676743, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 20, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.5925066383013098, 'training.epochs': 24}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 249 hyperparameters:
  Walk length: 87, Num walks: 296,402
  LR: 1.28e-03, Batch size: 64
  Model: emb_dim=32, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 25, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.536
Metric val_auc_epoch improved by 0.023 >= min_delta = 0.0. New best score: 0.559
Metric val_auc_epoch improved by 0.037 >= min_delta = 0.0. New best score: 0.595
Metric val_auc_epoch improved by 0.013 >= min_delta = 0.0. New best score: 0.608
Metric val_auc_epoch improved by 0.011 >= min_delta = 0.0. New best score: 0.619
Metric val_auc_epoch improved by 0.010 >= min_delta = 0.0. New best score: 0.629
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.633
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.639
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.639
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.641
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.641
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.641. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_249-epoch=11-val_auc_epoch=0.6414.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_249-epoch=11-val_auc_epoch=0.6414.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5987299084663391
      val_auc_epoch         0.6413983106613159
      val_f1_epoch           0.596869170665741
        val_loss            0.7892667651176453
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 249 completed - Val AUC: 0.6414
[I 2025-08-23 06:26:34,923] Trial 249 finished with value: -0.6413983106613159 and parameters: {'dataset.max_walk_length': 87, 'dataset.num_walks': 296402, 'training.lr': 0.0012797431896021242, 'training.weight_decay': 0.004568643965609873, 'training.batch_size': 64, 'training.gradient_clip_val': 0.4868055133915846, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 20, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6396567808498635, 'training.epochs': 25}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 250 hyperparameters:
  Walk length: 88, Num walks: 326,386
  LR: 1.25e-03, Batch size: 64
  Model: emb_dim=32, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 25, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.537
Metric val_auc_epoch improved by 0.036 >= min_delta = 0.0. New best score: 0.574
Metric val_auc_epoch improved by 0.034 >= min_delta = 0.0. New best score: 0.607
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.612
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.618
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.624
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.624. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_250-epoch=08-val_auc_epoch=0.6241.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_250-epoch=08-val_auc_epoch=0.6241.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5896615982055664
      val_auc_epoch         0.6240901947021484
      val_f1_epoch          0.5845326781272888
        val_loss            0.7776576280593872
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 250 completed - Val AUC: 0.6241
[I 2025-08-23 06:47:24,399] Trial 250 finished with value: -0.6240901947021484 and parameters: {'dataset.max_walk_length': 88, 'dataset.num_walks': 326386, 'training.lr': 0.00124599663544802, 'training.weight_decay': 0.005553639575979613, 'training.batch_size': 64, 'training.gradient_clip_val': 0.48778565622356895, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 20, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6410815145254924, 'training.epochs': 25}. Best is trial 229 with value: -0.6563454866409302.
🧹 Cleaning up old checkpoints and logs (keeping top 10)...
  Removed old checkpoint: trial_240-epoch=05-val_auc_epoch=0.6106.ckpt
  Removed old checkpoint: trial_239-epoch=05-val_auc_epoch=0.6213.ckpt
  Removed old checkpoint: trial_238-epoch=11-val_auc_epoch=0.6183.ckpt
  Removed old checkpoint: trial_237-epoch=11-val_auc_epoch=0.6216.ckpt
  Removed old checkpoint: trial_236-epoch=04-val_auc_epoch=0.6179.ckpt
  Removed old log dir: trial_240
  Removed old log dir: trial_239
  Removed old log dir: trial_238
  Removed old log dir: trial_237
  Removed old log dir: trial_236
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 251 hyperparameters:
  Walk length: 88, Num walks: 323,979
  LR: 7.92e-04, Batch size: 128
  Model: emb_dim=32, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 25, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.533
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.538
Metric val_auc_epoch improved by 0.034 >= min_delta = 0.0. New best score: 0.572
Metric val_auc_epoch improved by 0.016 >= min_delta = 0.0. New best score: 0.588
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.596
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.602
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.607
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.608
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.608
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.611
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.611. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_251-epoch=10-val_auc_epoch=0.6111.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_251-epoch=10-val_auc_epoch=0.6111.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5777312517166138
      val_auc_epoch         0.6111452579498291
      val_f1_epoch          0.5765630006790161
        val_loss            0.9365528225898743
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 251 completed - Val AUC: 0.6111
[I 2025-08-23 07:04:32,022] Trial 251 finished with value: -0.6111452579498291 and parameters: {'dataset.max_walk_length': 88, 'dataset.num_walks': 323979, 'training.lr': 0.0007921481634043601, 'training.weight_decay': 0.00657160068157064, 'training.batch_size': 128, 'training.gradient_clip_val': 0.4878253537020025, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 20, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6396304387221312, 'training.epochs': 25}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 252 hyperparameters:
  Walk length: 78, Num walks: 297,666
  LR: 6.22e-04, Batch size: 64
  Model: emb_dim=32, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 23, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.538
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.539
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.539
Metric val_auc_epoch improved by 0.031 >= min_delta = 0.0. New best score: 0.570
Metric val_auc_epoch improved by 0.023 >= min_delta = 0.0. New best score: 0.593
Metric val_auc_epoch improved by 0.011 >= min_delta = 0.0. New best score: 0.604
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.613
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.618
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.623
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.625
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.626
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.627
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.629
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.629. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_252-epoch=12-val_auc_epoch=0.6287.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_252-epoch=12-val_auc_epoch=0.6287.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5902860164642334
      val_auc_epoch         0.6286802291870117
      val_f1_epoch          0.5850543975830078
        val_loss            1.1024699211120605
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 252 completed - Val AUC: 0.6287
[I 2025-08-23 07:27:56,988] Trial 252 finished with value: -0.6286802291870117 and parameters: {'dataset.max_walk_length': 78, 'dataset.num_walks': 297666, 'training.lr': 0.0006223725979264505, 'training.weight_decay': 0.006377627480827887, 'training.batch_size': 64, 'training.gradient_clip_val': 0.47812612165679547, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 20, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6448159014692264, 'training.epochs': 23}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 253 hyperparameters:
  Walk length: 78, Num walks: 235,933
  LR: 6.13e-04, Batch size: 64
  Model: emb_dim=128, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 24, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.524
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.524. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_253-epoch=00-val_auc_epoch=0.5244.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_253-epoch=00-val_auc_epoch=0.5244.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5157017707824707
      val_auc_epoch          0.524369478225708
      val_f1_epoch          0.49649375677108765
        val_loss             0.769228994846344
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 253 completed - Val AUC: 0.5244
[I 2025-08-23 07:35:10,811] Trial 253 finished with value: -0.524369478225708 and parameters: {'dataset.max_walk_length': 78, 'dataset.num_walks': 235933, 'training.lr': 0.0006132509897650019, 'training.weight_decay': 0.004709611675417801, 'training.batch_size': 64, 'training.gradient_clip_val': 0.4814021007692444, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 22, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6620013762833462, 'training.epochs': 24}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 254 hyperparameters:
  Walk length: 81, Num walks: 306,523
  LR: 1.76e-03, Batch size: 64
  Model: emb_dim=32, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 23, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.552
Metric val_auc_epoch improved by 0.059 >= min_delta = 0.0. New best score: 0.611
Metric val_auc_epoch improved by 0.023 >= min_delta = 0.0. New best score: 0.634
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.642
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.643
❌ Trial 254 failed: Trial was pruned at epoch 6.
[I 2025-08-23 07:45:00,774] Trial 254 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 81, 'dataset.num_walks': 306523, 'training.lr': 0.0017587895632803932, 'training.weight_decay': 0.005350656973028522, 'training.batch_size': 64, 'training.gradient_clip_val': 0.44873931059652883, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 20, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6429229696929636, 'training.epochs': 23}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 255 hyperparameters:
  Walk length: 83, Num walks: 329,619
  LR: 1.30e-03, Batch size: 64
  Model: emb_dim=32, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 24, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.528
Metric val_auc_epoch improved by 0.061 >= min_delta = 0.0. New best score: 0.588
Metric val_auc_epoch improved by 0.013 >= min_delta = 0.0. New best score: 0.601
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.609
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.610
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.612
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.613
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.615
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.615. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_255-epoch=12-val_auc_epoch=0.6148.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_255-epoch=12-val_auc_epoch=0.6148.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5892221927642822
      val_auc_epoch         0.6147526502609253
      val_f1_epoch          0.5875939130783081
        val_loss            1.1166949272155762
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 255 completed - Val AUC: 0.6148
[I 2025-08-23 08:11:28,193] Trial 255 finished with value: -0.6147526502609253 and parameters: {'dataset.max_walk_length': 83, 'dataset.num_walks': 329619, 'training.lr': 0.0012951368358993841, 'training.weight_decay': 0.006616952279042326, 'training.batch_size': 64, 'training.gradient_clip_val': 0.6513472059826878, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 20, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.5886360464550542, 'training.epochs': 24}. Best is trial 229 with value: -0.6563454866409302.
🧹 Cleaning up old checkpoints and logs (keeping top 10)...
  Removed old checkpoint: trial_245-epoch=06-val_auc_epoch=0.6380.ckpt
  Removed old checkpoint: trial_244-epoch=07-val_auc_epoch=0.6224.ckpt
  Removed old checkpoint: trial_243-epoch=07-val_auc_epoch=0.5839.ckpt
  Removed old checkpoint: trial_242-epoch=05-val_auc_epoch=0.5408.ckpt
  Removed old checkpoint: trial_241-epoch=00-val_auc_epoch=0.5309.ckpt
  Removed old log dir: trial_245
  Removed old log dir: trial_244
  Removed old log dir: trial_243
  Removed old log dir: trial_242
  Removed old log dir: trial_241
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 256 hyperparameters:
  Walk length: 79, Num walks: 242,099
  LR: 8.05e-04, Batch size: 64
  Model: emb_dim=16, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 25, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.528
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.530
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.530. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_256-epoch=01-val_auc_epoch=0.5299.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_256-epoch=01-val_auc_epoch=0.5299.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5214183330535889
      val_auc_epoch         0.5299007892608643
      val_f1_epoch          0.5204553008079529
        val_loss            0.7191938161849976
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 256 completed - Val AUC: 0.5299
[I 2025-08-23 08:21:06,916] Trial 256 finished with value: -0.5299007892608643 and parameters: {'dataset.max_walk_length': 79, 'dataset.num_walks': 242099, 'training.lr': 0.0008052678163277863, 'training.weight_decay': 0.004043036513628928, 'training.batch_size': 64, 'training.gradient_clip_val': 0.593548120239771, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 19, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6503884191609864, 'training.epochs': 25}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 257 hyperparameters:
  Walk length: 91, Num walks: 259,921
  LR: 5.72e-04, Batch size: 64
  Model: emb_dim=128, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 26, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.530
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.530
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.532
Metric val_auc_epoch improved by 0.039 >= min_delta = 0.0. New best score: 0.571
Metric val_auc_epoch improved by 0.030 >= min_delta = 0.0. New best score: 0.600
Metric val_auc_epoch improved by 0.012 >= min_delta = 0.0. New best score: 0.612
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.615
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.616
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.617
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.617. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_257-epoch=09-val_auc_epoch=0.6169.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_257-epoch=09-val_auc_epoch=0.6169.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5903922915458679
      val_auc_epoch         0.6168661117553711
      val_f1_epoch          0.5867362022399902
        val_loss            1.6483674049377441
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 257 completed - Val AUC: 0.6169
[I 2025-08-23 08:40:53,148] Trial 257 finished with value: -0.6168661117553711 and parameters: {'dataset.max_walk_length': 91, 'dataset.num_walks': 259921, 'training.lr': 0.0005724020146649871, 'training.weight_decay': 0.008172905945002876, 'training.batch_size': 64, 'training.gradient_clip_val': 0.692158666781675, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 22, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6268198134828427, 'training.epochs': 26}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 258 hyperparameters:
  Walk length: 75, Num walks: 295,853
  LR: 6.93e-04, Batch size: 64
  Model: emb_dim=32, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 23, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.537
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.541
Metric val_auc_epoch improved by 0.042 >= min_delta = 0.0. New best score: 0.583
Metric val_auc_epoch improved by 0.019 >= min_delta = 0.0. New best score: 0.602
Metric val_auc_epoch improved by 0.012 >= min_delta = 0.0. New best score: 0.614
Metric val_auc_epoch improved by 0.011 >= min_delta = 0.0. New best score: 0.625
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.631
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.637
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.639
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.639
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.640
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.641
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.642
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.642. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_258-epoch=16-val_auc_epoch=0.6415.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_258-epoch=16-val_auc_epoch=0.6415.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.6046870946884155
      val_auc_epoch         0.6415197849273682
      val_f1_epoch          0.5999102592468262
        val_loss             1.243082880973816
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 258 completed - Val AUC: 0.6415
[I 2025-08-23 09:08:37,964] Trial 258 finished with value: -0.6415197849273682 and parameters: {'dataset.max_walk_length': 75, 'dataset.num_walks': 295853, 'training.lr': 0.0006926058020617299, 'training.weight_decay': 0.0017130619495145825, 'training.batch_size': 64, 'training.gradient_clip_val': 0.4356310595515688, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 20, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.5979779410900278, 'training.epochs': 23}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 259 hyperparameters:
  Walk length: 74, Num walks: 307,853
  LR: 6.80e-04, Batch size: 64
  Model: emb_dim=32, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 23, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.544
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.551
Metric val_auc_epoch improved by 0.025 >= min_delta = 0.0. New best score: 0.576
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.582
Metric val_auc_epoch improved by 0.009 >= min_delta = 0.0. New best score: 0.590
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.595
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.600
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.604
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.604. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_259-epoch=10-val_auc_epoch=0.6040.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_259-epoch=10-val_auc_epoch=0.6040.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5744503736495972
      val_auc_epoch         0.6040071249008179
      val_f1_epoch          0.5730258226394653
        val_loss            0.9006350040435791
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 259 completed - Val AUC: 0.6040
[I 2025-08-23 09:29:49,760] Trial 259 finished with value: -0.6040071249008179 and parameters: {'dataset.max_walk_length': 74, 'dataset.num_walks': 307853, 'training.lr': 0.0006795024551828948, 'training.weight_decay': 0.0017932853174033774, 'training.batch_size': 64, 'training.gradient_clip_val': 0.4358317437515068, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 20, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.5970592870716319, 'training.epochs': 23}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 260 hyperparameters:
  Walk length: 76, Num walks: 285,411
  LR: 8.81e-04, Batch size: 64
  Model: emb_dim=16, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 24, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.549
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.550
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.553
Metric val_auc_epoch improved by 0.012 >= min_delta = 0.0. New best score: 0.565
Metric val_auc_epoch improved by 0.013 >= min_delta = 0.0. New best score: 0.578
Metric val_auc_epoch improved by 0.009 >= min_delta = 0.0. New best score: 0.587
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.594
Metric val_auc_epoch improved by 0.010 >= min_delta = 0.0. New best score: 0.604
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.612
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.619
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.624
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.626
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.629
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.631
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.632
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.634
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.634
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.635
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.635
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.635
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.636
`Trainer.fit` stopped: `max_epochs=24` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_260-epoch=21-val_auc_epoch=0.6358.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_260-epoch=21-val_auc_epoch=0.6358.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5957321524620056
      val_auc_epoch         0.6357719898223877
      val_f1_epoch          0.5914126038551331
        val_loss            0.7757523655891418
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 260 completed - Val AUC: 0.6358
[I 2025-08-23 10:03:42,442] Trial 260 finished with value: -0.6357719898223877 and parameters: {'dataset.max_walk_length': 76, 'dataset.num_walks': 285411, 'training.lr': 0.0008813709137016976, 'training.weight_decay': 0.004255799883987906, 'training.batch_size': 64, 'training.gradient_clip_val': 0.45130353129194867, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 19, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.586627759873495, 'training.epochs': 24}. Best is trial 229 with value: -0.6563454866409302.
🧹 Cleaning up old checkpoints and logs (keeping top 10)...
  Removed old checkpoint: trial_250-epoch=08-val_auc_epoch=0.6241.ckpt
  Removed old checkpoint: trial_249-epoch=11-val_auc_epoch=0.6414.ckpt
  Removed old checkpoint: trial_248-epoch=12-val_auc_epoch=0.6063.ckpt
  Removed old checkpoint: trial_247-epoch=10-val_auc_epoch=0.6143.ckpt
  Removed old checkpoint: trial_246-epoch=08-val_auc_epoch=0.6330.ckpt
  Removed old log dir: trial_250
  Removed old log dir: trial_249
  Removed old log dir: trial_248
  Removed old log dir: trial_247
  Removed old log dir: trial_246
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 261 hyperparameters:
  Walk length: 77, Num walks: 292,067
  LR: 8.22e-04, Batch size: 64
  Model: emb_dim=16, hidden_dim=32
  Transformer: 5 layers, 8 heads
  Epochs: 24, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.547
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.549
Metric val_auc_epoch improved by 0.012 >= min_delta = 0.0. New best score: 0.561
Metric val_auc_epoch improved by 0.010 >= min_delta = 0.0. New best score: 0.571
Metric val_auc_epoch improved by 0.009 >= min_delta = 0.0. New best score: 0.580
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.587
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.591
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.594
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.597
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.597
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.601
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.603
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.605
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.606
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.606
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.607
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.607
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.607
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.608
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.608
`Trainer.fit` stopped: `max_epochs=24` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_261-epoch=21-val_auc_epoch=0.6079.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_261-epoch=21-val_auc_epoch=0.6079.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5733716487884521
      val_auc_epoch         0.6078855395317078
      val_f1_epoch          0.5720635652542114
        val_loss             0.813228189945221
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 261 completed - Val AUC: 0.6079
[I 2025-08-23 10:39:04,124] Trial 261 finished with value: -0.6078855395317078 and parameters: {'dataset.max_walk_length': 77, 'dataset.num_walks': 292067, 'training.lr': 0.0008220311802095209, 'training.weight_decay': 0.0043898050961252, 'training.batch_size': 64, 'training.gradient_clip_val': 0.4533462358913971, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 19, 'model.hidden_dim': 32, 'model.nlayers': 5, 'model.dropout': 0.58582440453665, 'training.epochs': 24}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 262 hyperparameters:
  Walk length: 83, Num walks: 348,236
  LR: 6.75e-04, Batch size: 64
  Model: emb_dim=32, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 24, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.530
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.535
Metric val_auc_epoch improved by 0.027 >= min_delta = 0.0. New best score: 0.562
Metric val_auc_epoch improved by 0.024 >= min_delta = 0.0. New best score: 0.586
Metric val_auc_epoch improved by 0.012 >= min_delta = 0.0. New best score: 0.597
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.605
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.608
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.609
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.609. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_262-epoch=07-val_auc_epoch=0.6094.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_262-epoch=07-val_auc_epoch=0.6094.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5802510976791382
      val_auc_epoch         0.6094015836715698
      val_f1_epoch          0.5776163339614868
        val_loss            1.1696990728378296
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 262 completed - Val AUC: 0.6094
[I 2025-08-23 10:59:30,440] Trial 262 finished with value: -0.6094015836715698 and parameters: {'dataset.max_walk_length': 83, 'dataset.num_walks': 348236, 'training.lr': 0.0006753889056488401, 'training.weight_decay': 0.006635919806403367, 'training.batch_size': 64, 'training.gradient_clip_val': 0.4023856926592315, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 20, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6355412572449796, 'training.epochs': 24}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 263 hyperparameters:
  Walk length: 76, Num walks: 244,559
  LR: 1.36e-03, Batch size: 64
  Model: emb_dim=16, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 22, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.527
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.528
Metric val_auc_epoch improved by 0.013 >= min_delta = 0.0. New best score: 0.541
Metric val_auc_epoch improved by 0.011 >= min_delta = 0.0. New best score: 0.552
Metric val_auc_epoch improved by 0.011 >= min_delta = 0.0. New best score: 0.563
Metric val_auc_epoch improved by 0.010 >= min_delta = 0.0. New best score: 0.573
Metric val_auc_epoch improved by 0.013 >= min_delta = 0.0. New best score: 0.586
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.593
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.600
Metric val_auc_epoch improved by 0.009 >= min_delta = 0.0. New best score: 0.608
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.611
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.613
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.616
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.616
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.619
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.619
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.621
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.621
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.622
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.622
`Trainer.fit` stopped: `max_epochs=22` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_263-epoch=21-val_auc_epoch=0.6222.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_263-epoch=21-val_auc_epoch=0.6222.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5910436511039734
      val_auc_epoch         0.6221911311149597
      val_f1_epoch          0.5871883034706116
        val_loss            0.9258955717086792
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 263 completed - Val AUC: 0.6222
[I 2025-08-23 11:26:08,967] Trial 263 finished with value: -0.6221911311149597 and parameters: {'dataset.max_walk_length': 76, 'dataset.num_walks': 244559, 'training.lr': 0.0013630000303108106, 'training.weight_decay': 0.004187375023586191, 'training.batch_size': 64, 'training.gradient_clip_val': 0.4985012131605383, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 19, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.5991511914811245, 'training.epochs': 22}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 264 hyperparameters:
  Walk length: 75, Num walks: 240,593
  LR: 1.74e-03, Batch size: 64
  Model: emb_dim=16, hidden_dim=128
  Transformer: 5 layers, 8 heads
  Epochs: 23, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.537
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.537
Metric val_auc_epoch improved by 0.009 >= min_delta = 0.0. New best score: 0.546
Metric val_auc_epoch improved by 0.020 >= min_delta = 0.0. New best score: 0.566
Metric val_auc_epoch improved by 0.017 >= min_delta = 0.0. New best score: 0.583
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.590
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.595
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.598
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.602
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.604
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.606
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.606
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.607
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.608
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.608. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_264-epoch=16-val_auc_epoch=0.6079.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_264-epoch=16-val_auc_epoch=0.6079.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5770955085754395
      val_auc_epoch         0.6079298257827759
      val_f1_epoch          0.5736860632896423
        val_loss            0.7174720168113708
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 264 completed - Val AUC: 0.6079
[I 2025-08-23 11:52:14,082] Trial 264 finished with value: -0.6079298257827759 and parameters: {'dataset.max_walk_length': 75, 'dataset.num_walks': 240593, 'training.lr': 0.001736767826502183, 'training.weight_decay': 0.008043896114360665, 'training.batch_size': 64, 'training.gradient_clip_val': 0.6148257551415568, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 19, 'model.hidden_dim': 128, 'model.nlayers': 5, 'model.dropout': 0.5835486076796776, 'training.epochs': 23}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 265 hyperparameters:
  Walk length: 72, Num walks: 323,425
  LR: 1.31e-03, Batch size: 64
  Model: emb_dim=128, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 22, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.537
Monitored metric val_auc_epoch did not improve in the last 6 records. Best score: 0.537. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_265-epoch=00-val_auc_epoch=0.5370.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_265-epoch=00-val_auc_epoch=0.5370.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch          0.526896595954895
      val_auc_epoch         0.5370354652404785
      val_f1_epoch          0.5107612609863281
        val_loss            0.7713605165481567
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 265 completed - Val AUC: 0.5370
[I 2025-08-23 12:03:13,213] Trial 265 finished with value: -0.5370354652404785 and parameters: {'dataset.max_walk_length': 72, 'dataset.num_walks': 323425, 'training.lr': 0.0013133080789730323, 'training.weight_decay': 0.004799837551479249, 'training.batch_size': 64, 'training.gradient_clip_val': 0.4791127480618765, 'training.early_stopping_patience': 6, 'model.nhead_emb_combo': 22, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.5954519586001268, 'training.epochs': 22}. Best is trial 229 with value: -0.6563454866409302.
🧹 Cleaning up old checkpoints and logs (keeping top 10)...
  Removed old checkpoint: trial_255-epoch=12-val_auc_epoch=0.6148.ckpt
  Removed old checkpoint: trial_254-epoch=04-val_auc_epoch=0.6432.ckpt
  Removed old checkpoint: trial_253-epoch=00-val_auc_epoch=0.5244.ckpt
  Removed old checkpoint: trial_252-epoch=12-val_auc_epoch=0.6287.ckpt
  Removed old checkpoint: trial_251-epoch=10-val_auc_epoch=0.6111.ckpt
  Removed old log dir: trial_255
  Removed old log dir: trial_254
  Removed old log dir: trial_253
  Removed old log dir: trial_252
  Removed old log dir: trial_251
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 266 hyperparameters:
  Walk length: 82, Num walks: 291,891
  LR: 5.15e-04, Batch size: 64
  Model: emb_dim=64, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 24, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.535
Metric val_auc_epoch improved by 0.024 >= min_delta = 0.0. New best score: 0.559
Metric val_auc_epoch improved by 0.029 >= min_delta = 0.0. New best score: 0.588
Metric val_auc_epoch improved by 0.009 >= min_delta = 0.0. New best score: 0.597
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.604
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.607
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.611
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.611
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.612
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.613
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.614
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.614. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_266-epoch=12-val_auc_epoch=0.6136.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_266-epoch=12-val_auc_epoch=0.6136.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5816973447799683
      val_auc_epoch         0.6135638952255249
      val_f1_epoch          0.5752851963043213
        val_loss            1.2049922943115234
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 266 completed - Val AUC: 0.6136
[I 2025-08-23 12:27:01,113] Trial 266 finished with value: -0.6135638952255249 and parameters: {'dataset.max_walk_length': 82, 'dataset.num_walks': 291891, 'training.lr': 0.0005148535680397657, 'training.weight_decay': 0.0016218446637671607, 'training.batch_size': 64, 'training.gradient_clip_val': 0.6315634549354833, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 21, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6578868816622343, 'training.epochs': 24}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 267 hyperparameters:
  Walk length: 78, Num walks: 247,968
  LR: 8.87e-04, Batch size: 64
  Model: emb_dim=16, hidden_dim=16
  Transformer: 5 layers, 16 heads
  Epochs: 25, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.523
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.528
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.533
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.534
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.542
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.545
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.551
Metric val_auc_epoch improved by 0.009 >= min_delta = 0.0. New best score: 0.559
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.564
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.564
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.566
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.570
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.574
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.580
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.580
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.581
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.582
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.582
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.582
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.582
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.583
`Trainer.fit` stopped: `max_epochs=25` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_267-epoch=23-val_auc_epoch=0.5825.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_267-epoch=23-val_auc_epoch=0.5825.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5551818609237671
      val_auc_epoch         0.5825493931770325
      val_f1_epoch          0.5499976873397827
        val_loss            0.7591829299926758
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 267 completed - Val AUC: 0.5825
[I 2025-08-23 13:15:57,200] Trial 267 finished with value: -0.5825493931770325 and parameters: {'dataset.max_walk_length': 78, 'dataset.num_walks': 247968, 'training.lr': 0.0008867472544725496, 'training.weight_decay': 0.004045875691231168, 'training.batch_size': 64, 'training.gradient_clip_val': 0.5801185798259033, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 23, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6234982685128146, 'training.epochs': 25}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 268 hyperparameters:
  Walk length: 81, Num walks: 230,682
  LR: 2.03e-03, Batch size: 64
  Model: emb_dim=16, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 22, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.521
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.527
Metric val_auc_epoch improved by 0.026 >= min_delta = 0.0. New best score: 0.553
Metric val_auc_epoch improved by 0.013 >= min_delta = 0.0. New best score: 0.566
Metric val_auc_epoch improved by 0.013 >= min_delta = 0.0. New best score: 0.580
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.584
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.589
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.590
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.592
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.594
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.594
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.595
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.595. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_268-epoch=15-val_auc_epoch=0.5946.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_268-epoch=15-val_auc_epoch=0.5946.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5697609782218933
      val_auc_epoch          0.594641923904419
      val_f1_epoch           0.566196084022522
        val_loss            0.7082278728485107
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 268 completed - Val AUC: 0.5946
[I 2025-08-23 13:42:36,070] Trial 268 finished with value: -0.594641923904419 and parameters: {'dataset.max_walk_length': 81, 'dataset.num_walks': 230682, 'training.lr': 0.002034274010468947, 'training.weight_decay': 0.010634407334104782, 'training.batch_size': 64, 'training.gradient_clip_val': 0.6893525647632096, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 19, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.5819016009050216, 'training.epochs': 22}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 269 hyperparameters:
  Walk length: 84, Num walks: 218,663
  LR: 1.48e-03, Batch size: 64
  Model: emb_dim=32, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 24, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.534
Metric val_auc_epoch improved by 0.026 >= min_delta = 0.0. New best score: 0.560
Metric val_auc_epoch improved by 0.026 >= min_delta = 0.0. New best score: 0.586
Metric val_auc_epoch improved by 0.011 >= min_delta = 0.0. New best score: 0.597
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.605
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.613
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.619
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.620
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.622
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.625
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.626
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.626
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.628
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.629
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.629
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.630
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.630
`Trainer.fit` stopped: `max_epochs=24` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_269-epoch=23-val_auc_epoch=0.6295.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_269-epoch=23-val_auc_epoch=0.6295.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch          0.597072958946228
      val_auc_epoch         0.6295121312141418
      val_f1_epoch          0.5847220420837402
        val_loss            1.0367575883865356
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 269 completed - Val AUC: 0.6295
[I 2025-08-23 14:05:40,963] Trial 269 finished with value: -0.6295121312141418 and parameters: {'dataset.max_walk_length': 84, 'dataset.num_walks': 218663, 'training.lr': 0.0014751953500285822, 'training.weight_decay': 0.005492425699098271, 'training.batch_size': 64, 'training.gradient_clip_val': 0.41632738438638156, 'training.early_stopping_patience': 6, 'model.nhead_emb_combo': 20, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6416102551615019, 'training.epochs': 24}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 270 hyperparameters:
  Walk length: 90, Num walks: 288,706
  LR: 1.42e-03, Batch size: 64
  Model: emb_dim=32, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 24, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.538
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.540
Metric val_auc_epoch improved by 0.039 >= min_delta = 0.0. New best score: 0.580
Metric val_auc_epoch improved by 0.017 >= min_delta = 0.0. New best score: 0.597
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.601
Metric val_auc_epoch improved by 0.013 >= min_delta = 0.0. New best score: 0.614
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.614
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.616
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.618
Monitored metric val_auc_epoch did not improve in the last 6 records. Best score: 0.618. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_270-epoch=13-val_auc_epoch=0.6179.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_270-epoch=13-val_auc_epoch=0.6179.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5945943593978882
      val_auc_epoch         0.6179496645927429
      val_f1_epoch          0.5851176977157593
        val_loss            0.9570225477218628
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 270 completed - Val AUC: 0.6179
[I 2025-08-23 14:32:06,174] Trial 270 finished with value: -0.6179496645927429 and parameters: {'dataset.max_walk_length': 90, 'dataset.num_walks': 288706, 'training.lr': 0.0014171459379117065, 'training.weight_decay': 0.0061672515644785215, 'training.batch_size': 64, 'training.gradient_clip_val': 0.42242534306873847, 'training.early_stopping_patience': 6, 'model.nhead_emb_combo': 20, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6437135924698285, 'training.epochs': 24}. Best is trial 229 with value: -0.6563454866409302.
🧹 Cleaning up old checkpoints and logs (keeping top 10)...
  Removed old checkpoint: trial_260-epoch=21-val_auc_epoch=0.6358.ckpt
  Removed old checkpoint: trial_259-epoch=10-val_auc_epoch=0.6040.ckpt
  Removed old checkpoint: trial_258-epoch=16-val_auc_epoch=0.6415.ckpt
  Removed old checkpoint: trial_257-epoch=09-val_auc_epoch=0.6169.ckpt
  Removed old checkpoint: trial_256-epoch=01-val_auc_epoch=0.5299.ckpt
  Removed old log dir: trial_260
  Removed old log dir: trial_259
  Removed old log dir: trial_258
  Removed old log dir: trial_257
  Removed old log dir: trial_256
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 271 hyperparameters:
  Walk length: 84, Num walks: 250,975
  LR: 1.63e-03, Batch size: 64
  Model: emb_dim=16, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 23, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.534
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.541
Metric val_auc_epoch improved by 0.016 >= min_delta = 0.0. New best score: 0.558
Metric val_auc_epoch improved by 0.009 >= min_delta = 0.0. New best score: 0.566
Metric val_auc_epoch improved by 0.009 >= min_delta = 0.0. New best score: 0.576
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.580
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.586
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.589
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.593
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.597
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.603
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.606
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.607
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.608
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.609
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.609
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.610
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.610
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.610
`Trainer.fit` stopped: `max_epochs=23` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_271-epoch=21-val_auc_epoch=0.6103.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_271-epoch=21-val_auc_epoch=0.6103.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5791239738464355
      val_auc_epoch          0.61030113697052
      val_f1_epoch          0.5745447874069214
        val_loss            0.8425272107124329
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 271 completed - Val AUC: 0.6103
[I 2025-08-23 15:05:22,479] Trial 271 finished with value: -0.61030113697052 and parameters: {'dataset.max_walk_length': 84, 'dataset.num_walks': 250975, 'training.lr': 0.0016315766136620598, 'training.weight_decay': 0.0052422854188716155, 'training.batch_size': 64, 'training.gradient_clip_val': 0.3972676409879538, 'training.early_stopping_patience': 6, 'model.nhead_emb_combo': 19, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.5923446380413115, 'training.epochs': 23}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 272 hyperparameters:
  Walk length: 87, Num walks: 370,043
  LR: 7.22e-04, Batch size: 64
  Model: emb_dim=64, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 25, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.538
Metric val_auc_epoch improved by 0.052 >= min_delta = 0.0. New best score: 0.590
Metric val_auc_epoch improved by 0.020 >= min_delta = 0.0. New best score: 0.610
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.618
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.622
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.622
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.625
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.626
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.628
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.628. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_272-epoch=13-val_auc_epoch=0.6285.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_272-epoch=13-val_auc_epoch=0.6285.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.6031764149665833
      val_auc_epoch         0.6284667253494263
      val_f1_epoch          0.6033635139465332
        val_loss            2.2056498527526855
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 272 completed - Val AUC: 0.6285
[I 2025-08-23 15:37:19,234] Trial 272 finished with value: -0.6284667253494263 and parameters: {'dataset.max_walk_length': 87, 'dataset.num_walks': 370043, 'training.lr': 0.0007224914023396965, 'training.weight_decay': 0.008182811778633864, 'training.batch_size': 64, 'training.gradient_clip_val': 0.4518912479417625, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 21, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6360486403824408, 'training.epochs': 25}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 273 hyperparameters:
  Walk length: 87, Num walks: 359,214
  LR: 6.48e-04, Batch size: 128
  Model: emb_dim=64, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 25, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.531
Metric val_auc_epoch improved by 0.013 >= min_delta = 0.0. New best score: 0.544
Metric val_auc_epoch improved by 0.054 >= min_delta = 0.0. New best score: 0.597
Metric val_auc_epoch improved by 0.012 >= min_delta = 0.0. New best score: 0.610
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.615
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.615
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.618
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.618
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.619
Monitored metric val_auc_epoch did not improve in the last 6 records. Best score: 0.619. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_273-epoch=10-val_auc_epoch=0.6193.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_273-epoch=10-val_auc_epoch=0.6193.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5859718918800354
      val_auc_epoch          0.619327187538147
      val_f1_epoch          0.5777091383934021
        val_loss            1.8905422687530518
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 273 completed - Val AUC: 0.6193
[I 2025-08-23 15:58:31,797] Trial 273 finished with value: -0.619327187538147 and parameters: {'dataset.max_walk_length': 87, 'dataset.num_walks': 359214, 'training.lr': 0.0006477724677774379, 'training.weight_decay': 0.007389649852918176, 'training.batch_size': 128, 'training.gradient_clip_val': 0.4544885687437116, 'training.early_stopping_patience': 6, 'model.nhead_emb_combo': 21, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.662533335856092, 'training.epochs': 25}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 274 hyperparameters:
  Walk length: 83, Num walks: 332,661
  LR: 7.60e-04, Batch size: 64
  Model: emb_dim=128, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 25, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.532
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.532
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.534
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.534
Metric val_auc_epoch improved by 0.011 >= min_delta = 0.0. New best score: 0.544
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.549
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.557
Metric val_auc_epoch improved by 0.062 >= min_delta = 0.0. New best score: 0.618
Metric val_auc_epoch improved by 0.012 >= min_delta = 0.0. New best score: 0.630
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.630. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_274-epoch=08-val_auc_epoch=0.6301.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_274-epoch=08-val_auc_epoch=0.6301.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5943751931190491
      val_auc_epoch         0.6301068067550659
      val_f1_epoch          0.5750222206115723
        val_loss            1.4994049072265625
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 274 completed - Val AUC: 0.6301
[I 2025-08-23 16:21:04,048] Trial 274 finished with value: -0.6301068067550659 and parameters: {'dataset.max_walk_length': 83, 'dataset.num_walks': 332661, 'training.lr': 0.0007600830476206282, 'training.weight_decay': 0.008859635207789563, 'training.batch_size': 64, 'training.gradient_clip_val': 0.504065043411687, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 22, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6344686079797686, 'training.epochs': 25}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 275 hyperparameters:
  Walk length: 83, Num walks: 333,738
  LR: 7.95e-04, Batch size: 64
  Model: emb_dim=128, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 25, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.538
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.540
Metric val_auc_epoch improved by 0.014 >= min_delta = 0.0. New best score: 0.553
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.560
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.567
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.569
Metric val_auc_epoch improved by 0.055 >= min_delta = 0.0. New best score: 0.624
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.629
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.629. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_275-epoch=09-val_auc_epoch=0.6293.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_275-epoch=09-val_auc_epoch=0.6293.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.6027956604957581
      val_auc_epoch         0.6292651891708374
      val_f1_epoch          0.6010593771934509
        val_loss             2.043447732925415
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 275 completed - Val AUC: 0.6293
[I 2025-08-23 16:45:11,250] Trial 275 finished with value: -0.6292651891708374 and parameters: {'dataset.max_walk_length': 83, 'dataset.num_walks': 333738, 'training.lr': 0.0007950804086671832, 'training.weight_decay': 0.008316512217165064, 'training.batch_size': 64, 'training.gradient_clip_val': 0.3616616311594857, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 22, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6456402517898573, 'training.epochs': 25}. Best is trial 229 with value: -0.6563454866409302.
🧹 Cleaning up old checkpoints and logs (keeping top 10)...
  Removed old checkpoint: trial_265-epoch=00-val_auc_epoch=0.5370.ckpt
  Removed old checkpoint: trial_264-epoch=16-val_auc_epoch=0.6079.ckpt
  Removed old checkpoint: trial_263-epoch=21-val_auc_epoch=0.6222.ckpt
  Removed old checkpoint: trial_262-epoch=07-val_auc_epoch=0.6094.ckpt
  Removed old checkpoint: trial_261-epoch=21-val_auc_epoch=0.6079.ckpt
  Removed old log dir: trial_265
  Removed old log dir: trial_264
  Removed old log dir: trial_263
  Removed old log dir: trial_262
  Removed old log dir: trial_261
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 276 hyperparameters:
  Walk length: 83, Num walks: 384,257
  LR: 4.50e-04, Batch size: 64
  Model: emb_dim=128, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 25, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.528
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.537
Metric val_auc_epoch improved by 0.051 >= min_delta = 0.0. New best score: 0.587
Metric val_auc_epoch improved by 0.034 >= min_delta = 0.0. New best score: 0.621
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.625
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.628
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.630
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.630. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_276-epoch=06-val_auc_epoch=0.6296.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_276-epoch=06-val_auc_epoch=0.6296.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.6003526449203491
      val_auc_epoch         0.6295672655105591
      val_f1_epoch          0.5895559787750244
        val_loss            1.6578950881958008
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 276 completed - Val AUC: 0.6296
[I 2025-08-23 17:07:48,254] Trial 276 finished with value: -0.6295672655105591 and parameters: {'dataset.max_walk_length': 83, 'dataset.num_walks': 384257, 'training.lr': 0.00045003113200348143, 'training.weight_decay': 0.007694335737228045, 'training.batch_size': 64, 'training.gradient_clip_val': 0.35720330290489555, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 22, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6749978037438382, 'training.epochs': 25}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 277 hyperparameters:
  Walk length: 82, Num walks: 367,892
  LR: 4.54e-04, Batch size: 64
  Model: emb_dim=128, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 25, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.545
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.553
Metric val_auc_epoch improved by 0.087 >= min_delta = 0.0. New best score: 0.640
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.647
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.648
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.650
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.651
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.651
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.651
Monitored metric val_auc_epoch did not improve in the last 6 records. Best score: 0.651. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_277-epoch=11-val_auc_epoch=0.6511.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_277-epoch=11-val_auc_epoch=0.6511.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch          0.606981635093689
      val_auc_epoch         0.6511405110359192
      val_f1_epoch          0.6075867414474487
        val_loss            2.2111120223999023
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 277 completed - Val AUC: 0.6511
[I 2025-08-23 17:39:24,300] Trial 277 finished with value: -0.6511405110359192 and parameters: {'dataset.max_walk_length': 82, 'dataset.num_walks': 367892, 'training.lr': 0.00045371467926410446, 'training.weight_decay': 0.010663058807421659, 'training.batch_size': 64, 'training.gradient_clip_val': 0.35358353317429425, 'training.early_stopping_patience': 6, 'model.nhead_emb_combo': 22, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6739674142120734, 'training.epochs': 25}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 278 hyperparameters:
  Walk length: 82, Num walks: 389,159
  LR: 5.07e-04, Batch size: 64
  Model: emb_dim=16, hidden_dim=16
  Transformer: 5 layers, 16 heads
  Epochs: 25, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.537
Monitored metric val_auc_epoch did not improve in the last 6 records. Best score: 0.537. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_278-epoch=00-val_auc_epoch=0.5368.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_278-epoch=00-val_auc_epoch=0.5368.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5228753685951233
      val_auc_epoch         0.5368120670318604
      val_f1_epoch          0.5173982977867126
        val_loss            0.7024907469749451
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 278 completed - Val AUC: 0.5368
[I 2025-08-23 18:04:38,312] Trial 278 finished with value: -0.5368120670318604 and parameters: {'dataset.max_walk_length': 82, 'dataset.num_walks': 389159, 'training.lr': 0.0005071061250530034, 'training.weight_decay': 0.009364066025374705, 'training.batch_size': 64, 'training.gradient_clip_val': 0.37739435771748114, 'training.early_stopping_patience': 6, 'model.nhead_emb_combo': 23, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6504515018542986, 'training.epochs': 25}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 279 hyperparameters:
  Walk length: 83, Num walks: 336,630
  LR: 4.29e-04, Batch size: 64
  Model: emb_dim=128, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 25, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.516
Metric val_auc_epoch improved by 0.009 >= min_delta = 0.0. New best score: 0.525
Metric val_auc_epoch improved by 0.048 >= min_delta = 0.0. New best score: 0.574
Metric val_auc_epoch improved by 0.033 >= min_delta = 0.0. New best score: 0.606
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.610
Metric val_auc_epoch improved by 0.010 >= min_delta = 0.0. New best score: 0.620
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.624
Monitored metric val_auc_epoch did not improve in the last 6 records. Best score: 0.624. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_279-epoch=06-val_auc_epoch=0.6244.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_279-epoch=06-val_auc_epoch=0.6244.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch          0.592540442943573
      val_auc_epoch         0.6243925094604492
      val_f1_epoch          0.5890658497810364
        val_loss            1.5449488162994385
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 279 completed - Val AUC: 0.6244
[I 2025-08-23 18:26:02,012] Trial 279 finished with value: -0.6243925094604492 and parameters: {'dataset.max_walk_length': 83, 'dataset.num_walks': 336630, 'training.lr': 0.00042908950358200385, 'training.weight_decay': 0.012060497711559799, 'training.batch_size': 64, 'training.gradient_clip_val': 0.3518068255025814, 'training.early_stopping_patience': 6, 'model.nhead_emb_combo': 22, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.673292582248919, 'training.epochs': 25}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 280 hyperparameters:
  Walk length: 80, Num walks: 388,479
  LR: 6.05e-04, Batch size: 64
  Model: emb_dim=128, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 25, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.517
Metric val_auc_epoch improved by 0.012 >= min_delta = 0.0. New best score: 0.530
Metric val_auc_epoch improved by 0.053 >= min_delta = 0.0. New best score: 0.582
Metric val_auc_epoch improved by 0.029 >= min_delta = 0.0. New best score: 0.611
Metric val_auc_epoch improved by 0.010 >= min_delta = 0.0. New best score: 0.621
Metric val_auc_epoch improved by 0.012 >= min_delta = 0.0. New best score: 0.632
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.632. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_280-epoch=05-val_auc_epoch=0.6323.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_280-epoch=05-val_auc_epoch=0.6323.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch          0.597990870475769
      val_auc_epoch         0.6322982311248779
      val_f1_epoch          0.5900847911834717
        val_loss            1.2997868061065674
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 280 completed - Val AUC: 0.6323
[I 2025-08-23 18:46:49,655] Trial 280 finished with value: -0.6322982311248779 and parameters: {'dataset.max_walk_length': 80, 'dataset.num_walks': 388479, 'training.lr': 0.0006050765002809028, 'training.weight_decay': 0.011156159405129559, 'training.batch_size': 64, 'training.gradient_clip_val': 0.44843252573751347, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 22, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6577275045366674, 'training.epochs': 25}. Best is trial 229 with value: -0.6563454866409302.
🧹 Cleaning up old checkpoints and logs (keeping top 10)...
  Removed old checkpoint: trial_270-epoch=13-val_auc_epoch=0.6179.ckpt
  Removed old checkpoint: trial_269-epoch=23-val_auc_epoch=0.6295.ckpt
  Removed old checkpoint: trial_268-epoch=15-val_auc_epoch=0.5946.ckpt
  Removed old checkpoint: trial_267-epoch=23-val_auc_epoch=0.5825.ckpt
  Removed old checkpoint: trial_266-epoch=12-val_auc_epoch=0.6136.ckpt
  Removed old log dir: trial_270
  Removed old log dir: trial_269
  Removed old log dir: trial_268
  Removed old log dir: trial_267
  Removed old log dir: trial_266
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 281 hyperparameters:
  Walk length: 81, Num walks: 394,345
  LR: 6.02e-04, Batch size: 64
  Model: emb_dim=128, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 24, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.546
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.552
Metric val_auc_epoch improved by 0.010 >= min_delta = 0.0. New best score: 0.562
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.568
Metric val_auc_epoch improved by 0.049 >= min_delta = 0.0. New best score: 0.618
Metric val_auc_epoch improved by 0.021 >= min_delta = 0.0. New best score: 0.639
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.643
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.646
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.646. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_281-epoch=08-val_auc_epoch=0.6460.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_281-epoch=08-val_auc_epoch=0.6460.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.6018161773681641
      val_auc_epoch         0.6460193991661072
      val_f1_epoch          0.5870848894119263
        val_loss            1.6086311340332031
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 281 completed - Val AUC: 0.6460
[I 2025-08-23 19:13:16,953] Trial 281 finished with value: -0.6460193991661072 and parameters: {'dataset.max_walk_length': 81, 'dataset.num_walks': 394345, 'training.lr': 0.0006021557344676807, 'training.weight_decay': 0.011540059844850266, 'training.batch_size': 64, 'training.gradient_clip_val': 0.32884182986829036, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 22, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6834385713623204, 'training.epochs': 24}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 282 hyperparameters:
  Walk length: 84, Num walks: 409,042
  LR: 5.85e-04, Batch size: 64
  Model: emb_dim=16, hidden_dim=16
  Transformer: 5 layers, 16 heads
  Epochs: 24, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.557
Monitored metric val_auc_epoch did not improve in the last 19 records. Best score: 0.557. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_282-epoch=00-val_auc_epoch=0.5567.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_282-epoch=00-val_auc_epoch=0.5567.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5351365804672241
      val_auc_epoch         0.5567359924316406
      val_f1_epoch          0.5350596904754639
        val_loss            0.7052340507507324
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 282 completed - Val AUC: 0.5567
[I 2025-08-23 20:28:11,031] Trial 282 finished with value: -0.5567359924316406 and parameters: {'dataset.max_walk_length': 84, 'dataset.num_walks': 409042, 'training.lr': 0.0005849266702561978, 'training.weight_decay': 0.011059820262967661, 'training.batch_size': 64, 'training.gradient_clip_val': 0.33905720357288704, 'training.early_stopping_patience': 19, 'model.nhead_emb_combo': 23, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6882639097202441, 'training.epochs': 24}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 283 hyperparameters:
  Walk length: 82, Num walks: 377,409
  LR: 6.67e-04, Batch size: 64
  Model: emb_dim=128, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 23, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.517
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.522
Metric val_auc_epoch improved by 0.011 >= min_delta = 0.0. New best score: 0.533
Metric val_auc_epoch improved by 0.017 >= min_delta = 0.0. New best score: 0.550
Metric val_auc_epoch improved by 0.058 >= min_delta = 0.0. New best score: 0.608
Metric val_auc_epoch improved by 0.016 >= min_delta = 0.0. New best score: 0.624
Monitored metric val_auc_epoch did not improve in the last 6 records. Best score: 0.624. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_283-epoch=06-val_auc_epoch=0.6237.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_283-epoch=06-val_auc_epoch=0.6237.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5942288041114807
      val_auc_epoch         0.6236862540245056
      val_f1_epoch          0.5898277759552002
        val_loss            1.6501976251602173
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 283 completed - Val AUC: 0.6237
[I 2025-08-23 20:51:46,788] Trial 283 finished with value: -0.6236862540245056 and parameters: {'dataset.max_walk_length': 82, 'dataset.num_walks': 377409, 'training.lr': 0.0006669698733643737, 'training.weight_decay': 0.013283876617463887, 'training.batch_size': 64, 'training.gradient_clip_val': 0.3297624562116882, 'training.early_stopping_patience': 6, 'model.nhead_emb_combo': 22, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.675172403662257, 'training.epochs': 23}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 284 hyperparameters:
  Walk length: 85, Num walks: 357,052
  LR: 4.17e-04, Batch size: 64
  Model: emb_dim=128, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 25, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.534
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.540
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.543
Metric val_auc_epoch improved by 0.059 >= min_delta = 0.0. New best score: 0.602
Metric val_auc_epoch improved by 0.015 >= min_delta = 0.0. New best score: 0.617
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.622
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.622. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_284-epoch=07-val_auc_epoch=0.6217.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_284-epoch=07-val_auc_epoch=0.6217.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5882932543754578
      val_auc_epoch         0.6216827034950256
      val_f1_epoch          0.5770211219787598
        val_loss            1.4761019945144653
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 284 completed - Val AUC: 0.6217
[I 2025-08-23 21:14:50,337] Trial 284 finished with value: -0.6216827034950256 and parameters: {'dataset.max_walk_length': 85, 'dataset.num_walks': 357052, 'training.lr': 0.00041705452548648807, 'training.weight_decay': 0.00935901917946544, 'training.batch_size': 64, 'training.gradient_clip_val': 0.41200954787638494, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 22, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6851961032463693, 'training.epochs': 25}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 285 hyperparameters:
  Walk length: 81, Num walks: 410,153
  LR: 5.60e-04, Batch size: 64
  Model: emb_dim=32, hidden_dim=16
  Transformer: 5 layers, 16 heads
  Epochs: 24, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.532
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.533
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.535
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.540
Metric val_auc_epoch improved by 0.022 >= min_delta = 0.0. New best score: 0.562
Metric val_auc_epoch improved by 0.018 >= min_delta = 0.0. New best score: 0.580
Metric val_auc_epoch improved by 0.012 >= min_delta = 0.0. New best score: 0.592
Metric val_auc_epoch improved by 0.009 >= min_delta = 0.0. New best score: 0.600
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.607
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.612
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.614
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.619
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.623
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.624
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.625
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.625
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.626
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.626
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.627
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.627
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.627
`Trainer.fit` stopped: `max_epochs=24` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_285-epoch=22-val_auc_epoch=0.6269.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_285-epoch=22-val_auc_epoch=0.6269.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5918306112289429
      val_auc_epoch         0.6268636584281921
      val_f1_epoch          0.5845943093299866
        val_loss            0.9266969561576843
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 285 completed - Val AUC: 0.6269
[I 2025-08-23 22:47:45,569] Trial 285 finished with value: -0.6268636584281921 and parameters: {'dataset.max_walk_length': 81, 'dataset.num_walks': 410153, 'training.lr': 0.0005599854451842386, 'training.weight_decay': 0.008803023599011355, 'training.batch_size': 64, 'training.gradient_clip_val': 0.4219715136436004, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 24, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6657532940603084, 'training.epochs': 24}. Best is trial 229 with value: -0.6563454866409302.
🧹 Cleaning up old checkpoints and logs (keeping top 10)...
  Removed old checkpoint: trial_275-epoch=09-val_auc_epoch=0.6293.ckpt
  Removed old checkpoint: trial_274-epoch=08-val_auc_epoch=0.6301.ckpt
  Removed old checkpoint: trial_273-epoch=10-val_auc_epoch=0.6193.ckpt
  Removed old checkpoint: trial_272-epoch=13-val_auc_epoch=0.6285.ckpt
  Removed old checkpoint: trial_271-epoch=21-val_auc_epoch=0.6103.ckpt
  Removed old log dir: trial_275
  Removed old log dir: trial_274
  Removed old log dir: trial_273
  Removed old log dir: trial_272
  Removed old log dir: trial_271
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 286 hyperparameters:
  Walk length: 81, Num walks: 394,740
  LR: 4.66e-04, Batch size: 64
  Model: emb_dim=16, hidden_dim=16
  Transformer: 5 layers, 16 heads
  Epochs: 24, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.537
Monitored metric val_auc_epoch did not improve in the last 6 records. Best score: 0.537. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_286-epoch=00-val_auc_epoch=0.5369.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_286-epoch=00-val_auc_epoch=0.5369.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5262534618377686
      val_auc_epoch          0.536858081817627
      val_f1_epoch          0.5244629979133606
        val_loss            0.6969492435455322
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 286 completed - Val AUC: 0.5369
[I 2025-08-23 23:12:48,100] Trial 286 finished with value: -0.536858081817627 and parameters: {'dataset.max_walk_length': 81, 'dataset.num_walks': 394740, 'training.lr': 0.0004664280430928249, 'training.weight_decay': 0.01337682423842491, 'training.batch_size': 64, 'training.gradient_clip_val': 0.43879994251918597, 'training.early_stopping_patience': 6, 'model.nhead_emb_combo': 23, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6739318486343588, 'training.epochs': 24}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 287 hyperparameters:
  Walk length: 78, Num walks: 409,264
  LR: 5.78e-04, Batch size: 64
  Model: emb_dim=32, hidden_dim=128
  Transformer: 5 layers, 16 heads
  Epochs: 24, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.523
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.527
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.533
Metric val_auc_epoch improved by 0.019 >= min_delta = 0.0. New best score: 0.552
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.560
Metric val_auc_epoch improved by 0.010 >= min_delta = 0.0. New best score: 0.570
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.573
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.579
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.584
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.586
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.589
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.591
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.592
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.593
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.596
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.596
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.597
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.598
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.598
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.598
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.598
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.598
`Trainer.fit` stopped: `max_epochs=24` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_287-epoch=23-val_auc_epoch=0.5981.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_287-epoch=23-val_auc_epoch=0.5981.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch          0.570833146572113
      val_auc_epoch         0.5980827212333679
      val_f1_epoch          0.5674643516540527
        val_loss            0.8425619602203369
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 287 completed - Val AUC: 0.5981
[I 2025-08-24 00:41:20,906] Trial 287 finished with value: -0.5980827212333679 and parameters: {'dataset.max_walk_length': 78, 'dataset.num_walks': 409264, 'training.lr': 0.0005781048591572391, 'training.weight_decay': 0.008434464294966502, 'training.batch_size': 64, 'training.gradient_clip_val': 0.3956669338489116, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 24, 'model.hidden_dim': 128, 'model.nlayers': 5, 'model.dropout': 0.6706554347961563, 'training.epochs': 24}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 288 hyperparameters:
  Walk length: 82, Num walks: 347,786
  LR: 3.40e-04, Batch size: 64
  Model: emb_dim=128, hidden_dim=32
  Transformer: 5 layers, 16 heads
  Epochs: 25, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.527
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.529
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.532
Metric val_auc_epoch improved by 0.019 >= min_delta = 0.0. New best score: 0.551
Metric val_auc_epoch improved by 0.039 >= min_delta = 0.0. New best score: 0.589
Metric val_auc_epoch improved by 0.013 >= min_delta = 0.0. New best score: 0.602
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.608
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.611
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.611
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.612
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.613
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.613
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.613. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_288-epoch=15-val_auc_epoch=0.6131.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_288-epoch=15-val_auc_epoch=0.6131.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5859618186950684
      val_auc_epoch         0.6131352186203003
      val_f1_epoch          0.5804257988929749
        val_loss            2.3122074604034424
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 288 completed - Val AUC: 0.6131
[I 2025-08-24 01:25:47,628] Trial 288 finished with value: -0.6131352186203003 and parameters: {'dataset.max_walk_length': 82, 'dataset.num_walks': 347786, 'training.lr': 0.00034043445602624614, 'training.weight_decay': 0.01731596559857739, 'training.batch_size': 64, 'training.gradient_clip_val': 0.3659449742194773, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 26, 'model.hidden_dim': 32, 'model.nlayers': 5, 'model.dropout': 0.6532573657248831, 'training.epochs': 25}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 289 hyperparameters:
  Walk length: 79, Num walks: 426,478
  LR: 7.02e-04, Batch size: 64
  Model: emb_dim=128, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 24, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.535
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.538
Metric val_auc_epoch improved by 0.062 >= min_delta = 0.0. New best score: 0.600
Metric val_auc_epoch improved by 0.021 >= min_delta = 0.0. New best score: 0.621
Metric val_auc_epoch improved by 0.011 >= min_delta = 0.0. New best score: 0.632
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.635
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.635. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_289-epoch=06-val_auc_epoch=0.6346.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_289-epoch=06-val_auc_epoch=0.6346.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.6038882732391357
      val_auc_epoch         0.6346265077590942
      val_f1_epoch          0.6017357110977173
        val_loss             1.548230528831482
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 289 completed - Val AUC: 0.6346
[I 2025-08-24 01:50:15,297] Trial 289 finished with value: -0.6346265077590942 and parameters: {'dataset.max_walk_length': 79, 'dataset.num_walks': 426478, 'training.lr': 0.0007019808870741682, 'training.weight_decay': 0.008476022952105951, 'training.batch_size': 64, 'training.gradient_clip_val': 0.30753515268751996, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 22, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6912450459753083, 'training.epochs': 24}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 290 hyperparameters:
  Walk length: 76, Num walks: 459,470
  LR: 7.28e-04, Batch size: 64
  Model: emb_dim=128, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 23, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.543
Metric val_auc_epoch improved by 0.013 >= min_delta = 0.0. New best score: 0.556
Metric val_auc_epoch improved by 0.011 >= min_delta = 0.0. New best score: 0.567
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.575
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.576
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.577
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.578
Metric val_auc_epoch improved by 0.060 >= min_delta = 0.0. New best score: 0.637
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.641
Monitored metric val_auc_epoch did not improve in the last 6 records. Best score: 0.641. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_290-epoch=10-val_auc_epoch=0.6413.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_290-epoch=10-val_auc_epoch=0.6413.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.6184619665145874
      val_auc_epoch          0.641294002532959
      val_f1_epoch          0.6095499396324158
        val_loss            1.8629353046417236
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 290 completed - Val AUC: 0.6413
[I 2025-08-24 02:26:39,012] Trial 290 finished with value: -0.641294002532959 and parameters: {'dataset.max_walk_length': 76, 'dataset.num_walks': 459470, 'training.lr': 0.0007278895810421904, 'training.weight_decay': 0.009108211279688267, 'training.batch_size': 64, 'training.gradient_clip_val': 0.29140650153602576, 'training.early_stopping_patience': 6, 'model.nhead_emb_combo': 22, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.699417800652614, 'training.epochs': 23}. Best is trial 229 with value: -0.6563454866409302.
🧹 Cleaning up old checkpoints and logs (keeping top 10)...
  Removed old checkpoint: trial_280-epoch=05-val_auc_epoch=0.6323.ckpt
  Removed old checkpoint: trial_279-epoch=06-val_auc_epoch=0.6244.ckpt
  Removed old checkpoint: trial_278-epoch=00-val_auc_epoch=0.5368.ckpt
  Removed old checkpoint: trial_277-epoch=11-val_auc_epoch=0.6511.ckpt
  Removed old checkpoint: trial_276-epoch=06-val_auc_epoch=0.6296.ckpt
  Removed old log dir: trial_280
  Removed old log dir: trial_279
  Removed old log dir: trial_278
  Removed old log dir: trial_277
  Removed old log dir: trial_276
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 291 hyperparameters:
  Walk length: 76, Num walks: 453,017
  LR: 7.57e-04, Batch size: 64
  Model: emb_dim=128, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 23, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.519
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.523
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.524
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.526
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.531
Metric val_auc_epoch improved by 0.015 >= min_delta = 0.0. New best score: 0.546
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.548
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.553
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.555
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.558
Metric val_auc_epoch improved by 0.044 >= min_delta = 0.0. New best score: 0.602
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.602
Monitored metric val_auc_epoch did not improve in the last 6 records. Best score: 0.602. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_291-epoch=14-val_auc_epoch=0.6025.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_291-epoch=14-val_auc_epoch=0.6025.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5913155674934387
      val_auc_epoch         0.6024839282035828
      val_f1_epoch          0.5872286558151245
        val_loss            2.7962284088134766
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 291 completed - Val AUC: 0.6025
[I 2025-08-24 03:18:08,032] Trial 291 finished with value: -0.6024839282035828 and parameters: {'dataset.max_walk_length': 76, 'dataset.num_walks': 453017, 'training.lr': 0.0007570301868192988, 'training.weight_decay': 0.010843320400985297, 'training.batch_size': 64, 'training.gradient_clip_val': 0.2941165116971789, 'training.early_stopping_patience': 6, 'model.nhead_emb_combo': 22, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.695625883984137, 'training.epochs': 23}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 292 hyperparameters:
  Walk length: 78, Num walks: 375,563
  LR: 7.06e-04, Batch size: 64
  Model: emb_dim=128, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 23, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.546
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.548
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.555
Metric val_auc_epoch improved by 0.009 >= min_delta = 0.0. New best score: 0.564
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.570
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.570
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.570
Metric val_auc_epoch improved by 0.042 >= min_delta = 0.0. New best score: 0.612
Metric val_auc_epoch improved by 0.015 >= min_delta = 0.0. New best score: 0.627
Monitored metric val_auc_epoch did not improve in the last 6 records. Best score: 0.627. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_292-epoch=09-val_auc_epoch=0.6266.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_292-epoch=09-val_auc_epoch=0.6266.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5957844257354736
      val_auc_epoch         0.6265681982040405
      val_f1_epoch          0.5904954671859741
        val_loss            1.6937304735183716
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 292 completed - Val AUC: 0.6266
[I 2025-08-24 03:52:46,515] Trial 292 finished with value: -0.6265681982040405 and parameters: {'dataset.max_walk_length': 78, 'dataset.num_walks': 375563, 'training.lr': 0.0007064849766425998, 'training.weight_decay': 0.007403396387297645, 'training.batch_size': 64, 'training.gradient_clip_val': 0.3018868599624326, 'training.early_stopping_patience': 6, 'model.nhead_emb_combo': 22, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6897226563891455, 'training.epochs': 23}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 293 hyperparameters:
  Walk length: 79, Num walks: 360,610
  LR: 8.27e-04, Batch size: 64
  Model: emb_dim=16, hidden_dim=16
  Transformer: 5 layers, 16 heads
  Epochs: 24, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.539
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.544
Metric val_auc_epoch improved by 0.011 >= min_delta = 0.0. New best score: 0.555
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.562
Metric val_auc_epoch improved by 0.011 >= min_delta = 0.0. New best score: 0.573
Metric val_auc_epoch improved by 0.009 >= min_delta = 0.0. New best score: 0.582
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.584
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.589
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.590
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.591
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.592
`Trainer.fit` stopped: `max_epochs=24` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_293-epoch=17-val_auc_epoch=0.5920.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_293-epoch=17-val_auc_epoch=0.5920.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5671278834342957
      val_auc_epoch         0.5920095443725586
      val_f1_epoch          0.5629236698150635
        val_loss            0.7679368853569031
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 293 completed - Val AUC: 0.5920
[I 2025-08-24 05:03:01,753] Trial 293 finished with value: -0.5920095443725586 and parameters: {'dataset.max_walk_length': 79, 'dataset.num_walks': 360610, 'training.lr': 0.000826835938208616, 'training.weight_decay': 0.014922473714017217, 'training.batch_size': 64, 'training.gradient_clip_val': 0.24133905019979887, 'training.early_stopping_patience': 20, 'model.nhead_emb_combo': 23, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6966601688085894, 'training.epochs': 24}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 294 hyperparameters:
  Walk length: 93, Num walks: 438,746
  LR: 6.10e-04, Batch size: 64
  Model: emb_dim=128, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 25, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.536
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.538
Metric val_auc_epoch improved by 0.077 >= min_delta = 0.0. New best score: 0.615
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.617
Monitored metric val_auc_epoch did not improve in the last 6 records. Best score: 0.617. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_294-epoch=03-val_auc_epoch=0.6166.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_294-epoch=03-val_auc_epoch=0.6166.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5836292505264282
      val_auc_epoch         0.6166459321975708
      val_f1_epoch          0.5645347833633423
        val_loss            1.5430881977081299
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 294 completed - Val AUC: 0.6166
[I 2025-08-24 05:26:09,379] Trial 294 finished with value: -0.6166459321975708 and parameters: {'dataset.max_walk_length': 93, 'dataset.num_walks': 438746, 'training.lr': 0.0006100598479921041, 'training.weight_decay': 0.01773918145644305, 'training.batch_size': 64, 'training.gradient_clip_val': 0.4430203709492972, 'training.early_stopping_patience': 6, 'model.nhead_emb_combo': 22, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6806524917045853, 'training.epochs': 25}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 295 hyperparameters:
  Walk length: 75, Num walks: 317,333
  LR: 4.74e-04, Batch size: 64
  Model: emb_dim=128, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 23, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.523
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.524
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.531
Metric val_auc_epoch improved by 0.011 >= min_delta = 0.0. New best score: 0.543
Metric val_auc_epoch improved by 0.037 >= min_delta = 0.0. New best score: 0.579
Metric val_auc_epoch improved by 0.023 >= min_delta = 0.0. New best score: 0.602
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.610
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.611
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.613
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.613
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.613. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_295-epoch=09-val_auc_epoch=0.6134.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_295-epoch=09-val_auc_epoch=0.6134.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5862215161323547
      val_auc_epoch         0.6134459972381592
      val_f1_epoch          0.5841017961502075
        val_loss            1.4383350610733032
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 295 completed - Val AUC: 0.6134
[I 2025-08-24 05:48:02,204] Trial 295 finished with value: -0.6134459972381592 and parameters: {'dataset.max_walk_length': 75, 'dataset.num_walks': 317333, 'training.lr': 0.00047356674503878053, 'training.weight_decay': 0.007434895688448629, 'training.batch_size': 64, 'training.gradient_clip_val': 0.3551719698424978, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 22, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6567392924085983, 'training.epochs': 23}. Best is trial 229 with value: -0.6563454866409302.
🧹 Cleaning up old checkpoints and logs (keeping top 10)...
  Removed old checkpoint: trial_285-epoch=22-val_auc_epoch=0.6269.ckpt
  Removed old checkpoint: trial_284-epoch=07-val_auc_epoch=0.6217.ckpt
  Removed old checkpoint: trial_283-epoch=06-val_auc_epoch=0.6237.ckpt
  Removed old checkpoint: trial_282-epoch=00-val_auc_epoch=0.5567.ckpt
  Removed old checkpoint: trial_281-epoch=08-val_auc_epoch=0.6460.ckpt
  Removed old log dir: trial_285
  Removed old log dir: trial_284
  Removed old log dir: trial_283
  Removed old log dir: trial_282
  Removed old log dir: trial_281
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 296 hyperparameters:
  Walk length: 74, Num walks: 474,071
  LR: 8.65e-04, Batch size: 64
  Model: emb_dim=16, hidden_dim=16
  Transformer: 5 layers, 16 heads
  Epochs: 25, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.535
Metric val_auc_epoch improved by 0.010 >= min_delta = 0.0. New best score: 0.545
Metric val_auc_epoch improved by 0.013 >= min_delta = 0.0. New best score: 0.558
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.564
Metric val_auc_epoch improved by 0.019 >= min_delta = 0.0. New best score: 0.583
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.587
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.590
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.591
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.597
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.598
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.601
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.602
Monitored metric val_auc_epoch did not improve in the last 5 records. Best score: 0.602. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_296-epoch=14-val_auc_epoch=0.6025.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_296-epoch=14-val_auc_epoch=0.6025.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5766755938529968
      val_auc_epoch         0.6024705171585083
      val_f1_epoch          0.5678390264511108
        val_loss            0.7651154398918152
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 296 completed - Val AUC: 0.6025
[I 2025-08-24 06:56:16,404] Trial 296 finished with value: -0.6024705171585083 and parameters: {'dataset.max_walk_length': 74, 'dataset.num_walks': 474071, 'training.lr': 0.0008653744597598405, 'training.weight_decay': 0.011070800316741191, 'training.batch_size': 64, 'training.gradient_clip_val': 0.37590804897583, 'training.early_stopping_patience': 5, 'model.nhead_emb_combo': 23, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6977910277736039, 'training.epochs': 25}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 297 hyperparameters:
  Walk length: 83, Num walks: 391,078
  LR: 6.07e-04, Batch size: 64
  Model: emb_dim=128, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 24, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.532
Metric val_auc_epoch improved by 0.010 >= min_delta = 0.0. New best score: 0.542
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.543
Metric val_auc_epoch improved by 0.009 >= min_delta = 0.0. New best score: 0.552
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.556
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.564
Metric val_auc_epoch improved by 0.059 >= min_delta = 0.0. New best score: 0.623
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.629
Monitored metric val_auc_epoch did not improve in the last 6 records. Best score: 0.629. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_297-epoch=08-val_auc_epoch=0.6290.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_297-epoch=08-val_auc_epoch=0.6290.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5984998941421509
      val_auc_epoch         0.6290206909179688
      val_f1_epoch          0.5922090411186218
        val_loss            1.6736102104187012
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 297 completed - Val AUC: 0.6290
[I 2025-08-24 07:24:37,360] Trial 297 finished with value: -0.6290206909179688 and parameters: {'dataset.max_walk_length': 83, 'dataset.num_walks': 391078, 'training.lr': 0.0006073717644501642, 'training.weight_decay': 0.006727599118586291, 'training.batch_size': 64, 'training.gradient_clip_val': 0.3131915326526691, 'training.early_stopping_patience': 6, 'model.nhead_emb_combo': 22, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6809214633187687, 'training.epochs': 24}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 298 hyperparameters:
  Walk length: 80, Num walks: 419,028
  LR: 5.22e-04, Batch size: 128
  Model: emb_dim=128, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 24, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.529
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.533
Metric val_auc_epoch improved by 0.068 >= min_delta = 0.0. New best score: 0.601
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.603
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.611
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.611
Monitored metric val_auc_epoch did not improve in the last 6 records. Best score: 0.611. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_298-epoch=05-val_auc_epoch=0.6107.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_298-epoch=05-val_auc_epoch=0.6107.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch          0.579383373260498
      val_auc_epoch         0.6106936931610107
      val_f1_epoch           0.561657726764679
        val_loss            1.4636000394821167
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 298 completed - Val AUC: 0.6107
[I 2025-08-24 07:44:17,196] Trial 298 finished with value: -0.6106936931610107 and parameters: {'dataset.max_walk_length': 80, 'dataset.num_walks': 419028, 'training.lr': 0.0005222393974763252, 'training.weight_decay': 0.007416822839027638, 'training.batch_size': 128, 'training.gradient_clip_val': 0.25088275375519825, 'training.early_stopping_patience': 6, 'model.nhead_emb_combo': 22, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6767241678378224, 'training.epochs': 24}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 299 hyperparameters:
  Walk length: 83, Num walks: 384,389
  LR: 3.88e-04, Batch size: 64
  Model: emb_dim=128, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 24, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.538
Metric val_auc_epoch improved by 0.015 >= min_delta = 0.0. New best score: 0.553
Metric val_auc_epoch improved by 0.071 >= min_delta = 0.0. New best score: 0.624
Metric val_auc_epoch improved by 0.010 >= min_delta = 0.0. New best score: 0.635
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.635
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.636
Monitored metric val_auc_epoch did not improve in the last 6 records. Best score: 0.636. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_299-epoch=05-val_auc_epoch=0.6363.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_299-epoch=05-val_auc_epoch=0.6363.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.6002596616744995
      val_auc_epoch         0.6362833976745605
      val_f1_epoch          0.5933467149734497
        val_loss            1.5153748989105225
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 299 completed - Val AUC: 0.6363
[I 2025-08-24 08:06:55,216] Trial 299 finished with value: -0.6362833976745605 and parameters: {'dataset.max_walk_length': 83, 'dataset.num_walks': 384389, 'training.lr': 0.00038827148798173557, 'training.weight_decay': 0.010693542783849336, 'training.batch_size': 64, 'training.gradient_clip_val': 0.32720706388491494, 'training.early_stopping_patience': 6, 'model.nhead_emb_combo': 22, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6641996075952986, 'training.epochs': 24}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 300 hyperparameters:
  Walk length: 77, Num walks: 389,533
  LR: 3.88e-04, Batch size: 64
  Model: emb_dim=128, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 24, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.523
Metric val_auc_epoch improved by 0.009 >= min_delta = 0.0. New best score: 0.533
Metric val_auc_epoch improved by 0.066 >= min_delta = 0.0. New best score: 0.599
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.607
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.608
Monitored metric val_auc_epoch did not improve in the last 6 records. Best score: 0.608. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_300-epoch=05-val_auc_epoch=0.6076.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_300-epoch=05-val_auc_epoch=0.6076.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5853018760681152
      val_auc_epoch         0.6076325178146362
      val_f1_epoch          0.5785427093505859
        val_loss            1.7203373908996582
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 300 completed - Val AUC: 0.6076
[I 2025-08-24 08:28:55,708] Trial 300 finished with value: -0.6076325178146362 and parameters: {'dataset.max_walk_length': 77, 'dataset.num_walks': 389533, 'training.lr': 0.00038816420628057816, 'training.weight_decay': 0.02002334029092165, 'training.batch_size': 64, 'training.gradient_clip_val': 0.32037156628589153, 'training.early_stopping_patience': 6, 'model.nhead_emb_combo': 22, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6643763740784089, 'training.epochs': 24}. Best is trial 229 with value: -0.6563454866409302.
🧹 Cleaning up old checkpoints and logs (keeping top 10)...
  Removed old checkpoint: trial_290-epoch=10-val_auc_epoch=0.6413.ckpt
  Removed old checkpoint: trial_289-epoch=06-val_auc_epoch=0.6346.ckpt
  Removed old checkpoint: trial_288-epoch=15-val_auc_epoch=0.6131.ckpt
  Removed old checkpoint: trial_287-epoch=23-val_auc_epoch=0.5981.ckpt
  Removed old checkpoint: trial_286-epoch=00-val_auc_epoch=0.5369.ckpt
  Removed old log dir: trial_290
  Removed old log dir: trial_289
  Removed old log dir: trial_288
  Removed old log dir: trial_287
  Removed old log dir: trial_286
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 301 hyperparameters:
  Walk length: 83, Num walks: 486,646
  LR: 2.16e-03, Batch size: 64
  Model: emb_dim=16, hidden_dim=16
  Transformer: 6 layers, 16 heads
  Epochs: 24, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.523
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.526
Metric val_auc_epoch improved by 0.029 >= min_delta = 0.0. New best score: 0.555
Metric val_auc_epoch improved by 0.010 >= min_delta = 0.0. New best score: 0.565
Metric val_auc_epoch improved by 0.009 >= min_delta = 0.0. New best score: 0.574
Metric val_auc_epoch improved by 0.012 >= min_delta = 0.0. New best score: 0.585
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.585
Monitored metric val_auc_epoch did not improve in the last 6 records. Best score: 0.585. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_301-epoch=10-val_auc_epoch=0.5854.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_301-epoch=10-val_auc_epoch=0.5854.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5637115836143494
      val_auc_epoch         0.5854296684265137
      val_f1_epoch          0.5515909790992737
        val_loss            0.6961047053337097
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 301 completed - Val AUC: 0.5854
[I 2025-08-24 09:55:09,757] Trial 301 finished with value: -0.5854296684265137 and parameters: {'dataset.max_walk_length': 83, 'dataset.num_walks': 486646, 'training.lr': 0.0021608711852568554, 'training.weight_decay': 0.012336291266093155, 'training.batch_size': 64, 'training.gradient_clip_val': 0.2639757526314873, 'training.early_stopping_patience': 6, 'model.nhead_emb_combo': 23, 'model.hidden_dim': 16, 'model.nlayers': 6, 'model.dropout': 0.6842708353870427, 'training.epochs': 24}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 302 hyperparameters:
  Walk length: 80, Num walks: 426,506
  LR: 6.22e-04, Batch size: 64
  Model: emb_dim=16, hidden_dim=16
  Transformer: 5 layers, 16 heads
  Epochs: 23, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.542
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.545
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.552
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.558
Metric val_auc_epoch improved by 0.011 >= min_delta = 0.0. New best score: 0.570
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.577
Metric val_auc_epoch improved by 0.008 >= min_delta = 0.0. New best score: 0.585
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.587
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.590
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.592
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.595
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.597
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.597
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.599
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.600
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.600
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.600
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.600
`Trainer.fit` stopped: `max_epochs=23` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_302-epoch=22-val_auc_epoch=0.6002.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_302-epoch=22-val_auc_epoch=0.6002.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5680304765701294
      val_auc_epoch         0.6001951694488525
      val_f1_epoch          0.5626176595687866
        val_loss            0.7493220567703247
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 302 completed - Val AUC: 0.6002
[I 2025-08-24 11:17:22,248] Trial 302 finished with value: -0.6001951694488525 and parameters: {'dataset.max_walk_length': 80, 'dataset.num_walks': 426506, 'training.lr': 0.000622025569494002, 'training.weight_decay': 0.006016913902626503, 'training.batch_size': 64, 'training.gradient_clip_val': 0.335012407504436, 'training.early_stopping_patience': 6, 'model.nhead_emb_combo': 23, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6585403514684145, 'training.epochs': 23}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 303 hyperparameters:
  Walk length: 82, Num walks: 337,035
  LR: 4.26e-04, Batch size: 64
  Model: emb_dim=128, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 24, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.551
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.553
Metric val_auc_epoch improved by 0.065 >= min_delta = 0.0. New best score: 0.618
Metric val_auc_epoch improved by 0.027 >= min_delta = 0.0. New best score: 0.645
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.648
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.651
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.651
Monitored metric val_auc_epoch did not improve in the last 6 records. Best score: 0.651. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_303-epoch=08-val_auc_epoch=0.6512.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_303-epoch=08-val_auc_epoch=0.6512.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.6116869449615479
      val_auc_epoch         0.6511685848236084
      val_f1_epoch          0.6071940064430237
        val_loss            1.3520876169204712
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 303 completed - Val AUC: 0.6512
[I 2025-08-24 11:41:37,807] Trial 303 finished with value: -0.6511685848236084 and parameters: {'dataset.max_walk_length': 82, 'dataset.num_walks': 337035, 'training.lr': 0.00042602105524866963, 'training.weight_decay': 1.828270210046279e-05, 'training.batch_size': 64, 'training.gradient_clip_val': 0.21580245436260453, 'training.early_stopping_patience': 6, 'model.nhead_emb_combo': 22, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6755237898417852, 'training.epochs': 24}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 304 hyperparameters:
  Walk length: 83, Num walks: 345,535
  LR: 3.92e-04, Batch size: 512
  Model: emb_dim=32, hidden_dim=16
  Transformer: 5 layers, 16 heads
  Epochs: 24, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.564
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.568
❌ Trial 304 failed: Trial was pruned at epoch 5.
[I 2025-08-24 11:59:23,803] Trial 304 finished with value: 0.0 and parameters: {'dataset.max_walk_length': 83, 'dataset.num_walks': 345535, 'training.lr': 0.0003920039102990507, 'training.weight_decay': 3.4335992320491805e-05, 'training.batch_size': 512, 'training.gradient_clip_val': 0.1704086620484176, 'training.early_stopping_patience': 6, 'model.nhead_emb_combo': 24, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6724760214766343, 'training.epochs': 24}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 305 hyperparameters:
  Walk length: 82, Num walks: 332,692
  LR: 4.48e-04, Batch size: 64
  Model: emb_dim=128, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 25, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.533
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.534
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.541
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.547
Metric val_auc_epoch improved by 0.038 >= min_delta = 0.0. New best score: 0.585
Metric val_auc_epoch improved by 0.017 >= min_delta = 0.0. New best score: 0.602
Metric val_auc_epoch improved by 0.012 >= min_delta = 0.0. New best score: 0.614
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.617
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.622
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.624
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.625
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.626
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.626
`Trainer.fit` stopped: `max_epochs=25` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_305-epoch=19-val_auc_epoch=0.6263.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_305-epoch=19-val_auc_epoch=0.6263.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5930758714675903
      val_auc_epoch         0.6262949705123901
      val_f1_epoch          0.5907427072525024
        val_loss            1.2270995378494263
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 305 completed - Val AUC: 0.6263
[I 2025-08-24 12:39:40,557] Trial 305 finished with value: -0.6262949705123901 and parameters: {'dataset.max_walk_length': 82, 'dataset.num_walks': 332692, 'training.lr': 0.00044807267961930776, 'training.weight_decay': 1.6409720320817972e-05, 'training.batch_size': 64, 'training.gradient_clip_val': 0.301265889806555, 'training.early_stopping_patience': 6, 'model.nhead_emb_combo': 22, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6997382827878322, 'training.epochs': 25}. Best is trial 229 with value: -0.6563454866409302.
🧹 Cleaning up old checkpoints and logs (keeping top 10)...
  Removed old checkpoint: trial_295-epoch=09-val_auc_epoch=0.6134.ckpt
  Removed old checkpoint: trial_294-epoch=03-val_auc_epoch=0.6166.ckpt
  Removed old checkpoint: trial_293-epoch=17-val_auc_epoch=0.5920.ckpt
  Removed old checkpoint: trial_292-epoch=09-val_auc_epoch=0.6266.ckpt
  Removed old checkpoint: trial_291-epoch=14-val_auc_epoch=0.6025.ckpt
  Removed old log dir: trial_295
  Removed old log dir: trial_294
  Removed old log dir: trial_293
  Removed old log dir: trial_292
  Removed old log dir: trial_291
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 306 hyperparameters:
  Walk length: 90, Num walks: 375,589
  LR: 8.62e-04, Batch size: 64
  Model: emb_dim=128, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 24, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.542
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.543
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.547
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.549
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.551
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.552
Metric val_auc_epoch improved by 0.011 >= min_delta = 0.0. New best score: 0.563
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.570
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.575
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.578
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.581
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.582
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.584
Monitored metric val_auc_epoch did not improve in the last 6 records. Best score: 0.584. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_306-epoch=14-val_auc_epoch=0.5842.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_306-epoch=14-val_auc_epoch=0.5842.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5566312074661255
      val_auc_epoch         0.5842334628105164
      val_f1_epoch          0.5567487478256226
        val_loss            0.9064565896987915
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 306 completed - Val AUC: 0.5842
[I 2025-08-24 13:19:59,012] Trial 306 finished with value: -0.5842334628105164 and parameters: {'dataset.max_walk_length': 90, 'dataset.num_walks': 375589, 'training.lr': 0.0008616281625517306, 'training.weight_decay': 0.010316776378513906, 'training.batch_size': 64, 'training.gradient_clip_val': 0.24518462232473093, 'training.early_stopping_patience': 6, 'model.nhead_emb_combo': 22, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.687756647788983, 'training.epochs': 24}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 307 hyperparameters:
  Walk length: 84, Num walks: 434,251
  LR: 5.32e-04, Batch size: 64
  Model: emb_dim=16, hidden_dim=16
  Transformer: 5 layers, 16 heads
  Epochs: 25, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.552
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.556
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.557
Metric val_auc_epoch improved by 0.010 >= min_delta = 0.0. New best score: 0.567
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.574
Metric val_auc_epoch improved by 0.006 >= min_delta = 0.0. New best score: 0.580
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.586
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.591
Metric val_auc_epoch improved by 0.005 >= min_delta = 0.0. New best score: 0.595
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.596
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.597
Metric val_auc_epoch improved by 0.002 >= min_delta = 0.0. New best score: 0.599
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.603
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.604
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.605
Metric val_auc_epoch improved by 0.000 >= min_delta = 0.0. New best score: 0.605
Metric val_auc_epoch improved by 0.001 >= min_delta = 0.0. New best score: 0.606
`Trainer.fit` stopped: `max_epochs=25` reached.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_307-epoch=21-val_auc_epoch=0.6062.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_307-epoch=21-val_auc_epoch=0.6062.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_acc_epoch         0.5730203986167908
      val_auc_epoch         0.6062078475952148
      val_f1_epoch          0.5721515417098999
        val_loss            0.7690922021865845
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
✅ Trial 307 completed - Val AUC: 0.6062
[I 2025-08-24 15:01:40,365] Trial 307 finished with value: -0.6062078475952148 and parameters: {'dataset.max_walk_length': 84, 'dataset.num_walks': 434251, 'training.lr': 0.0005315622626060481, 'training.weight_decay': 0.019197269401462328, 'training.batch_size': 64, 'training.gradient_clip_val': 0.382492498161823, 'training.early_stopping_patience': 6, 'model.nhead_emb_combo': 23, 'model.hidden_dim': 16, 'model.nlayers': 5, 'model.dropout': 0.6646873529345392, 'training.epochs': 25}. Best is trial 229 with value: -0.6563454866409302.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:147: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.lr = trial.suggest_loguniform("training.lr", 1e-5, 1e-1)
/home/eng/shilo_avital/yolo_lab/walk_to_paint/optuna_run.py:148: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  cfg.training.weight_decay = trial.suggest_loguniform(

🔬 Trial 308 hyperparameters:
  Walk length: 81, Num walks: 318,670
  LR: 8.96e-04, Batch size: 64
  Model: emb_dim=128, hidden_dim=16
  Transformer: 5 layers, 8 heads
  Epochs: 25, Weighted loss: True
Loading bitcoin-alpha-binary dataset...
Success! ✅
Splitting edges for bitcoin-alpha-binary dataset...
Success! ✅
Sampling random walks from bitcoin-alpha-binary dataset...
Success! ✅
Building tokenizer for bitcoin-alpha-binary dataset...
Success! ✅
Padding and building stage tensors for bitcoin-alpha-binary dataset...
Success! ✅
Creating DataLoaders for bitcoin-alpha-binary dataset...
Success! ✅
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:658: Checkpoint directory /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
Metric val_auc_epoch improved. New best score: 0.529
Metric val_auc_epoch improved by 0.007 >= min_delta = 0.0. New best score: 0.536
Metric val_auc_epoch improved by 0.003 >= min_delta = 0.0. New best score: 0.539
Metric val_auc_epoch improved by 0.012 >= min_delta = 0.0. New best score: 0.551
Metric val_auc_epoch improved by 0.022 >= min_delta = 0.0. New best score: 0.573
Metric val_auc_epoch improved by 0.004 >= min_delta = 0.0. New best score: 0.577
Monitored metric val_auc_epoch did not improve in the last 6 records. Best score: 0.577. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_308-epoch=12-val_auc_epoch=0.5773.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Loaded model weights from the checkpoint at /home/eng/shilo_avital/yolo_lab/walk_to_paint/checkpoints/trial_308-epoch=12-val_auc_epoch=0.5773.ckpt
/home/eng/shilo_avital/yolo_lab/walk_to_paint/.venv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=127` in the `DataLoader` to improve performance.
